![logo](https://dev.azul.com.do/Pages/developer/pages/lib/assets/new/logo.png)

E-commerce

- [Presentación](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Presentaci%C3%B3n)
  - [Objetivo](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Objetivo)
- [APIs AZUL](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#APIs%20AZUL)
  - [Aspectos Seguridad](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Aspectos%20Seguridad)
- [Beneficios](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Beneficios)
- [Bóveda de datos](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#B%C3%B3veda%20de%20datos)
- [Servicios asociados](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Servicios%20asociados)
  - [Te servimos 24/7](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Te%20servimos%2024/7)
  - [Monitorea tu comercio digital](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Monitorea%20tu%20comercio%20digital)
- [Requerimientos para el sitio web](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Requerimientos%20para%20el%20sitio%20web)
- [Requisitos de Seguridad](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Requisitos%20de%20Seguridad)
  - [Normas PCI DSS](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Normas%20PCI%20DSS)
- [Recomendaciones para un website exitoso](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Recomendaciones%20para%20un%20website%20exitoso)
- [Pasos para aceptar pagos en tu web](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Pasos%20para%20aceptar%20pagos%20en%20tu%20web)

Página de Pagos

- [Pasarela de Pagos](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Pasarela%20de%20Pagos)
- [Resumen](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Resumen)
  - [Notas importantes](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Notas%20importantes)
- [Invocar la Página de Pago](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Invocar%20la%20P%C3%A1gina%20de%20Pago)
- [Experiencia de pago](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Experiencia%20de%20pago)
  - [Flujo de transacción](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Flujo%20de%20transacci%C3%B3n)
  - [Respuesta “Aprobada”](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Respuesta%20%E2%80%9CAprobada%E2%80%9D)
  - [Respuesta “Declinada”](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Respuesta%20%E2%80%9CDeclinada%E2%80%9D)
- [Diseño personalizable](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Dise%C3%B1o%20personalizable)
  - [Campos nuevos y compatibilidad](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Campos%20nuevos%20y%20compatibilidad)
- [Captura manual de transacciones](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Captura%20manual%20de%20transacciones)
- [Transacción de Venta con sólo reserva de fondos (HOLD)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Transacci%C3%B3n%20de%20Venta%20con%20s%C3%B3lo%20reserva%20de%20fondos%20(HOLD))
- [Transacción para posteo de la pre-autorización (POST)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Transacci%C3%B3n%20para%20posteo%20de%20la%20pre-autorizaci%C3%B3n%20(POST))
- [Transacción para anular transacción (VOID)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Transacci%C3%B3n%20para%20anular%20transacci%C3%B3n%20(VOID))
- [Data Vault](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Data%20Vault)
- [Respuesta Datavault](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Respuesta%20Datavault)
- [Creación Token Datavault](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Creaci%C3%B3n%20Token%20Datavault)
- [Transacción de Venta Utilizando Token Datavault](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Transacci%C3%B3n%20de%20Venta%20Utilizando%20Token%20Datavault)
- [Eliminar Token](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Eliminar%20Token)
  - [Campos para Generación HASH](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Campos%20para%20Generaci%C3%B3n%20HASH)
- [3D Secure](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#3D%20Secure)
- [PayPal](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#PayPal)
- [IPN (Instant Payment Notification)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#IPN%20(Instant%20Payment%20Notification))
- [ResponseCode status](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#ResponseCode%20status)
- [Manejo de la Autenticación (AuthHash)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Manejo%20de%20la%20Autenticaci%C3%B3n%20(AuthHash))
- [Errores de validación](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Errores%20de%20validaci%C3%B3n)
- [Rastreo y Reporte de inconvenientes](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Rastreo%20y%20Reporte%20de%20inconvenientes)

Webservices

- [Resumen](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Resumen)
- [Conexión VPN Site-to-Site](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Conexi%C3%B3n%20VPN%20Site-to-Site)
  - [Requerimientos](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Requerimientos)
  - [Información de los Sites](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Informaci%C3%B3n%20de%20los%20Sites)
  - [Propiedades del Túnel](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Propiedades%20del%20T%C3%BAnel)
- [Autenticación mutua con Certificados Digitales](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Autenticaci%C3%B3n%20mutua%20con%20Certificados%20Digitales)
  - [Cómo Invocar el Web service](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#C%C3%B3mo%20Invocar%20el%20Web%20service)
- [Autenticación Webservices](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Autenticaci%C3%B3n%20Webservices)
  - [HTTP Headers](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#HTTP%20Headers)
  - [SOAP Headers](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#SOAP%20Headers)
- [Método ProcessPayment](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#M%C3%A9todo%20ProcessPayment)
  - [SALE: Transacción de venta](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#SALE:%20Transacci%C3%B3n%20de%20venta)
  - [Declaración e importación](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Declaraci%C3%B3n%20e%20importaci%C3%B3n)
  - [Invocar al WebServices](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Invocar%20al%20WebServices)
  - [Realizar venta](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Realizar%20venta)
  - [HOLD: Transacción para retención o reserva de fondos en la tarjeta](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#HOLD:%20Transacci%C3%B3n%20para%20retenci%C3%B3n%20o%20reserva%20de%20fondos%20en%20la%20tarjeta)
  - [REFUND: Transacción Devolución](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#REFUND:%20Transacci%C3%B3n%20Devoluci%C3%B3n)
  - [Ejemplos mensaje de Requerimiento](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplos%20mensaje%20de%20Requerimiento)
  - [JSON](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#JSON)
  - [HTTP Forms Post](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#HTTP%20Forms%20Post)
  - [Ejemplos Mensajes de Respuesta](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplos%20Mensajes%20de%20Respuesta)
- [Método ProcessPost](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#M%C3%A9todo%20ProcessPost)
  - [Transacción para hacer captura o posteo del Hold](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Transacci%C3%B3n%20para%20hacer%20captura%20o%20posteo%20del%20Hold)
  - [Ejemplos Mensaje de Requerimiento](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplos%20Mensaje%20de%20Requerimiento)
  - [Ejemplos Mensajes de Respuesta](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplos%20Mensajes%20de%20Respuesta)
- [Método VerifyPayment](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#M%C3%A9todo%20VerifyPayment)
- [Bóvedad de Datos (Datavault)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#B%C3%B3vedad%20de%20Datos%20(Datavault))
  - [Venta o hold con creación de Token](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Venta%20o%20hold%20con%20creaci%C3%B3n%20de%20Token)
  - [Transacción de Venta utilizando el Token:](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Transacci%C3%B3n%20de%20Venta%20utilizando%20el%20Token:)
- [Método ProcessDatavault](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#M%C3%A9todo%20ProcessDatavault)
  - [Create: Creación de Token con Bóveda de Datos (DataVault)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Create:%20Creaci%C3%B3n%20de%20Token%20con%20B%C3%B3veda%20de%20Datos%20(DataVault))
  - [Delete: Eliminación de Token de Bóveda de Datos (DataVault)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Delete:%20Eliminaci%C3%B3n%20de%20Token%20de%20B%C3%B3veda%20de%20Datos%20(DataVault))
  - [Errores de Validación](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Errores%20de%20Validaci%C3%B3n)
- [Método ProcessVoid](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#M%C3%A9todo%20ProcessVoid)
  - [Transacción para anular venta, post o hold](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Transacci%C3%B3n%20para%20anular%20venta,%20post%20o%20hold)
- [Vista general 3D-Secure 2.0](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Vista%20general%203D-Secure%202.0)
  - [ForceNo3DS](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#ForceNo3DS)
  - [Flujo sin fricción (SF)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Flujo%20sin%20fricci%C3%B3n%20(SF))
  - [Paso 1: Recopile los detalles de pago del tarjetahabiente](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%201:%20Recopile%20los%20detalles%20de%20pago%20del%20tarjetahabiente)
  - [Paso 2: Iniciar un pago](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%202:%20Iniciar%20un%20pago)
  - [Sub-campos CardHolderInfo](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Sub-campos%20CardHolderInfo)
  - [Este es un ejemplo en JSON de un mensaje de venta con los nuevos campos de 3-D Secure 2.0:](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Este%20es%20un%20ejemplo%20en%20JSON%20de%20un%20mensaje%20de%20venta%20con%20los%20nuevos%20campos%20de%203-D%20Secure%202.0:)
  - [Paso 3: Respuesta de autenticación de 3D-Secure:](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%203:%20Respuesta%20de%20autenticaci%C3%B3n%20de%203D-Secure:)
  - [Paso 4: solicitud y respuesta de notificación del método 3DS](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%204:%20solicitud%20y%20respuesta%20de%20notificaci%C3%B3n%20del%20m%C3%A9todo%203DS)
  - [ThreeDSServerTransID](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#ThreeDSServerTransID)
  - [Soporte del emisor 3DS](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Soporte%20del%20emisor%203DS)
  - [MethodNotificationStatus:](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#MethodNotificationStatus:)
  - [Paso 5 (SF): Solicitud ProcessThreeDSMethod para continuar con la autenticación 3DS](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%205%20(SF):%20Solicitud%20ProcessThreeDSMethod%20para%20continuar%20con%20la%20autenticaci%C3%B3n%203DS)
  - [Paso 6 (SF): Respuesta final de 3DS](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%206%20(SF):%20Respuesta%20final%20de%203DS)
  - [Flujo de desafío 3D-Secure 2.0](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Flujo%20de%20desaf%C3%ADo%203D-Secure%202.0)
  - [Paso 3 (D) \| 6 (DM): Webservice Azul responde para continuar con la autenticación 3DS](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%203%20(D)%20|%206%20(DM):%20Webservice%20Azul%20responde%20para%20continuar%20con%20la%20autenticaci%C3%B3n%203DS)
  - [Paso 4 (D) \| 7 (DM): Redirección desafío al tarjetahabiente](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%204%20(D)%20|%207%20(DM):%20Redirecci%C3%B3n%20desaf%C3%ADo%20al%20tarjetahabiente)
  - [Asignación de nombres de campo](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Asignaci%C3%B3n%20de%20nombres%20de%20campo)
  - [Asignación de los nombres de campo](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Asignaci%C3%B3n%20de%20los%20nombres%20de%20campo)
  - [Paso 5 (D) \| 8 (DM): Envío solicitud ProcessThreeDSChallenge para completar autorización](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%205%20(D)%20|%208%20(DM):%20Env%C3%ADo%20solicitud%20ProcessThreeDSChallenge%20para%20completar%20autorizaci%C3%B3n)
  - [Paso 6 (D) \| 9 (DM): Respuesta final de 3DS](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%206%20(D)%20|%209%20(DM):%20Respuesta%20final%20de%203DS)
  - [Paso 3 (D): Webservice Azul responde para continuar con la autenticación 3DS 1.0](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%203%20(D):%20Webservice%20Azul%20responde%20para%20continuar%20con%20la%20autenticaci%C3%B3n%203DS%201.0)
  - [Paso 4 (D): Redirección tarjetahabiente al desafío](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%204%20(D):%20Redirecci%C3%B3n%20tarjetahabiente%20al%20desaf%C3%ADo)
  - [Asignación de nombres de campo](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Asignaci%C3%B3n%20de%20nombres%20de%20campo)
  - [Asignación de los nombres de campo](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Asignaci%C3%B3n%20de%20los%20nombres%20de%20campo)
  - [Paso 5 (D): Envío solicitud ProcessThreeDSChallenge para completar autorización](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%205%20(D):%20Env%C3%ADo%20solicitud%20ProcessThreeDSChallenge%20para%20completar%20autorizaci%C3%B3n)
  - [Paso 6 (D): Respuesta final de 3DS](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%206%20(D):%20Respuesta%20final%20de%203DS)
  - [Datos para pruebas](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Datos%20para%20pruebas)
  - [Soporte Técnico](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Soporte%20T%C3%A9cnico)

Plugins

- [Magento V2.0](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Magento%20V2.0)
  - [Requisitos](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Requisitos)
  - [Instalación](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Instalaci%C3%B3n)
  - [Configuración](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Configuraci%C3%B3n)
- [Shopify](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Shopify)
  - [Configuración Pasarela de Pagos](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Configuraci%C3%B3n%20Pasarela%20de%20Pagos)
  - [Paso por paso](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Paso%20por%20paso)
  - [Pasos para realizar pruebas](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Pasos%20para%20realizar%20pruebas)
- [WooCommerce](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#WooCommerce)
  - [Instalación del plugin](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Instalaci%C3%B3n%20del%20plugin)
  - [Métodos de instalación](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#M%C3%A9todos%20de%20instalaci%C3%B3n)
  - [Activación y configuración del método de pago](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Activaci%C3%B3n%20y%20configuraci%C3%B3n%20del%20m%C3%A9todo%20de%20pago)
  - [Creación de las páginas](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Creaci%C3%B3n%20de%20las%20p%C3%A1ginas)
  - [Configuración recomendada para el uso de datavault](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Configuraci%C3%B3n%20recomendada%20para%20el%20uso%20de%20datavault)
  - [Nota final](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Nota%20final)

Recurrencia de Pagos

- [Recurrencia de Pagos](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Recurrencia%20de%20Pagos)
  - [Endpoints o URLs](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Endpoints%20o%20URLs)
  - [Requerimientos de Entrada](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Requerimientos%20de%20Entrada)
  - [Recurrencia Diaria](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Recurrencia%20Diaria)
  - [Respuesta Recurrencia Diaria](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Respuesta%20Recurrencia%20Diaria)
  - [JSON: Recurrencia Semanal](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#JSON:%20Recurrencia%20Semanal)
  - [Respuesta Recurrencia Semanal](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Respuesta%20Recurrencia%20Semanal)
  - [JSON: Recurrencia Mensual](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#JSON:%20Recurrencia%20Mensual)
  - [Respuesta Recurrencia Mensual](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Respuesta%20Recurrencia%20Mensual)

Captura Múltiple

- [Split Shipment or Multiple Partial Capture](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Split%20Shipment%20or%20Multiple%20Partial%20Capture)
  - [Método Hold](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#M%C3%A9todo%20Hold)
  - [Requerimiento Hold](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Requerimiento%20Hold)
  - [Ejemplo JSON Requerimiento](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplo%20JSON%20Requerimiento)
  - [Ejemplo Respuesta Aprobada](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplo%20Respuesta%20Aprobada)
  - [Ejemplo Respuesta Declinada](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplo%20Respuesta%20Declinada)
  - [Ejemplo Respuesta Error](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplo%20Respuesta%20Error)

Cuotas

- [Cuotas](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Cuotas)
  - [Endpoints o URLs](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Endpoints%20o%20URLs)
  - [Requerimientos Cuotas](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Requerimientos%20Cuotas)
  - [Ejemplo Cuotas Request JSON](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplo%20Cuotas%20Request%20JSON)
  - [Ejemplo Cuotas Response JSON](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplo%20Cuotas%20Response%20JSON)

Conversión de Monedas

- [DCC - Conversión Dinámica de Monedas](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#DCC%20-%20Conversi%C3%B3n%20Din%C3%A1mica%20de%20Monedas)
  - [Requerimientos de las Marcas sobre DCC](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Requerimientos%20de%20las%20Marcas%20sobre%20DCC)
  - [Método ProcessDccRateInquiry (Consulta de Tasa)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#M%C3%A9todo%20ProcessDccRateInquiry%20(Consulta%20de%20Tasa))
  - [Consulta de Tasa (DCCRateID)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Consulta%20de%20Tasa%20(DCCRateID))
  - [Resultado Consulta de Tasa (DCCRateID)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#%20Resultado%20Consulta%20de%20Tasa%20(DCCRateID))
  - [DCC Endpoints o URLs](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#DCC%20Endpoints%20o%20URLs)
  - [Ejemplo Request JSON](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplo%20Request%20JSON)
  - [Ejemplo Response JSON](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Ejemplo%20Response%20JSON)
  - [Requerimientos DCC](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Requerimientos%20DCC)
  - [Requerimiento (DCC Sale)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Requerimiento%20(DCC%20Sale))
  - [Resultado Venta con DCC (DCC Sale Result)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Resultado%20Venta%20con%20DCC%20(DCC%20Sale%20Result))
  - [Devolución (Refund)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Devoluci%C3%B3n%20(Refund))
  - [Anulación (Void)](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Anulaci%C3%B3n%20(Void))

Códigos de Respuestas

- [Códigos y mensajes de error](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#C%C3%B3digos%20y%20mensajes%20de%20error)
  - [Tiempos de Respuestas](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Tiempos%20de%20Respuestas)
  - [Campo Código de Respuesta](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Campo%20C%C3%B3digo%20de%20Respuesta)
  - [Campo Mensaje de Respuesta](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Campo%20Mensaje%20de%20Respuesta)
- [Códigos de Respuesta Comunes](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#C%C3%B3digos%20de%20Respuesta%20Comunes)

Volver a AZUL.com.do

# Comercio Electrónico AZUL

Está página te facilita los recursos que necesitas para integrarte a AZUL.
Comienza con la configuración para acceder a tus credenciales de autenticación,
documentación de AZUL, ejemplos de integración ¡y más!

[![](https://dev.azul.com.do/Pages/developer/assets/imgs/pay-icon.svg)Pagos](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Webservices)

# Modalidades

Vende desde tu página vía web o app móvil con nuestros componentes personalizables, [Página de Pagos](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#P%C3%A1gina%20de%20Pagos) y [Webservices API](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Webservices)

[![](https://dev.azul.com.do/Pages/developer/assets/imgs/api-icon.svg)Librería de APIs](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Plugins)

# Plugins

Conecta tus sistemas de comercio existentes a nuestra plataforma para un
flujo de pago ¡fácil, rápido y seguro!

[![](https://dev.azul.com.do/Pages/developer/assets/imgs/auth-icon.svg)Tokenización](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#B%C3%B3vedad%20de%20Datos%20(Datavault))

# Tokenización

Integra tu plataforma web a nuestra bóveda de datos y obtén ¡mayor seguridad
y eficiencia!

[![](https://dev.azul.com.do/Pages/developer/pages/documents/assets/imgs/user-icono.svg)3D Secure](https://dev.azul.com.do/Pages/developer/pages/lib/index.aspx#Vista%20general%203D-Secure%202.0)

# Autenticación 3DS 2.0

Mejora tu experiencia de pagos integrando la autenticación del
tarjetahabiente.

# E-commerce

## Presentación

Conecta la página web de tu empresa a la plataforma de autorización de pagos de AZUL, consumiendo los Webservices AZUL o implementando la Página de Pago AZUL. Herramientas desarrolladas utilizando estándares que garantizan la seguridad y confiabilidad de cada transacción, al tiempo que se adapta a cualquier plataforma de desarrollo existente.

## Objetivo

El presente manual de integración está dirigido esencialmente a los usuarios de perfil técnico (analistas, ingenieros o programadores), y proporciona información sobre las funciones de Webservices AZUL y Página de Pago AZUL así como explicaciones de cómo utilizarlos para cubrir sus necesidades.

Los integradores deben tener un conocimiento práctico de servicio Web, SOAP y XML; además de una comprensión completa de cómo integrar los datos en un sitio de aplicación o web. Todo el software necesario se debe instalar en un entorno de desarrollo antes de la implementación. El integrador debe tener conocimiento del lenguaje de programación seleccionado.

Utiliza este manual de integración para:

- Conocer el funcionamiento de Webservices y Página de Pagos.
- Poder programar o desarrollar la integración de manera rápida y sin inconvenientes, aprovechando al máximo la funcionalidad provista por la herramienta seleccionada
- Conocer las técnicas y herramientas (funciones) para sacar el máximo partido a los servicios provistos.
- Conocer qué información debe enviar, y recibir de los Webservices y Página de Pagos.

## APIs AZUL

¡Es hora de expandir tu negocio más allá de los límites! Webservices AZUL es un webservice que permite aceptar pagos con tarjetas desde tu página web o aplicación móvil. Este es el método de integración que estaremos detallando en este documento.

Los Webservices AZUL te permiten ejecutar una transacción de manera inmediata directamente desde tu aplicación/servidor web e interpretar la respuesta sin necesidad de enviar (direccionar) al cliente al sitio web de AZUL. Desde la página web del comercio se gestiona todo el proceso de compra, para lo cual el comercio debe de efectuar la implementación de captura de datos de la transacción.

Al momento de efectuarse el pago de los bienes o servicios, el servidor del comercio invoca los Webservices AZUL (con los datos de la compra y de la tarjeta), y estos devuelven un mensaje de respuesta con la aprobación o declinación de la transacción.

## Aspectos Seguridad

Para garantizar la seguridad de la transacción se utilizan diferentes recursos, tales como:

- Confidencialidad de la información utilizando TLS 1.2, la información viaja cifrada sobre el protocolo HTTPS
- Autenticación de la petición, a través de factores de autenticación provistos para cada afiliado.
- Conexión VPN entre el site del comercio y los servidores de AZUL · “Mutual Authentication”, con la presentación de certificados digitales
- 3D Secure: Método de autenticación del tarjetahabiente, para asegurar que la compra la está realizando el propietario de la tarjeta. Está disponible con tarjetas Visa y Mastercard enroladas en sus programas “Visa Secure” y “Mastercard ID Check” respectivamente. Cuando el tarjetahabiente procesa su pago, será dirigido a la página de Visa o Mastercard, donde deberá autenticar su tarjeta según el método definido por su banco emisor. Este servicio solo aplica para las transacciones realizadas a través de ecommerce.

## Beneficios

- Servicio 24/7
- Diferentes alternativas de conexión
- Impulso del mercado digital
- Alta disponibilidad
- Tu punto de venta en la web
- Aceptación de tarjetas
- Internacionalización del negocio
- internacionales
- Reportería detallada diaria
- Cierre automático a las 9:00PM
- Alta seguridad electrónica
- para pagos al día siguiente
- Soporte de expertos
- Bóveda de datos
- Entrenamiento en mejores prácticas

## Bóveda de datos

Integrando la página web o aplicación móvil a la bóveda de datos de AZUL, evitarás que tus clientes tengan que digitar sus tarjetas cada vez que compren en tu tienda en línea, brindando así una mejor experiencia de pago. Adicionalmente, con este servicio puedes almacenar un token asociado a la tarjeta de tus clientes, el cual sustituye de forma segura el número de la tarjeta.

- Mayor rapidez
- Motiva la recompra
- Eleva la experiencia del usuario

## Servicios asociados

Integrando la página web o aplicación móvil a la bóveda de datos de AZUL, evitarás que tus clientes tengan que digitar sus tarjetas cada vez que compren en tu tienda en línea, brindando así una mejor experiencia de pago. Adicionalmente, con este servicio puedes almacenar un token asociado a la tarjeta de tus clientes, el cual sustituye de forma segura el número de la tarjeta.

## Te servimos 24/7

- Mayor rapidez
- Motiva la recompra
- Eleva la experiencia del usuario

## Monitorea tu comercio digital

- Accede globalmente a tu Portal AZUL en <www.AZUL.com.do> en el que podrás generar tus reportes, realizar solicitudes de servicio y consultar tus transacciones.
- Recibe diariamente en tu correo electrónico reportes detallados de las transacciones realizadas en tu página web.

## Requerimientos para el sitio web

Requisitos mínimos para el web site maximizan una buena experiencia de compra para los consumidores y minimizan la incidencia de solicitudes de copia, disputas y contracargos:

- Nombre comercial claro.
- Descripción completa y clara de los bienes y servicios.
- Despliegue de las marcas de tarjetas que aceptan.
- Despliegue de logos de “Visa Secure” y “Mastercard ID Check” (aplica para clientes que se afilien al servicio de autenticación del tarjetahabiente)
- Políticas claras de devoluciones, reembolsos y cancelaciones. Estas políticas deben de estar visibles para el tarjetahabiente para informales de sus derechos y responsabilidades. Si el comercio no tiene políticas de reembolso debe de estar claro para el tarjetahabiente antes de realizar la compra.
- Información para contacto de Servicio al Cliente. Incluyendo: correo electrónico y número telefónico.
- Política clara de entrega.
- La dirección permanente del comercio, incluyendo el país. Se debe establecer de una de estas dos formas:
- Al momento de presentar el monto final de la transacción.
- En cada pantalla del proceso de compras.
- Moneda (s) de compra.
- Recibo claro y completo.
- Políticas de privacidad.
- Restricciones de entrega y exportación (si aplica).
- Políticas de seguridad para la transmisión de datos de tarjetas.
- Funcionalidad que permita la creación y mantenimiento de perfiles de clientes (aplica para clientes afiliados al servicio de bóveda de datos)

## Requisitos de Seguridad

Los afiliados a AZUL deben cumplir con las Normas de Seguridad de Datos de la Industria de Tarjetas de Pago (PCI DSS), las cuales se desarrollaron para proteger los datos de los titulares de tarjetas. Las normas PCI DSS se aplican a todas las entidades que participan en el procesamiento de tarjetas de pago, entre las que se incluyen comerciantes, procesadores, adquirientes, entidades emisoras y proveedores de servicios, como también todas las demás entidades que almacenan, procesan o transmiten CHD (Cardholder Data) o SAD (Sensitive Authentication Data).

Si el afiliado elige integrarse a través del Webservices AZUL, debe completar el Cuestionario de autoevaluación D y Atestación de cumplimiento de las Normas de seguridad de datos de la Industria de tarjetas de pago (PCI).

A continuación, encontrarás una descripción general de los 12 requisitos de las normas PCI:

|                                                          |                                                                                                                                                                                                                                                                     |
| -------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Desarrolla y mantén redes y sistemas seguros             | - Instalar y mantener una configuración de firewall para proteger los datos del titular de la tarjeta.<br>- No utilizar contraseñas de sistemas y otros parámetros de seguridad provistos por los proveedores.                                                      |
| Proteger los datos del titular de la tarjeta             | - Proteger los datos del titular de la tarjeta que fueron almacenados.<br>- Cifrar la transmisión de los datos del titular de la tarjeta en las redes públicas abiertas.                                                                                            |
| Mantener un programa de administración de vulnerabilidad | - Utilizar y actualizar con seguridad los programas o software antivirus.<br>- Desarrollar y mantener sistemas y aplicaciones seguras.                                                                                                                              |
| Implementar medidas sólidas de control de acceso         | - Restringir el acceso a los datos del titular de la tarjeta según la necesidad de información que tenga la empresa.<br>- Identificar y autenticar el acceso a los componentes del sistema.<br>- Restringir el acceso físico a los datos del titular de la tarjeta. |
| Supervisar y evaluar las redes con regularidad           | - Rastrear y supervisar todos los accesos a los recursos de red y a los datos de los titulares de las tarjetas.<br>- Probar con regularidad los sistemas y procesos de seguridad.                                                                                   |
| Mantener una política de seguridad de información        | - Mantener una política que aborde la seguridad de la información para todo el personal.                                                                                                                                                                            |

## Normas PCI DSS

Las normas PCI DSS se aplican a todas las entidades que participan en el procesamiento de tarjetas de pago, entre las que se incluyen comerciantes, procesadores, instituciones financieras y proveedores de servicios, así como también todas las demás entidades que almacenan, procesan o transmiten datos del titular de la tarjeta o datos de autenticación confidenciales. Los datos del titular de la tarjeta y los datos de autenticación confidenciales se definen de la siguiente manera:

| Datos de cuentas |
| ---------------- |

| Los datos de titulares de tarjetas incluyen: | Los datos confidenciales de autenticación incluyen: |
| - Número de cuenta principal (PAN)<br>- Nombre del titular de la tarjeta<br>- Fecha de vencimiento<br>- Código de servicio | - Contenido completo de la pista (datos de la banda magnética o datos equivalentes que están en un chip)<br>- CAV2/CVC2/CVV2/CID<br>- PIN/Pin Block |

El número de cuenta principal es el factor que define los datos del titular de la tarjeta. Si el nombre del titular de la tarjeta, el código de servicio o la fecha de vencimiento se almacenan, procesan o transmiten con el PAN (número de cuenta principal) o se encuentran presentes de algún otro modo en el entorno de datos del titular de la tarjeta, se deben proteger de conformidad con los requisitos de las normas PCI DSS.

Los requisitos de las PCI DSS se aplican a las organizaciones y entornos en los que se almacenan, procesan o transmiten datos de cuenta (datos del titular de la tarjeta y datos de autenticación confidenciales). Algunos requisitos de las PCI DSS también se aplican a organizaciones que han tercerizado las operaciones de pago o la gestión del CDE (entorno de los datos del titular de la tarjeta)1. Además, las organizaciones que tercerizan el CDE (entorno de los datos del titular de la tarjeta) o las operaciones de pagos a terceros deben asegurarse de que estos protejan los datos de cuenta de acuerdo con todos los requisitos correspondientes de las PCI DSS.

## Recomendaciones para un website exitoso

- Compromiso de procesar órdenes rápidamente
- Confirmación de órdenes por correo electrónico
- Información actualizada de mercancía en inventario
- Compromiso para responder a todas las consultas dentro de un plazo máximo de dos días
- Declaración de seguridad usada en el sitio
- Mensaje a los clientes pidiéndoles retener copia de comprobantes

## Pasos para aceptar pagos en tu web

Para el proceso de integración de tus sistemas con la plataforma de pago de AZUL, a través del consumo del WebserviceAZUL o Página de Pago AZUL, puedes ponerte en contacto con tu ejecutivo de negocios, quien te iniciará en el proceso a seguir y/o pondrá en contacto con el personal técnico.

AZUL cuenta con un área de test (con las mismas funcionalidades del servidor de producción), que permitirá realizar pruebas de transacciones en tiempo real. Es en este ambiente que se validan y certifican las aplicaciones antes de ser puesto en marcha en el ambiente de producción.

- Afiliado indica el canal a implementar
- Página de Pago
- Webservice AZUL a través de VPN
- Webservices AZUL, autenticación mutual (certificados digitales)
- Afiliado proporciona datos (configuración del ambiente de desarrollo) del canal seleccionado
- Si es necesario configurar VPN, se hará la configuración de ambos lados (Afiliado y AZUL)
- SDP proporciona al afiliado los datos de acceso al ambiente de pruebas
- Afiliado adecúa su aplicación. En caso de dudas, contacta al personal técnico de AZUL
- Realización de pruebas de certificación. Personal técnico de AZUL verifica que la mensajería entre el aplicativo del afiliado y AZUL están adecuados
- En caso de que la verificación de la mensajería es satisfactoria, se comunicará al ejecutivo de negocios la no objeción técnica
- El ejecutivo de negocios pedirá que se creen los accesos al ambiente de producción (si no existe ningún inconveniente en documentación y requisitos)
- Departamento de Integridad de Datos/Seguridad creará y proveerá los accesos al ambiente de Producción; haciéndolo llegar al afiliado por los medios definidos para tales fines

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/c1sc11img1.png)

# Página de Pagos

## Pasarela de Pagos

Nos adaptamos a tus necesidades. En adición, tenemos nuestra página de pago que se integra a tu página web o aplicación móvil y te permite aceptar pagos con tarjetas de tus clientes de una forma fácil y segura.

Con este método de pago, el cliente final es re-direccionado a un website de AZUL para capturar los datos de la tarjeta; al finalizar la transacción el navegador retorna al cliente nuevamente al site del comercio. Los datos de la transacción, tales como el monto a ser cobrado, es un dato enviado por el portal del afiliado al momento de redirigir al cliente a la Página de Pago AZUL; de igual manera, el site del comercio recibe un mensaje con el resultado de la transacción (aprobación o declinación) al finalizar la misma. Los detalles técnicos de la integración por Página de Pago AZUL están descritos en otro documento.

## Resumen

Permite enviar al cliente final a un website para capturar la transacción en la plataforma de AZUL. La integración consiste en implementar campos tipo ‘HTTP Forms’ y enviar al usuario a la dirección indicada. Al finalizar la transacción, el cliente es enviado nuevamente a la web del comercio.

La Página de Pago proporciona una forma rápida y segura de efectuar transacciones en línea, debido a que las transacciones se efectúan del lado de la plataforma de AZUL.

El proceso se presenta a continuación:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture36-46874946.png)

## Notas importantes

- Los datos de pruebas y de producción nunca van a ser similares
- Los factores de autenticación de prueba y producción nunca van a ser los mismos
- Las url de pruebas y las de producción no son las mismas

## Invocar la Página de Pago

La Página de Pago AZUL se encuentra publicada utilizando un certificado digital, por lo que quien realice la consulta debe tener acceso a Internet para validar el certificado cargado.

La Página de Pago AZUL cuenta con dos URL de modo que el cliente cuando haga el pedido, si por alguna razón no es posible la conexión, se conecte al segundo sitio. El comercio debe poder manejar estos datos.

| Ambiente            | URL                                                                                                              |
| ------------------- | ---------------------------------------------------------------------------------------------------------------- |
| Producción          |
| Site Principal      | [https://pagos.azul.com.do/PaymentPage/Default.aspx](https://pagos.azul.com.do/PaymentPage/Default.aspx)         |
| Site Alterno        | [https://contpagos.azul.com.do/PaymentPage/Default.aspx](https://contpagos.azul.com.do/PaymentPage/Default.aspx) |
| Ambiente de pruebas |
|                     | <https://pruebas.azul.com.do/PaymentPage/>                                                                       |

Para invocar el site de pago es necesario crear un formulario HTML estándar y enviar a la URL proporcionada por AZUL, el POST con el detalle de la transacción. El POST debe contener cada uno de los valores en su propio campo. La forma más sencilla es crear un formulario con los valores a ser enviados en campos “Hidden” como se detalla más abajo.

No obstante, puedes utilizar JavaScript o cualquier otro método siempre y cuando los valores lleguen al servidor según las especificaciones. Es importante tener en cuenta que quien debe ejecutar el POST es el browser del cliente final, no el servidor que está hosteando el site de comercio electrónico.

El desarrollo debe estar preparado para intentar por la URL de contingencia en caso de fallo de la URL principal.

Una vez el cliente final es enviado al site de pagos, se le presentará un formulario detallando la transacción y los campos correspondientes de captura. Al finalizar el pago, el cliente final es enviado de vuelta a la URL especificada en el requerimiento con los valores de respuesta de la transacción en el querystring (“url?dato1=valor1&dato2=valor2…).

| Página de Pago AZUL   |
| --------------------- |
| Parámetros de Entrada |
| ---                   |
| Parámetro             | Descripción                                                                                                                                                                                                                                                          | Obligatorio | HASH |
| ---                   | ---                                                                                                                                                                                                                                                                  | ---         | ---  |
| MerchantID            | Número de identificación del comercio asignado al momento de afiliación a AZUL                                                                                                                                                                                       | Si          | Si   |
| MerchantName          | Nombre del comercio a ser desplegado e en la página de pago.                                                                                                                                                                                                         | Si          | Si   |
| MerchantType          | Tipo de comercio (de carácter informativo)                                                                                                                                                                                                                           | Si          | Si   |
| CurrencyCode          | Moneda de la transacción<br>Cada MID o tienda transacciona con una sola moneda.<br>Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                 | Si          | Si   |
| OrderNumber           | El número de orden de la transacción                                                                                                                                                                                                                                 | Si          | Si   |
| Amount                | Monto total de la transacción (impuestos incluidos.)<br>Se envía sin coma ni punto; los dos últimos dígitos representan los decimales.<br>Ej. 1000 equivale a 10.00<br> Ej. 1748321 equivale a 17,483.21s                                                            | Si          | Si   |
| ITBIS                 | Valor del ITBIS. Igual formato que el campo Amount<br>Si la transacción o el negocio están exentos, se envía en cero o simplemente no incluir en la solicitud.<br>Ej. 000 equivale a 0.00<br> Ej. 1000 equivale a 10.00                                              | Si          | Si   |
| ApprovedUrl           | La URL donde será enviado el cliente final al finalizar la transacción con resultado aprobado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                      | Si          | Si   |
| DeclinedUrl           | La URL donde será enviado el cliente final al concluir la transacción con resultado declinado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                      | Si          | Si   |
| CancelUrl             | La URL donde será enviado el cliente final al cancelar la transacción. En este caso no son enviados parámetros en el “querystring”.                                                                                                                                  | Si          | Si   |
| UseCustomField1       | Estos campos son utilizados para proveer información adicional de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                                                                 | Si          | Si   |
| CustomField1Label     | Este campo corresponde al label del campo de detalle #1. Si “UseCustomField” es 1, este campo debe tener información                                                                                                                                                 | No          | Si   |
| CustomField1Value     | Este campo corresponde a la información del “CustomField1Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                        | No          | Si   |
| UseCustomField2       | Estos campos son utilizados para proveer información adicional correspondiente al segundo grupo de datos de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                       | Si          | Si   |
| CustomField2Label     | Este campo corresponde al label del campo de detalle #2. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                                | No          | Si   |
| CustomField2Value     | Este campo corresponde a la información del “CustomField2Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                        | No          | Si   |
| ShowTransactionResult | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                                                                     | No          | No   |
| AuthHash              | Es un hash SHA-512 que se debe proveer para fines de autenticación. Verifique el acápite "Manejo de la Autenticación" donde se detalla cómo se genera este hash.                                                                                                     | Si          | N/A  |
| Locale                | Valores posibles ES (español) – EN (Inglés).<br>Muestra el payment page en el idioma seleccionado (Español / Inglés). Si no se manda el campo, se usa español por defecto.                                                                                           | No          | No   |
| SaveToDataVault       | Campo que da la instrucción a PaymentPage indicando que la tarjeta que digite el cliente final sea guardada en Azul. (ver sección Datavault en este documento.). Valores:<br>1 = Guardar<br>0 = No guardar<br>Si el campo se encuentra ausente, se asume el valor 0. | No          | No   |
| DataVaultToken        | Campo que debe contener el token generado por Azul previamente. Si se manda este campo con el token, Azul no va a pedir la tarjeta al cliente final. Solo exigirá el Código de Seguridad, de encontrarse habilitado.                                                 | No          | No   |

## Experiencia de pago

Cuando el cliente pulsa pagar su compra, el sistema dirige a la Página de Pago AZUL.

## Flujo de transacción

1\. Requiere incluir número de tarjeta, fecha de expiración y código de seguridad.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture37.jpg)

2\. Confirma las informaciones incluidas, pulsa “Continuar” si todo está correcto, “Modificar” para ir a la pantalla anterior y corregir cualquier información y/o “Cancelar” para cancelar la transacción:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture38.png)

Si el cliente pulsa “Cancelar” le saldrá una pantalla para que confirme si desea cancelar la transacción o volver a la compra. Al pulsar “Cancelar” dirige a la página del comercio. “Volver a la compra” dirige a la primera pantalla de la Página de Pago.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture39.jpg)

## Respuesta “Aprobada”

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture40.png)

## Respuesta “Declinada”

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture41.png)

3\. Al finalizar el cliente debe pulsar “Continuar”, para volver a la pantalla del comercio y enviar los resultados de la transacción al mismo.

## Diseño personalizable

Nueva línea gráfica para la Página de Pago, se deberá enviar un campo adicional para activar el diseño nuevo (DesignV2), y opcionalmente dos (2) campos que le permitirán indicar un logo y una imagen a ser mostradas en el diseño.

## Campos nuevos y compatibilidad

Para activar el nuevo formato el comercio deberá enviar un campo obligatorio, y dos opcionales:

## Captura manual de transacciones

Si tu comercio pertenece a categorías donde el monto final de facturación puede variar según la disponibilidad de artículos en tu establecimiento, ponemos a tu disposición mediante tu Página de Pagos las transacciones de hold o pre-autorizaciones, las cuales te permiten cerrar el pago posteriormente por el monto real facturado al cliente

- Cliente realiza el pago en tu tienda E-Commerce en la Página de Pagos, mediante una transacción de “Hold”. ¡Disponible también en el nuevo diseño donde puedes colocar tu logo e imagen de artículo de venta!
- Al despachar la orden, completas la transacción mediante una transacción de post-autorización por el monto total facturado. En este paso, tu cliente no requiere reingresar sus datos, sólo nos envías la transacción mediante tu integración con nosotros de Página de Pagos y te enviamos la respuesta.
- En el caso de que decidas anular la orden por no disponibilidad, nos envías una transacción “Void” para cancelar el pago.

Algunas consideraciones importantes:

- Recuerda siempre completar el pago tan pronto finalices tu proceso de facturación por el monto final de la venta. En caso de no completar la pre-autorización, la misma será reversada de forma automática por el banco emisor de la tarjeta en un plazo promedio de siete (7) días calendario, en cuyo caso tendrás que gestionar el cobro con tu cliente nuevamente para poder recibir el pago correspondiente.
- El monto para completar la autorización puede ser igual o menor al monto que fue pre-autorizado.
- Te recomendamos avisar a tu cliente que el monto por el que será completada la venta puede variar según disponibilidad, para evitar casos de reclamaciones por monto no reconocido del cargo realizado

## Transacción de Venta con sólo reserva de fondos (HOLD)

Para realizar una transacción con solo reserva de fondos o “Hold”, debe realizar un requerimiento idéntico al de venta, incluyendo además un campo con nombre “TrxType” con el valor "Hold". En la respuesta de la transacción recibirá el parámetro AzulOrderld. Deberá guardar este valor para posteriormente realizar el posteo o “Post” de esta transacción “Hold”.

| Página de Pagos       |
| --------------------- |
| Parámetros de Entrada |
| ---                   |
| Parámetro             | Descripción                                                                                                                                                                                                                                                          | Obligatorio | HASH |
| ---                   | ---                                                                                                                                                                                                                                                                  | ---         | ---  |
| MerchantID            | Número de identificación del comercio asignado al momento de afiliación a AZUL                                                                                                                                                                                       | Si          | Si   |
| MerchantName          | Nombre del comercio a ser desplegado e en la página de pago.                                                                                                                                                                                                         | Si          | Si   |
| OrderNumber           | El número de orden de la transacción                                                                                                                                                                                                                                 | Si          | Si   |
| TrxType               | Valor Fijo “HOLD”                                                                                                                                                                                                                                                    | Si          | Si   |
| MerchantType          | Tipo de comercio (de carácter informativo)                                                                                                                                                                                                                           | Si          | Si   |
| CurrencyCode          | Moneda de la transacción<br>Cada MID o tienda transacciona con una sola moneda.<br>Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                 | Si          | Si   |
| Amount                | Monto total de la transacción (impuestos incluidos.)<br>Se envía sin coma ni punto; los dos últimos dígitos representan los decimales.<br>Ej. 1000 equivale a 10.00<br> Ej. 1748321 equivale a 17,483.21s                                                            | Si          | Si   |
| ITBIS                 | Valor del ITBIS. Igual formato que el campo Amount<br>Si la transacción o el negocio están exentos, se envía en cero o simplemente no incluir en la solicitud.<br>Ej. 000 equivale a 0.00<br> Ej. 1000 equivale a 10.00                                              | Si          | Si   |
| ApprovedUrl           | La URL donde será enviado el cliente final al finalizar la transacción con resultado aprobado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                      | Si          | Si   |
| DeclinedUrl           | La URL donde será enviado el cliente final al concluir la transacción con resultado declinado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                      | Si          | Si   |
| CancelUrl             | La URL donde será enviado el cliente final al cancelar la transacción. En este caso no son enviados parámetros en el “querystring”.                                                                                                                                  | Si          | Si   |
| UseCustomField1       | Estos campos son utilizados para proveer información adicional de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                                                                 | Si          | Si   |
| CustomField1Label     | Este campo corresponde al label del campo de detalle #1. Si “UseCustomField” es 1, este campo debe tener información                                                                                                                                                 | No          | Si   |
| CustomField1Value     | Este campo corresponde a la información del “CustomField1Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                        | No          | Si   |
| UseCustomField2       | Estos campos son utilizados para proveer información adicional correspondiente al segundo grupo de datos de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                       | Si          | Si   |
| CustomField2Label     | Este campo corresponde al label del campo de detalle #2. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                                | No          | Si   |
| CustomField2Value     | Este campo corresponde a la información del “CustomField2Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                        | No          | Si   |
| ShowTransactionResult | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                                                                     | No          | No   |
| AuthHash              | Es un hash SHA-512 que se debe proveer para fines de autenticación. Verifique el acápite "Manejo de la Autenticación" donde se detalla cómo se genera este hash.                                                                                                     | Si          | N/A  |
| Locale                | Valores posibles ES (español) – EN (Inglés).<br>Muestra el payment page en el idioma seleccionado (Español / Inglés). Si no se manda el campo, se usa español por defecto.                                                                                           | No          | No   |
| SaveToDataVault       | Campo que da la instrucción a PaymentPage indicando que la tarjeta que digite el cliente final sea guardada en Azul. (ver sección Datavault en este documento.). Valores:<br>1 = Guardar<br>0 = No guardar<br>Si el campo se encuentra ausente, se asume el valor 0. | No          | No   |
| DataVaultToken        | Campo que debe contener el token generado por Azul previamente. Si se manda este campo con el token, Azul no va a pedir la tarjeta al cliente final. Solo exigirá el Código de Seguridad, de encontrarse habilitado.                                                 | No          | No   |

## Transacción para posteo de la pre-autorización (POST)

Para realizar el posteo o “Post”, es necesario que realice la misma transacción, pero indicando “Post” en el campo “TrxType” e incluyendo en el campo “AzulOrderId” el valor recibido en la transacción original (el valor que hemos guardado en el proceso “Hold”), así Payment Page puede encontrar la transacción original. El monto de la transacción de posteo puede ser igual, o inferior al monto de la transacción original. Es importante notar que para esta transacción de Post no se presenta interfaz gráfico, el sistema realizará la transacción y redirigirá inmediatamente de vuelta a su site.

| Página de Pago AZUL   |
| --------------------- |
| Parámetros de Entrada |
| ---                   |
| Parámetro             | Descripción                                                                                                                                                                                                                                                          | Obligatorio | HASH |
| ---                   | ---                                                                                                                                                                                                                                                                  | ---         | ---  |
| MerchantID            | Número de identificación del comercio asignado al momento de afiliación a AZUL                                                                                                                                                                                       | Si          | Si   |
| OrderNumber           | El número de orden de la transacción                                                                                                                                                                                                                                 | Si          | Si   |
| MerchantName          | Nombre del comercio a ser desplegado e en la página de pago.                                                                                                                                                                                                         | Si          | Si   |
| TrxType               | Valor Fijo “POST”                                                                                                                                                                                                                                                    | Si          | Si   |
| MerchantType          | Tipo de comercio (de carácter informativo)                                                                                                                                                                                                                           | Si          | Si   |
| CurrencyCode          | Moneda de la transacción<br>Cada MID o tienda transacciona con una sola moneda. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                    | Si          | Si   |
| AzulOrderID           | El número de orden de la transacción (valor que guardamos de los resultados obtenidos en la transacción “hold”).                                                                                                                                                     | Si          | Si   |
| Amount                | Monto total de la transacción (impuestos incluidos.)<br>Se envía sin coma ni punto; los dos últimos dígitos representan los decimales.<br>Ej. 1000 equivale a 10.00<br> Ej. 1748321 equivale a 17,483.21s                                                            | Si          | Si   |
| ITBIS                 | Valor del ITBIS. Igual formato que el campo Amount<br>Si la transacción o el negocio están exentos, se envía en cero o simplemente no incluir en la solicitud.<br>Ej. 000 equivale a 0.00<br> Ej. 1000 equivale a 10.00                                              | Si          | Si   |
| ApprovedUrl           | La URL donde será enviado el cliente final al finalizar la transacción con resultado aprobado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                      | Si          | Si   |
| DeclinedUrl           | La URL donde será enviado el cliente final al concluir la transacción con resultado declinado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                      | Si          | Si   |
| CancelUrl             | La URL donde será enviado el cliente final al cancelar la transacción. En este caso no son enviados parámetros en el “querystring”.                                                                                                                                  | Si          | Si   |
| UseCustomField1       | Estos campos son utilizados para proveer información adicional de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                                                                 | Si          | Si   |
| CustomField1Label     | Este campo corresponde al label del campo de detalle #1. Si “UseCustomField” es 1, este campo debe tener información                                                                                                                                                 | No          | Si   |
| CustomField1Value     | Este campo corresponde a la información del “CustomField1Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                        | No          | Si   |
| UseCustomField2       | Estos campos son utilizados para proveer información adicional correspondiente al segundo grupo de datos de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                       | Si          | Si   |
| CustomField2Label     | Este campo corresponde al label del campo de detalle #2. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                                | No          | Si   |
| CustomField2Value     | Este campo corresponde a la información del “CustomField2Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                        | No          | Si   |
| ShowTransactionResult | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                                                                     | No          | No   |
| AuthHash              | Es un hash SHA-512 que se debe proveer para fines de autenticación. Verifique el acápite "Manejo de la Autenticación" donde se detalla cómo se genera este hash.                                                                                                     | Si          | N/A  |
| Locale                | Valores posibles ES (español) – EN (Inglés).<br>Muestra el payment page en el idioma seleccionado (Español / Inglés). Si no se manda el campo, se usa español por defecto.                                                                                           | No          | No   |
| SaveToDataVault       | Campo que da la instrucción a PaymentPage indicando que la tarjeta que digite el cliente final sea guardada en Azul. (ver sección Datavault en este documento.). Valores:<br>1 = Guardar<br>0 = No guardar<br>Si el campo se encuentra ausente, se asume el valor 0. | No          | No   |
| DataVaultToken        | Campo que debe contener el token generado por Azul previamente. Si se manda este campo con el token, Azul no va a pedir la tarjeta al cliente final. Solo exigirá el Código de Seguridad, de encontrarse habilitado.                                                 | No          | No   |

| Valores de Retorno          |
| --------------------------- |
| Parámetro                   | Descripción                                                                                                                                   | HASH |
| ---                         | ---                                                                                                                                           | ---  |
| OrderNumber                 | El número de orden de la transacción.                                                                                                         | Si   |
| Amount                      | Monto final del posteo                                                                                                                        | Si   |
| ITBIS                       | ITBIS final del posteo                                                                                                                        | No   |
| AuthorizationCode           | Código de autorización en caso de que la transacción haya sido aprobada.                                                                      | Si   |
| DateTime                    | Fecha de la transacción.                                                                                                                      | Si   |
| ResponseCode                | Respuesta de la transacción.                                                                                                                  | Si   |
| IsoCode                     | Respuesta de la transacción.                                                                                                                  | Si   |
| ResponseMessage             | Respuesta de la transacción.                                                                                                                  | Si   |
| ErrorDescription            | Respuesta de la transacción.                                                                                                                  | Si   |
| RRN<br>Número de referencia | (Reference referral number).                                                                                                                  | Si   |
| DataVaultToken              | En caso de que se reciba el campo SaveToDataVault con valor 1, Payment Page retornará el token generado para la tarjeta usada por el cliente. | No   |
| DataVaultExpiration         | Expiración del token en formato AAAAMM                                                                                                        | No   |
| DataVaultBrand              | Marca de la tarjeta usada (visa, mc, etc.)                                                                                                    | No   |
| AzulOrderId                 | \# de orden de procesador Azul                                                                                                                | No   |
| Datavault                   |                                                                                                                                               |      |

## Transacción para anular transacción (VOID)

Esta transacción puede ser realizada tanto para anular pre-autorizaciones, como posteos y ventas, según las especificaciones siguientes:

- Para transacciones de hold (pre-autorizaciones), el void (anulación) puede ser realizado en cualquier momento.
- Para transacciones de post y venta, el void (anulación) puede ser realizado sólo durante un periodo de 20 minutos posteriores a la realización del posteo o venta. Una vez transcurrido este tiempo, la transacción no podrá ser anulada, por lo que se deberá gestionar una devolución, en caso de ser requerido.

Para realizar una transacción Void (anulación), debe realizar un requerimiento idéntico al de venta, incluyendo además un campo con nombre “TrxType” y valor “Void”, y otro campo “AzulOrderld” con el valor recibido en la transacción original a ser cancelada. Puede realizar una cancelación para una transacción de venta normal, hold o post. Es importante notar que para esta transacción de Void no se presenta interfaz gráfica, el sistema realizará la transacción y redirigirá inmediatamente de vuelta a su site.

| Página de Pago AZUL   |
| --------------------- |
| Parámetros de Entrada |
| ---                   |
| Parámetro             | Descripción                                                                                                                                                                                                                    | Obligatorio | HASH |
| ---                   | ---                                                                                                                                                                                                                            | ---         | ---  |
| MerchantID            | Número de identificación del comercio asignado al momento de afiliación a AZUL                                                                                                                                                 | Si          | Si   |
| OrderNumber           | El número de orden de la transacción                                                                                                                                                                                           | Si          | Si   |
| MerchantName          | Nombre del comercio a ser desplegado e en la página de pago.                                                                                                                                                                   | Si          | Si   |
| TrxType               | Valor Fijo “VOID”                                                                                                                                                                                                              | Si          | Si   |
| MerchantType          | Tipo de comercio (de carácter informativo)                                                                                                                                                                                     | Si          | Si   |
| CurrencyCode          | Moneda de la transacción<br>Cada MID o tienda transacciona con una sola moneda.<br>Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                           | Si          | Si   |
| AzulOrderID           | El número de orden de la transacción.                                                                                                                                                                                          | Si          | Si   |
| Amount                | Monto total de la transacción (impuestos incluidos.)<br>Se envía sin coma ni punto; los dos últimos dígitos representan los decimales.<br>Ej. 1000 equivale a 10.00<br> Ej. 1748321 equivale a 17,483.21s                      | Si          | Si   |
| ITBIS                 | Valor del ITBIS. Igual formato que el campo Amount<br>Si la transacción o el negocio están exentos, se envía en cero o simplemente no incluir en la solicitud.<br>Ej. 000 equivale a 0.00<br> Ej. 1000 equivale a 10.00        | Si          | Si   |
| ApprovedUrl           | La URL donde será enviado el cliente final al finalizar la transacción con resultado aprobado. En el “querystring” son enviados los parámetros de la respuesta.                                                                | Si          | Si   |
| DeclinedUrl           | La URL donde será enviado el cliente final al concluir la transacción con resultado declinado. En el “querystring” son enviados los parámetros de la respuesta.                                                                | Si          | Si   |
| CancelUrl             | La URL donde será enviado el cliente final al cancelar la transacción. En este caso no son enviados parámetros en el “querystring”.                                                                                            | Si          | Si   |
| UseCustomField1       | Estos campos son utilizados para proveer información adicional de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                           | Si          | Si   |
| CustomField1Label     | Este campo corresponde al label del campo de detalle #1. Si “UseCustomField” es 1, este campo debe tener información                                                                                                           | No          | Si   |
| CustomField1Value     | Este campo corresponde a la información del “CustomField1Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                  | No          | Si   |
| UseCustomField2       | Estos campos son utilizados para proveer información adicional correspondiente al segundo grupo de datos de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas | Si          | Si   |
| CustomField2Label     | Este campo corresponde al label del campo de detalle #2. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                          | No          | Si   |
| CustomField2Value     | Este campo corresponde a la información del “CustomField2Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                  | No          | Si   |
| ShowTransactionResult | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                               | No          | No   |
| AuthHash              | Es un hash SHA-512 que se debe proveer para fines de autenticación. Verifique el acápite "Manejo de la Autenticación" donde se detalla cómo se genera este hash.                                                               | Si          | N/A  |
| Locale                | Valores posibles ES (español) – EN (Inglés).<br>Muestra el payment page en el idioma seleccionado (Español / Inglés). Si no se manda el campo, se usa español por defecto.                                                     | No          | No   |

| Valores de Retorno          |
| --------------------------- |
| Parámetro                   | Descripción                                                                                                                                   | HASH |
| ---                         | ---                                                                                                                                           | ---  |
| OrderNumber                 | El número de orden de la transacción.                                                                                                         | Si   |
| Amount                      | Monto final del posteo                                                                                                                        | Si   |
| ITBIS                       | ITBIS final del posteo                                                                                                                        | No   |
| AuthorizationCode           | Código de autorización en caso de que la transacción haya sido aprobada.                                                                      | Si   |
| DateTime                    | Fecha de la transacción.                                                                                                                      | Si   |
| ResponseCode                | Respuesta de la transacción.                                                                                                                  | Si   |
| IsoCode                     | Respuesta de la transacción.                                                                                                                  | Si   |
| ResponseMessage             | Respuesta de la transacción.                                                                                                                  | Si   |
| ErrorDescription            | Respuesta de la transacción.                                                                                                                  | Si   |
| RRN<br>Número de referencia | (Reference referral number).                                                                                                                  | Si   |
| DataVaultToken              | En caso de que se reciba el campo SaveToDataVault con valor 1, Payment Page retornará el token generado para la tarjeta usada por el cliente. | No   |
| DataVaultExpiration         | Expiración del token en formato AAAAMM                                                                                                        | No   |
| DataVaultBrand              | Marca de la tarjeta usada (visa, mc, etc.)                                                                                                    | No   |
| AzulOrderId                 | \# de orden de procesador Azul                                                                                                                | No   |
| Datavault                   |                                                                                                                                               |      |

## Data Vault

El campo SaveToDataVault corresponde a una instrucción indicando a Payment Page Azul que la tarjeta que sea usada sea guardada por AZUL y se le devuelva al comercio un token generado para la misma. El token será un valor generado de forma aleatoria y asignado a la tarjeta usada en este comercio en específico. Su formato es alfanumérico de 30 a 40 posiciones

Ejemplos:

- FE1525FD-A59B-476A-9EFA-387D510689AB
- 40E35437-F8AF-4039-BE8B-4B3C68D9B516

Valores posibles de campo SaveToDataVault:

1: Al estar en 1, PaymentPage guardará la tarjeta y responderá con el token generado. Este escenario solo es en el caso de ser aprobada dicha tarjeta.

## Respuesta Datavault

Al usar DataVault, se recibirán de manera adicional los siguientes campos:

- DataVaultToken = Token generado
- DataVaultExpiration= Expiración del token en formato MMAA
- DataVaultBrand= Marca de la tarjeta usada (visa, mc, etc.)
- AzulOrderId= # de orden de procesador Azul

## Creación Token Datavault

Se le ofrece al comercio la posibilidad de enviar a Payment Page un mensaje para solo capturar el token.

Se deben enviar los siguientes parámetros de entrada. El hash es calculado igual que para una venta normal.

| Página de Pago AZUL   |
| --------------------- |
| Parámetros de Entrada |
| ---                   |
| Parámetro             | Descripción                                                                                                                                                                                                                                                          | Obligatorio | HASH |
| ---                   | ---                                                                                                                                                                                                                                                                  | ---         | ---  |
| MerchantID            | Número de identificación del comercio asignado al momento de afiliación a AZUL                                                                                                                                                                                       | Si          | Si   |
| MerchantName          | Nombre del comercio a ser desplegado e en la página de pago.                                                                                                                                                                                                         | Si          | Si   |
| MerchantType          | Tipo de comercio (de carácter informativo)                                                                                                                                                                                                                           | Si          | Si   |
| ApprovedUrl           | La URL donde será enviado el cliente final al finalizar la transacción con resultado aprobado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                      | Si          | Si   |
| TrxType               | CREATE                                                                                                                                                                                                                                                               | Si          | Si   |
| DatavaultToken        | Sin valor                                                                                                                                                                                                                                                            | Si          | Si   |
| DeclinedUrl           | La URL donde será enviado el cliente final al concluir la transacción con resultado declinado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                      | Si          | Si   |
| CancelUrl             | La URL donde será enviado el cliente final al cancelar la transacción. En este caso no son enviados parámetros en el “querystring”.                                                                                                                                  | Si          | Si   |
| ShowTransactionResult | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                                                                     | No          | No   |
| UseCustomField1       | Estos campos son utilizados para proveer información adicional de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                                                                 | Si          | Si   |
| CustomField1Label     | Este campo corresponde al label del campo de detalle #1. Si “UseCustomField” es 1, este campo debe tener información                                                                                                                                                 | No          | Si   |
| CustomField1Value     | Este campo corresponde a la información del “CustomField1Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                        | No          | Si   |
| UseCustomField2       | Estos campos son utilizados para proveer información adicional correspondiente al segundo grupo de datos de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                       | Si          | Si   |
| CustomField2Label     | Este campo corresponde al label del campo de detalle #2. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                                | No          | Si   |
| CustomField2Value     | Este campo corresponde a la información del “CustomField2Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                        | No          | Si   |
| Locale                | Valores posibles ES (español) – EN (Inglés).<br>Muestra el payment page en el idioma seleccionado (Español / Inglés). Si no se manda el campo, se usa español por defecto.                                                                                           | No          | No   |
| SaveToDataVault       | Campo que da la instrucción a PaymentPage indicando que la tarjeta que digite el cliente final sea guardada en Azul. (ver sección Datavault en este documento.). Valores:<br>1 = Guardar<br>0 = No guardar<br>Si el campo se encuentra ausente, se asume el valor 0. | No          | No   |
| DataVaultToken        | Campo que debe contener el token generado por Azul previamente. Si se manda este campo con el token, Azul no va a pedir la tarjeta al cliente final. Solo exigirá el Código de Seguridad, de encontrarse habilitado.                                                 | No          | No   |
| ShowTransactionResult | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                                                                     | No          | No   |

Se debe enviar en el campo TrxType el valor “Create” y dejar el campo DataVaultToken vacío:

Payment Page solicitará al cliente final su tarjeta y devolverá al comercio un querystring con el token generado. Tomar en cuenta que vendrá un mensaje con ISO CODE 00.

Campos de respuesta:

| Página de Pago AZUL  |
| -------------------- |
| Valores de Retorno   |
| ---                  |
| Parámetro            | Descripción                                            |
| ---                  | ---                                                    |
| ISO CODE             | Si es satisfactorio, se recibe 00                      |
| RESPONSE MESSAGE     | Si es satisfactorio, se recibe APROBADA                |
| ERROR DESCRIPTION    | Si hay error, se coloca la descripción aquí            |
| CARDNUMBER           | Tarjeta enmascarada                                    |
| DATAVAULT TOKEN      | Valor del token generado (35 posiciones alfanuméricas) |
| DATAVAULT EXPIRATION | Expiración del token (AAAAMM)                          |
| DATAVAULTBRAND       | Marca de la tarjeta                                    |
| AUTHHASH             | Hash de respuesta                                      |

Ej.:

&IsoCode=00&ResponseMessage=APROBADA&ErrorDescription=&CardNumber=554941...8810&DataVaultToken=734016F2-00E5-4611-948C-8179FB2B8C74&DataVaultExpiration=201912&DataVaultBrand=MASTERCARD&AuthHash=jkhsakdhsaljhdls

Al enviar esta respuesta, se calcula el hash con los campos siguientes:

- IsoCode
- ResponseMessage
- ErrorDescription
- CardNumber
- DataVaultToken
- DataVaultExpiration
- DataVaultBrand
- AuthKey

Al usar este método, se debe enviar la mensajería a la misma url de paymentpage, agregando ?Datavault=1. Ejemplo: <https://pagos.azul.com.do/PaymentPage/?Datavault=1>

## Transacción de Venta Utilizando Token Datavault

El comercio contará con la posibilidad de enviar a Payment Page un mensaje para realizar la transacción de venta utilizando el token previamente generado para la tarjeta.

| Página de Pago AZUL   |
| --------------------- |
| Parámetros de Entrada |
| ---                   |
| Parámetro             | Descripción                                                                                                                                                                                                                    | Obligatorio | HASH |
| ---                   | ---                                                                                                                                                                                                                            | ---         | ---  |
| MerchantID            | Número de identificación del comercio asignado al momento de afiliación a AZUL                                                                                                                                                 | Si          | Si   |
| MerchantName          | Nombre del comercio a ser desplegado e en la página de pago.                                                                                                                                                                   | Si          | Si   |
| MerchantType          | Tipo de comercio (de carácter informativo)                                                                                                                                                                                     | Si          | Si   |
| ApprovedUrl           | La URL donde será enviado el cliente final al finalizar la transacción con resultado aprobado. En el “querystring” son enviados los parámetros de la respuesta.                                                                | Si          | Si   |
| DatavaultToken        | FE1525FD-A59B-476A-9EFA-387D510689A                                                                                                                                                                                            | Si          | Si   |
| DeclinedUrl           | La URL donde será enviado el cliente final al concluir la transacción con resultado declinado. En el “querystring” son enviados los parámetros de la respuesta.                                                                | Si          | Si   |
| CancelUrl             | La URL donde será enviado el cliente final al cancelar la transacción. En este caso no son enviados parámetros en el “querystring”.                                                                                            | Si          | Si   |
| ShowTransactionResult | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                               | No          | No   |
| UseCustomField1       | Estos campos son utilizados para proveer información adicional de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                           | Si          | Si   |
| CustomField1Label     | Este campo corresponde al label del campo de detalle #1. Si “UseCustomField” es 1, este campo debe tener información                                                                                                           | No          | Si   |
| CustomField1Value     | Este campo corresponde a la información del “CustomField1Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                  | No          | Si   |
| UseCustomField2       | Estos campos son utilizados para proveer información adicional correspondiente al segundo grupo de datos de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas | Si          | Si   |
| CustomField2Label     | Este campo corresponde al label del campo de detalle #2. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                          | No          | Si   |
| CustomField2Value     | Este campo corresponde a la información del “CustomField2Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                  | No          | Si   |
| Locale                | Valores posibles ES (español) – EN (Inglés).<br>Muestra el payment page en el idioma seleccionado (Español / Inglés). Si no se manda el campo, se usa español por defecto.                                                     | No          | No   |
| SaveToDataVault       | Se debe colocar el valor 0 indicando el no almacenar la tarjeta debido al uso del token en esta transacción. (ver sección Datavault en este documento.)<br>Si el campo se encuentra ausente, se asume el valor 0.              | No          | No   |
| DataVaultToken        | Campo que debe contener el token generado por Azul previamente. Si se manda este campo con el token, AZUL no va a pedir la tarjeta al cliente final. Solo exigirá el Código de Seguridad, de encontrarse habilitado.           | Si          | No   |
| ShowTransactionResult | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                               | No          | No   |

Campos de respuesta:

| Página de Pago AZUL  |
| -------------------- |
| Valores de Retorno   |
| ---                  |
| Parámetro            | Descripción                                 |
| ---                  | ---                                         |
| ISO CODE             | Si es satisfactorio, se recibe 00           |
| RESPONSE MESSAGE     | Si es satisfactorio, se recibe APROBADA     |
| ERROR DESCRIPTION    | Si hay error, se coloca la descripción aquí |
| CARDNUMBER           | Tarjeta enmascarada                         |
| DATAVAULT TOKEN      | N\\A                                        |
| DATAVAULT EXPIRATION | Expiración del token (AAAAMM)               |
| DATAVAULTBRAND       | Marca de la tarjeta                         |
| AUTHHASH             | Hash de respuesta                           |

## Eliminar Token

Se coloca en el campo TrxType el valor “Delete” y en el campo datavaulttoken se debe colocar el token que se desea eliminar. Si es exitosa, se devuelve 00 en el ISO CODE.

| Página de Pago AZUL       |
| ------------------------- |
| Parámetros de Entrada     |
| ---                       |
| Parámetro                 | Descripción                                                                                                                                                                                                                                                          | Obligatorio | HASH |
| ---                       | ---                                                                                                                                                                                                                                                                  | ---         | ---  |
| MerchantID                | Número de identificación del comercio asignado al momento de afiliación a AZUL                                                                                                                                                                                       | Si          | Si   |
| MerchantName              | Nombre del comercio a ser desplegado e en la página de pago.                                                                                                                                                                                                         | Si          | Si   |
| MerchantType              | Tipo de comercio (de carácter informativo)                                                                                                                                                                                                                           | Si          | Si   |
| **ApprovedUrl**           | La URL donde será enviado el cliente final al finalizar la transacción con resultado aprobado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                      | Si          | Si   |
| **TrxType**               | DELETE                                                                                                                                                                                                                                                               | Si          | No   |
| **DatavaultToken**        | Sin valor                                                                                                                                                                                                                                                            | Si          | No   |
| **DeclinedUrl**           | La URL donde será enviado el cliente final al concluir la transacción con resultado declinado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                      | Si          | Si   |
| **CancelUrl**             | La URL donde será enviado el cliente final al cancelar la transacción. En este caso no son enviados parámetros en el “querystring”.                                                                                                                                  | Si          | Si   |
| **ShowTransactionResult** | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                                                                     | No          | No   |
| UseCustomField1           | Estos campos son utilizados para proveer información adicional de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                                                                 | Si          | Si   |
| CustomField1Label         | Este campo corresponde al label del campo de detalle #1. Si “UseCustomField” es 1, este campo debe tener información                                                                                                                                                 | No          | Si   |
| **CustomField1Value**     | Este campo corresponde a la información del “CustomField1Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                        | No          | Si   |
| **UseCustomField2**       | Estos campos son utilizados para proveer información adicional correspondiente al segundo grupo de datos de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                       | Si          | Si   |
| **CustomField2Label**     | Este campo corresponde al label del campo de detalle #2. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                                | No          | Si   |
| **CustomField2Value**     | Este campo corresponde a la información del “CustomField2Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                        | No          | Si   |
| **Locale**                | Valores posibles ES (español) – EN (Inglés).<br>Muestra el payment page en el idioma seleccionado (Español / Inglés). Si no se manda el campo, se usa español por defecto.                                                                                           | No          | No   |
| SaveToDataVault           | Campo que da la instrucción a PaymentPage indicando que la tarjeta que digite el cliente final sea guardada en Azul. (ver sección Datavault en este documento.). Valores:<br>1 = Guardar<br>0 = No guardar<br>Si el campo se encuentra ausente, se asume el valor 0. | No          | No   |
| **DataVaultToken**        | Campo que debe contener el token generado por Azul previamente. Si se manda este campo con el token, AZUL no va a pedir la tarjeta al cliente final. Solo exigirá el Código de Seguridad, de encontrarse habilitado.                                                 | No          | No   |
| **ShowTransactionResult** | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                                                                     | No          | No   |

## Campos para Generación HASH

- IsoCode
- ResponseMessage
- ErrorDescription
- CardNumber
- DataVaultToken
- DataVaultExpiration
- DataVaultBrand
- AuthKey

| Página de Pago AZUL  |
| -------------------- |
| Valores de Retorno   |
| ---                  |
| Parámetro            | Descripción                                            |
| ---                  | ---                                                    |
| ISO CODE             | Si es satisfactorio, se recibe 00                      |
| RESPONSE MESSAGE     | Si es satisfactorio, se recibe APROBADA                |
| ERROR DESCRIPTION    | Si hay error, se coloca la descripción aquí            |
| CARDNUMBER           | Sin valor                                              |
| DATAVAULT TOKEN      | Valor del token generado (35 posiciones alfanuméricas) |
| DATAVAULT EXPIRATION | Sin valor                                              |
| DATAVAULTBRAND       | Marca de la tarjeta                                    |
| AUTHHASH             | Hash de respuesta                                      |

## 3D Secure

Si el comercio tiene habilitada la funcionalidad de 3D Secure (autenticación del tarjetahabiente), pueden suceder 2 cosas al realizar una transacción de venta:

- Tarjeta de cliente final usa 3DSecure
- Tarjeta de cliente final no usa 3DSecure

En ambos casos el mensaje de entrada/salida es similar al de una venta normal. La diferencia radica en que, al cliente, si tiene 3D Secure, se le redirige a una URL generada por la institución emisora de su tarjeta para realizar una autenticación adicional.

Ejemplo:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture43.png)

Al haber una respuesta de 3D Secure, se efectúa el redirect al site del emisor de la tarjeta:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture44.jpg)

El cliente debe autenticarse en el site del emisor de la tarjeta, si aplica:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture45.png)

Tras una autenticación exitosa, aparecerá el resultado de la transacción de forma normal en el PaymentPage, de la misma forma que si fuera una transacción normal sin 3D Secure:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture46.jpg)

## PayPal

Para agregar el botón de PayPal en la página de pagos de AZUL, el comercio debe proveer a AZUL el ClientID otorgado por PayPal, adicionalmente es necesario enviar los siguientes campos

| Página de Pagos                       |
| ------------------------------------- |
| Parámetros de Entrada                 |
| ---                                   |
| Parámetro                             | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                            | Obligatorio | HASH |
| ---                                   | ---                                                                                                                                                                                                                                                                                                                                                                                                                                                    | ---         | ---  |
| MerchantID                            | Número de identificación del comercio asignado al momento de afiliación a AZUL                                                                                                                                                                                                                                                                                                                                                                         | Si          | Si   |
| MerchantName                          | Nombre del comercio a ser desplegado e en la página de pago.                                                                                                                                                                                                                                                                                                                                                                                           | Si          | Si   |
| MerchantType                          | Tipo de comercio (de carácter informativo)                                                                                                                                                                                                                                                                                                                                                                                                             | Si          | Si   |
| CurrencyCode                          | Moneda de la transacción<br>Cada MID o tienda realiza transacciones con una sola moneda.<br>Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                          | Si          | Si   |
| OrderNumber                           | El número de orden de la transacción                                                                                                                                                                                                                                                                                                                                                                                                                   | Si          | Si   |
| Amount                                | Monto total de la transacción (impuestos incluidos.)<br>Se envía sin coma ni punto; los dos últimos dígitos representan los decimales.<br>Ej. 1000 equivale a 10.00<br> Ej. 1748321 equivale a 17,483.21s                                                                                                                                                                                                                                              | Si          | Si   |
| ITBIS                                 | Valor del ITBIS. Igual formato que el campo Amount<br>Si la transacción o el negocio están exentos, se envía en cero o simplemente no incluir en la solicitud.                                                                                                                                                                                                                                                                                         | Si          | Si   |
| ApprovedUrl                           | La URL donde será enviado el cliente final al finalizar la transacción con resultado aprobado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                                                                                                                                                                                                        | Si          | Si   |
| DeclinedUrl                           | La URL donde será enviado el cliente final al concluir la transacción con resultado declinado. En el “querystring” son enviados los parámetros de la respuesta.                                                                                                                                                                                                                                                                                        | Si          | Si   |
| CancelUrl                             | La URL donde será enviado el cliente final al cancelar la transacción. En este caso no son enviados parámetros en el “querystring”.                                                                                                                                                                                                                                                                                                                    | Si          | Si   |
| UseCustomField1                       | Estos campos son utilizados para proveer información adicional de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                                                                                                                                                                                                                                                   | Si          | Si   |
| CustomField1Label                     | Este campo corresponde al label del campo de detalle #1. Si “UseCustomField” es 1, este campo debe tener información                                                                                                                                                                                                                                                                                                                                   | No          | Si   |
| CustomField1Value                     | Este campo corresponde a la información del “CustomField1Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                                                                                                                                                                                                          | No          | Si   |
| UseCustomField2                       | Estos campos son utilizados para proveer información adicional correspondiente al segundo grupo de datos de la transacción al cliente final. Se debe completar con “1” para mostrar las informaciones o “0” para no mostrarlas                                                                                                                                                                                                                         | Si          | Si   |
| CustomField2Label                     | Este campo corresponde al label del campo de detalle #2. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                                                                                                                                                                                                                  | No          | Si   |
| CustomField2Value                     | Este campo corresponde a la información del “CustomField2Label”. Si “UseCustomField” es 1, este campo debe tener información.                                                                                                                                                                                                                                                                                                                          | No          | Si   |
| ShowTransactionResult                 | Mostrar página de resultado de AZUL<br>Si está ausente o es 1 -> Muestra pantalla de resultado de AZUL<br>Si es 0 -> no muestra la pantalla de resultado de AZUL                                                                                                                                                                                                                                                                                       | No          | No   |
| AuthHash                              | Es un hash SHA-512 que se debe proveer para fines de autenticación. Verifique el acápite "Manejo de la Autenticación" donde se detalla cómo se genera este hash.                                                                                                                                                                                                                                                                                       | Si          | N/A  |
| Locale                                | Valores posibles ES (español) – EN (Inglés).<br>Muestra el Payment Page en el idioma seleccionado (Español / Inglés). Si no se manda el campo, se usa español por defecto.                                                                                                                                                                                                                                                                             | No          | No   |
| AmountPayPalUSD                       | Monto de la transacción convertido a moneda USD                                                                                                                                                                                                                                                                                                                                                                                                        | Si          | Si   |
| PayPalShippingEnabled ("1" o "0")     | Este campo es utilizado para activar el envío de la dirección. Si el comercio vende un bien material o físico debe enviar como requerido la dirección, para esto el campo debe recibir el valor: “1” y adicionalmente todos los campos de shipping poblados conforme se especifica en cada uno. <br>En caso que el comercio se dedique a ofrecer bienes digitales o servicios debe enviar el valor: “0” ; no debe enviar los demás campos de Shipping. | Si          | Si   |
| PayPalShippingRecipientName (127,req) | Este campo debe indicar el nombre del cliente y el mismo tiene un máximo de 127 caracteres. <br>Es requerido siempre que el comercio haya enviado el valor “1” en el campo: PayPalShippingEnabled                                                                                                                                                                                                                                                      | No          | Si   |
| PayPalShippingLine1 (100,req)         | Este campo debe indicar la dirección del cliente y tiene un máximo de 100 caracteres. Por ejemplo, número, calle, etc. <br>Es requerido siempre que el comercio haya enviado el valor “1” en el campo: PayPalShippingEnabled                                                                                                                                                                                                                           | No          | Si   |
| PayPalShippingLine2 (100)             | Este campo debe indicar parte de la dirección ya sea apartamento, calle etc. y tiene un máximo de 10 caracteres. Por ejemplo, número de suite o apartamento. <br>Es requerido siempre que el comercio haya enviado el valor “1” en el campo: PayPalShippingEnabled                                                                                                                                                                                     | No          | Si   |
| PayPalShippingPostalCode (Req)        | Este campo debe indicar el código postal dependiendo el país. <br>Es requerido siempre que el comercio haya enviado el valor “1” en el campo: PayPalShippingEnabled                                                                                                                                                                                                                                                                                    | No          | Si   |
| PayPalShippingCity (64, req)          | Este campo debe indicar la ciudad y tiene un máximo de 64 caracteres. <br>Es requerido siempre que el comercio haya enviado el valor “1” en el campo: PayPalShippingEnabled                                                                                                                                                                                                                                                                            | No          | Si   |
| PayPalShippingState (40,req)          | Este campo debe indicar el estado y tiene un máximo de 40 caracteres. <br>Es requerido siempre que el comercio haya enviado el valor “1” en el campo: PayPalShippingEnabled                                                                                                                                                                                                                                                                            | No          | Si   |
| PayPalShippingCountryCode (2,req)     | Este campo debe indicar el código del país y tiene un máximo de 2 caracteres. Deben proveer el Region Code oficial de PayPal. Para más consultar los mismos puede acceder a esta URL: <https://developer.paypal.com/docs/integration/direct/rest/country-codes/><br>Es requerido siempre que el comercio haya enviado el valor “1” en el campo: PayPalShippingEnabled                                                                                  | No          | Si   |
| PayPalShippingPhone (50, req)         | Este campo debe indicar el número de teléfono o celular del cliente. <br>Es requerido siempre que el comercio haya enviado el valor “1” en el campo: PayPalShippingEnabled                                                                                                                                                                                                                                                                             | No          | Si   |
| PayPalShippingType (req)              | Este campo debe indicar el tipo de pago. Por ejemplo, Regalos, Pago adeudado, Adelanto en efectivo, etc. <br>Es requerido siempre que el comercio haya enviado el valor “1” en el campo: PayPalShippingEnabled                                                                                                                                                                                                                                         | No          | Si   |

| Valores de Retorno |
| ------------------ |
| Parámetro          | Descripción                                                                                        | HASH |
| ---                | ---                                                                                                | ---  |
| OrderNumber        | El número de orden enviado en el requerimiento inicial.                                            | Si   |
| Amount             | Monto original de la transacción.                                                                  | Si   |
| ITBIS              |                                                                                                    | No   |
| AuthorizationCode  | Código de autorización en caso de que la transacción haya sido aprobada.                           |      |
| DateTime           | Fecha de la transacción.                                                                           |      |
| ResponseCode       | Respuesta de la transacción. Nota: Esta respuesta siempre incluirá la palabra PayPal inicialmente. |      |
| IsoCode            | Respuesta de la transacción.                                                                       |      |
| RRN                | Número de referencia (Reference Referral Number)                                                   |      |

Una vez desarrollados los cambios con los campos necesarios, el comercio debe realizar pruebas de certificación en ambiente controlado. En estas pruebas se validará que dichos campos estén viajando en el formato adecuado, se realiza además un ciclo de pruebas integradas con el ambiente de pruebas de PayPal; esto implica que el comercio debe facilitar un ClientID de pruebas generado en la página oficial de pruebas de PayPal: <https://www.sandbox.paypal.com>

## IPN (Instant Payment Notification)

Es un servicio de mensajes que notifica automáticamente a los comerciantes de eventos relacionados con transacciones de PayPal.

Si el cliente dispone de este servicio debe indicarlo a AZUL y se le proveerá la URL que debe configurar en su página de PayPal para estos fines.

## ResponseCode status

El campo **ResponseCode**, puede recibir uno de estos posibles status:

## Manejo de la Autenticación (AuthHash)

El valor del campo AuthHash debe ser calculado concatenando los siguientes campos, exactamente en el orden indicado. El valor de AuthKey no es un campo enviado en los campos del POST, sino un valor entregado por AZUL al momento de la afiliación. Una vez concatenados los valores de los campos debe calcularse un hash HMAC SHA512, y pasar el valor de este a formato string hexadecimal. Este cálculo es indispensable para verificar que la transacción no es alterada. Para una transacción de venta, se sigue el siguiente orden.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture47.png)

### UNICODE

El HASH del requerimiento puede ser calculado desde una cadena UTF-8 o UNICODE. El sistema lo acepta indistintamente. Cabe destacar que Unicode es más seguro.

Cuando nuestra plataforma de pago retorna a la URL indicada en el requerimiento, se remite la información del resultado de la transacción y en la misma viaja un hash construido con los campos en el siguiente orden:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture48.png)

Nuevamente el key se utiliza para calcular el HASH pero no se envía. La generación de este se hace a partir de una cadena Unicode. Nota que el ITBIS, aunque viaja en la respuesta, no es utilizado en la construcción del HASH de la respuesta.

### **Ejemplo generación AuthHash del requerimiento en C\# (a partir de una cadena UNICODE)**

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture49.png)

### **Ejemplo generación AuthHash respuesta en PHP (a partir de una cadena UNICODE)**

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture50.png)

## Errores de validación

En caso que alguno de los campos no sea válido, el requerimiento esté mal formado o exista algún problema durante el requerimiento, la **Página de Pago AZUL** mostrará un mensaje y un código de error. Estos son los posibles errores:

| Código Error                            | Descripción                                                                                                                                                                                       |
| --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **VALIDATION\_ERROR:**<br>**FieldName** | Indica que uno de los campos del mensaje no fue enviado o no cumple con los requerimientos. El detalle del mensaje indica el campo afectado.                                                      |
| **SSL\_OFF**                            | Ocurre cuando la transacción requiere conexión segura SSL y el link invocado no la tiene activada.                                                                                                |
| **INVALID\_MERCHANTID**                 | Indica que el MerchantID/StoreID no es válido.                                                                                                                                                    |
| **DISABLED\_MERCHANTID**                | Indica que el MerchantID/StoreID es correcto, pero no está habilitado para transacciones.                                                                                                         |
| **INVALID\_AUTH:**<br>**AuthHash**      | Este mensaje ocurre cuando el hash enviado en el mensaje no coincide con el generado por el sistema AZUL. Debe revisar que los campos estén concatenados correctamente y el hash SHA512 correcto. |
| **INVALID\_BASEDOMAIN:ApprovedUrl**     | Indica que la URL provista no es correcta. Esto puede ser porque no tiene SSL activo, o está mal formada o pertenece a un dominio/subdominio diferente al que está asignado al MerchantID.        |
| **INVALID\_BASEDOMAIN:DeclinedUrl**     | Indica que la URL provista no es correcta. Esto puede ser porque no tiene SSL activo, o está mal formada o pertenece a un dominio/subdominio diferente al que está asignado al MerchantID.        |
| **INVALID\_BASEDOMAIN:CancelUrl**       | Indica que la URL provista no es correcta. Esto puede ser porque no tiene SSL activo, o está mal formada o pertenece a un dominio/subdominio diferente al que está asignado al MerchantID.        |
| **PROCESSING\_ERROR**                   | Error general procesando la transacción.                                                                                                                                                          |

## Rastreo y Reporte de inconvenientes

Al momento de presentar un inconveniente con el servicio, por favor comunícate a nuestra unidad de Soluciones Integradas en el 809-544-3760, o también vía correo a la dirección <solucionesintegradas@AZUL.com.do>.

Procurar tener los siguientes elementos:

- Numero de comercio
- Fecha / hora de inconveniente
- Logs o trace del error que presenta
- Logs o trace del requerimiento que haces desde tu sistema al nuestro
- Interpretación de lo ocurrido en tu sistema con la respuesta recibida.

Para poder lograr tener estos datos y para análisis interno de cada comercio sobre comportamiento y otros temas de interés, sugerimos que su sistema sea capaz de contar con los mensajes de entrada y salida, tiempos de respuesta.

Tomar en cuenta que no se deben guardar datos de tarjetas en los sistemas, traces o logs.

# Webservices

## Resumen

Webservices AZUL permiten procesar transacciones con tarjetas VISA, MasterCard, American Express, Discover y Diners. La implementación de estos webservices es totalmente independiente de la plataforma tecnológica que tu empresa haya utilizado en sus sistemas. El comercio afiliado puede desarrollar una aplicación en cualquier lenguaje de programación que soporte integración con webservices (ASP, .NET, PHP, Java, etc.). Es decir, que sin importar el tipo de servidores donde corra la aplicación de tu empresa o el lenguaje de programación o las tecnologías que se utilizaron para desarrollar, los sistemas pueden ser integrados a la plataforma de pagos de AZUL a través del consumo de los Webservices AZUL.

Los Webservices AZUL están publicados en formato JSON, HTTPS Post Form y SOAP para la integración de tus aplicaciones con nuestra plataforma de pagos. La elección del formato a implementar depende del afiliado.

| Ambiente            |      | URL                                                                                                                        |
| ------------------- | ---- | -------------------------------------------------------------------------------------------------------------------------- |
| Producción          |
|                     | SOAP | [https://pagos.azul.com.do/webservices/SOAP/Default.asmx](https://pagos.azul.com.do/webservices/SOAP/Default.asmx)         |
|                     | JSON | [https://pagos.azul.com.do/webservices/JSON/Default.aspx](https://pagos.azul.com.do/webservices/JSON/Default.aspx)         |
|                     | HTTP | [https://pagos.azul.com.do/webservices/HTTP/Default.aspx](https://pagos.azul.com.do/webservices/HTTP/Default.aspx)         |
| Sitio alterno       |
|                     | SOAP | [https://pagos.azul.com.do/webservices/HTTP/Default.aspx](https://pagos.azul.com.do/webservices/HTTP/Default.aspx)         |
|                     | JSON | [https://contpagos.azul.com.do/Webservices/JSON/default.aspx](https://contpagos.azul.com.do/Webservices/JSON/default.aspx) |
|                     | HTTP | [https://contpagos.azul.com.do/Webservices/HTTP/default.aspx](https://contpagos.azul.com.do/Webservices/HTTP/default.aspx) |
| Ambiente de pruebas |
|                     | SOAP | [https://pruebas.azul.com.do/webservices/SOAP/Default.asmx](https://pruebas.azul.com.do/webservices/SOAP/Default.asmx)     |
|                     | JSON | [https://pruebas.azul.com.do/webservices/JSON/Default.aspx](https://pruebas.azul.com.do/webservices/JSON/Default.aspx)     |
|                     | HTTP | [https://pruebas.azul.com.do/webservices/HTTP/Default.aspx](https://pruebas.azul.com.do/webservices/HTTP/Default.aspx)     |

El desarrollo debe estar preparado para intentar por la URL del sitio alterno en caso de fallo de la URL principal.

En la integración con Webservices AZUL, la captura de datos para realizar la transacción se realiza en el sitio web o sistema del comercio.

Para brindar la seguridad necesaria en la captura y envío de los datos hacia AZUL, el comercio deberá tener un tipo de autentificación para el formulario de tarjetas e implementar la conexión TLS 1.2.

Antes de empezar el proceso de integración/implementación, se debe establecer una comunicación segura y confiable entre el site del afiliado y el site de la plataforma de pagos de AZUL; para lo cual debe de elegirse entre:

- VPN Site-to-Site
- Autenticación Mutual con Certificados Digitales emitidos localmente por AZUL

Esta configuración debe realizarse tanto para el ambiente de pruebas como para el ambiente de producción; es un requisito para AZUL proveerles los factores de autenticación indicados en la sección Autenticación Webservice.

## Conexión VPN Site-to-Site

Una conexión VPN Site-to-Site permite conectar de manera segura dos redes LAN, a través de internet; permitiendo que la información viaje por un “túnel” seguro (cifrado) para prevenir intercepción de las transacciones.

Para establecer este tipo de conexión debe realizarse configuración en ambos puntos que se desean conectar.

## Requerimientos

- El cliente debe contar con un equipo que tenga conexión a Internet y pueda ser configurado para el uso de túneles IPSec (Router, Firewall, etc.).
- El Pre-share Key será comunicado vía telefónica al cliente.
- El cliente debe completar el siguiente formulario con su información y enviarlo a AZUL.:

| Información de Contacto | Cliente | AZUL |
| ----------------------- | ------- | ---- |
| Nombre                  |         |      |
| Dirección de Correo     |         |      |
| Teléfono                |         |      |
| Celular                 |         |      |
| Nombre                  |         |      |
| Dirección de Correo     |         |      |
| Teléfono                |         |      |
| Celular                 |         |      |

## Información de los Sites

| Información Peer                        | Cliente | AZUL            |
| --------------------------------------- | ------- | --------------- |
| Dirección IP Site Producción            |         | 191.97.90.4     |
| Dirección IP Host Producción - Puerto   |         |                 |
| Dirección IP Site Contingencia          |         | 201.221.126.193 |
| Dirección IP Host Contingencia - Puerto |         |                 |

## Propiedades del Túnel

| Propiedades del Tunel         | Dispositivo Cliente | Dispositivo AZUL   |
| ----------------------------- | ------------------- | ------------------ |
| Método de Autenticación       |                     | Pre Share Key      |
| Esquema de encriptación       |                     | IKE                |
| Grupo Diffie-Hellman          |                     | Group2             |
| Algoritmo de Encriptación     |                     | 3DES               |
| Algoritmo de Hashing          |                     | SHA1               |
| Lifetime (Para renegociación) |                     | 86400 seconds      |
|                               |                     |                    |
| Encapsulación                 |                     | ESP                |
| Algoritmo de Encriptación     |                     | 3DES               |
| Algoritmo de Autenticación    |                     | SHA1               |
| Perfect Forward Secrecy       |                     | DESHABILITADO      |
| Lifetime (Para renegociación) |                     | 3600 Seg. (1 HORA) |

## Autenticación mutua con Certificados Digitales

Mutual Authentication (Autenticación mutua con Certificados Digitales. Para la implementación de una comunicación segura con autenticación mutua, el afiliado ha de presentar un Client Certificate emitido por AZUL (no tiene costo). Las especificaciones con las cuales debe ser remitido el archivo CSR correspondiente son las siguientes:

| Ambiente               | UR                                                  |
| ---------------------- | --------------------------------------------------- |
| Producción             |
| Common Name            | Nombrecomercio.local (Ejemplo: tiendaenlinea.local) |
| Organization Name      | Servicios Digitales Popular                         |
| Organization Unit Name | Produccion                                          |
| Country Name           | DO                                                  |
| State or Province      | Santo Domingo                                       |
| Locality Name          | Distrito Nacional                                   |
| Level Encryption       | 4096 bits                                           |
| Ambiente de pruebas    |
| Common Name            | Nombrecomercio.local (Ejemplo: tiendaenlinea.local) |
| Organization Name      | Servicios Digitales Popular                         |
| Organization Unit Name | Produccion                                          |
| Country Name           | DO                                                  |
| State or Province      | Santo Domingo                                       |
| Locality Name          | Distrito Nacional                                   |
| Level Encryption       | 4096 bits                                           |

- Debes indicar la URL de tu negocio (según el ambiente que se trate)
- Los archivos CSR deben llegar con estas informaciones, los valores son fijos sin importar el país o provincia en que se encuentren.

Notas importantes

- Los datos de pruebas y de producción nunca van a ser similares
- Los factores de autenticación de prueba y producción nunca van a ser los mismos.
- Las url de pruebas y las de producción no son las mismas

## Cómo Invocar el Web service

El consumo del servicio es igual a cualquier request POST. A continuación puedes ver un ejemplo básico en C#. Ten en cuenta que debes incluir los headers ContentType apropiados según el canal y aplicar manejo de errores al request:

Para el servicio SOAP puedes consultar el WSDL directamente para formar el componente de acceso o si lo deseas puedes tomar el mensaje de requerimiento directamente de la sección Ejemplos de este documento y construir el requerimiento manualmente.

Debes aplicar el ContentType de la llamada según el tipo que vayas a utilizar:

- SOAP: “text/xml”
- JSON: “application/json”
- HTTP Forms: “application/x-www-form-urlencoded”

## Autenticación Webservices

Los 3 tipos de servicios requieren ser provistos de dos valores de autenticación, los cuales serán entregados por AZUL durante el proceso de afiliación al servicio. El funcionamiento es similar al de un usuario/password.

Existen dos formas en que puedes enviar estos dos parámetros, dependiendo del tipo de servicio que estés utilizando y tu preferencia.

## HTTP Headers

Este método es el único disponible para JSON y HTTP Forms (también está disponible para SOAP). En este formato, los campos son enviados en el header del POST HTTP. Para esto debes incluir dos headers, uno llamado Auth1 y otro llamado Auth2:

## SOAP Headers

Para el consumo vía SOAP puedes optar por no enviar los headers HTTP, sino utilizar el SOAPAuthHeader en el cuerpo del mensaje. Si utilizas una herramienta WSDL para generar la llamada al web service, o un proxy/cliente para consumirlo, es muy probable que estos ya estén adicionados a su mensaje/componente. En todo caso, el servicio SOAP es capaz de detectar la presencia de los valores de autenticación en el header HTTP o en el header SOAP de manera automática y efectuar la autenticación:

Los factores de autenticación para el ambiente de pruebas son diferentes a los que se les proveerá en el ambiente de producción.

## Método ProcessPayment

Es el método principal, el cual permite enviar las transacciones tanto de venta y preautorizacion (hold) como de devolución y recibir la respuesta de la plataforma de pagos de AZUL. Este es el método por defecto.

Es conveniente configurar adecuadamente el timeout de respuesta en tu aplicación para dar tiempo suficiente a que se realice la validación de los datos y se gestione la aprobación con el emisor al realizar una solitud de pago. En ocasiones esta solicitud puede demorarse más de lo normal por lo que se recomienda configurar un tiempo máximo de 120 segundos.

El procesamiento de transacciones en AZUL tiene un esquema donde cada venta / devolución realizada se captura inmediatamente para ser liquidada con las transacciones del día, razón por la cual no es requerido realizar un cierre.

Los tipos de transacción que se pueden realizar con este método son:

- Sale (Venta)
- Hold (Pre-autorización)
- Refund (Devolución)

## SALE: Transacción de venta

Esta es la transacción principal utilizada para someter una autorización de una tarjeta por la venta de un bien o servicio. Las ventas realizadas con la transacción “Sale” son capturadas automáticamente para su liquidación, por lo que sólo pueden ser anuladas con una transacción de “Void” en un lapso de no más de 20 minutos luego de recibir respuesta de aprobación (ver Método ProcessVoid). Luego de transcurridos estos 20 minutos, la transacción será liquidada y se debe realizar una transacción de “Refund” o devolución para devolver los fondos a la tarjeta.

| Parámetro            | Tipo Dato | Descripción Observación                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Obligatorio |
| -------------------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------- |
| Channel              | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                               | Si          |
| Store                | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Si          |
| CardNumber           | N(19)     | Número de tarjeta a la cual se le ha de cargar la transacción. La longitud del campo se determina por la tarjeta, no se debe rellenar con ceros (0), espacios, ni caracteres especiales                                                                                                                                                                                                                                                                                                                                                        | Si          |
| Expiration           | N(6)      | Fecha expiración/vencimiento de la tarjeta Formato YYYYMM Ej.: 201502                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Si          |
| CVC                  | N(3)      | Código de seguridad de la tarjeta (CVV2 o CVC).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Si          |
| PosInputMode         | A(10)     | Modo de ingreso.Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                              | Si          |
| TrxType              | A(16)     | Valor Fijo: Sale (Este valor es case sensitive)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Si          |
| Amount               | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21                                                                                                                                                                                                                                                                                                                                                 | Si          |
| ITBIS                | N(12)     | Valor del ITBIS. Mismo formato que el campo Amount. El valor enviado en el campo de ITBIS no se carga como un monto adicional en la transacción. En el campo de Amount debe enviarse total a cargar incluyendo el ITBIS.<br>Si la transacción o el negocio están exentos, se envía en cero colocando el valo “000”.<br>Este valor deberá también ser incluido en el cálculo del hash.                                                                                                                                                          | Si          |
| OrderNumber          | X(15)     | Número de orden asociado a la transacción. Puede viajar nulo, pero siempre debe de estar presente.                                                                                                                                                                                                                                                                                                                                                                                                                                             | Si          |
| AcquirerRefData      | N(1)      | Uso Interno AZUL Valor Fijo: 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | No          |
| CustomerServicePhone | X(32)     | Número de servicio para atención telefónica del establecimiento. Ej.: 8095442985                                                                                                                                                                                                                                                                                                                                                                                                                                                               | No          |
| ECommerceURL         | X(32)     | Dirección web del afiliado                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | No          |
| CustomOrderId        | X(75)     | Numero Identificador dada por el afiliado a la transacción. Este campo debe ser enviado si se desea implementar el método de VerifyPayment.                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| AltMerchantName      | X(30)     | Campo que permite al Comercio colocar un nombre más descriptivo para que el tarjetahabiente pueda identificarle en su estado de cuenta. Se sugiere siempre colocar su nombre comercial adecuadamente a fin de evitar disputas. Si lo desea, puede agregar a su nombre algún indicador único de orden. El campo solo acepta un máximo de 25 caracteres. No utilizar los siguientes caracteres especiales: <br>“ Genera un error en el request. <br>\ Genera un error en el request. <br>' Este carácter no se muestra en el mensaje del emisor. | No          |
| DataVaultToken       | A(100)    | Valor del token generado por SDP en caso de que se desee realizar una transacción con dicho token. Si se manda el valor de esto, no se deben enviar los valores de CardNumber, Expiration. El envío de CVC si es ecommerce puede ser o no mandatorio depende de lo conversado con Negocios SDP. Si es MOTO la transacción, no se debería enviar CVC.                                                                                                                                                                                           | No          |
| SaveToDataVault      | N(1)      | Valores posibles 1 = si, 2 = no. Si se manda este valor en 1, SDP le devolverá el token generado en el campo DataVaultToken                                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| SaveToDataVault      | N(1)      | Valores posibles 1 = si, 2 = no. Si se manda este valor en 1, SDP le devolverá el token generado en el campo DataVaultToken                                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| ForceNo3DS           | N(1)      | Valores posibles 0 =no, 1 = Si. Si se envía el valor en ‘0’, la transacción se procesa con 3D Secure. Si se envía el valor en ‘1’ la transacción se procesa sin 3D Secure.                                                                                                                                                                                                                                                                                                                                                                     | No          |

| Valores de Retorno |
| ------------------ |
| Parámetro          | Tipo Dato | Descripción                                                                                                                                                                                                                  |
| ---                | ---       | ---                                                                                                                                                                                                                          |
| AuthorizationCode  | X(10)     | Código de autorización generado por el centro autorizador para la transacción. Sólo presente si la transacción fue aprobada. ISOCode = ISO8583 y ResponseCode = 00                                                           |
| CustomOrderId      | X(75)     | Numero Identificador dada por el afiliado a la transacción. Si no fue provisto en la transacción, este campo viaja en blanco                                                                                                 |
| DateTime           | N(14)     | Fecha y hora de la transacción. Formato YYYYMMDDHHMMSS.                                                                                                                                                                      |
| ErrorDescription   | X(999)    | Descripción del error. Valor sólo presente si la transacción produjo un error. En caso de no presentar error ese campo viaja en blanco                                                                                       |
| ISOCode            | N(2)      | Código ISO-8583 recibido de respuesta.                                                                                                                                                                                       |
| LotNumber          | N(4)      | Número de lote en que se registró la transacción                                                                                                                                                                             |
| RRN                | N(20)     | Número de referencia (Reference referral number).                                                                                                                                                                            |
| AzulOrderId        | N(8)      | \# de orden AZUL. Puede ser usado en vez del RRN para generar una devolución. Importante dar prioridad a este valor sobre el RRN.                                                                                            |
| ResponseCode       | X(7)      | Código de respuesta. Puede contener uno de los siguientes valores: Iso8583 = la transacción fue procesada. Se debe revisar el campo ISOCode para ver la respuesta de la transacción Error = La transacción no fue procesada. |
| ReponseMessage     | X(999)    | Mensaje de respuesta ISO-8583. Valor sólo presente si el ResponseCode = ISO8583                                                                                                                                              |
| Ticket             | N(4)      | Número del ticket correspondiente a la transacción                                                                                                                                                                           |
| CardNumber         | X(19)     | Tarjeta usada para la transacción, enmascarada (XXXXXX\*\*\*\*\*\*XXXX)                                                                                                                                                      |

## Declaración e importación

Para realizar la integración es necesario establecer los valores por defecto; en el próximo ejemplo se visualiza un ejemplo en cada lenguaje de como se realiza dicha declaración, así como también, las librerías que pudieran ocupar para realizar el mismo:

- < >

```
  // Importar librerías
 const  fs  = require(  'fs'  );
 const  https  = require(  'https'  );

  // Declarar variables
 const  Auth1  =  "AZUL" ;
 const  Auth2  = " AZUL ";
 const  MainUrl  =  "pruebas" ;
 const  PathCert  =  " cert.pem" ;
 const  PathKey  =  " Key.pem" ;
 const  TimeOut  =  "40000" ;
 const  Store  =  "3900000000" ;
 const  Channel  =  "EC" ;
 const  LogsPath  =  "\Logs\" ;

  // Parametros para manejar redirección y las credenciales
 const  getOptions  = ( path ) => {
     let  options  = {
         hostname: MainUrl + ' . azul. com.do',
         port: 443,
         path: path,
         method:  'POST' ,
         timeout: parseInt( TimeOut ),
         headers: { 'Content-Type':'application/json' , "Auth1" : Auth1, "Auth2" : Auth2},
         json: true,
         key: fs.readFileSync( PathKey ),
         cert: fs.readFileSync( PathCert )
     }

     return options;
 }
```

Copy

## Invocar al WebServices

La integración con nuestros webservices es requerido un llamado asíncrono, debido a que la respuesta es recibida en el mismo llamado al API.

A continuación, se muestra un ejemplo en las siguientes librerías de como se puede realizar el llamado, este mismo extracto de código se estará llamando, refiriendo más adelante para indicar las diferentes propiedades que recibe:

- < >

```
 const sendTrx= (  jsonData, method, path  ) => {
     return new Promise ( (  resp, reject  ) => {
         let  req  = https.request(getOptions(path), ( res ) => {
 res.on( 'data' , ( data ) => {
                 let  response  = JSON.parse( data )
                     resp( response )
                     logManager(  response, method,  'MainUrl' , jsonData.OrderNumber, jsonData.CustomOrderId, false  );

 req.end(  );
             });
         });
 req.on( 'error' , ( e ) => {
             logManager(  e, method,  'MainUrl' , jsonData.OrderNumber, jsonData.CustomOrderId, true  );
             reject( e );
         });
 req.write( JSON.stringify( jsonData ));
 req.end(  );
     });
 }

  // Generar archivo de log
 const  logManager  = (  resp, method, url, OrderNumber, CustomOrderId, error  ) => {
     if(  resp.ResponseCode !=  "Error"  && !error ){
 fs.appendFile(
             `${LogsPath}\ ${ method } ${ date.getDate()} .txt`,` ${ url } | ${new Date()} | ${ JSON.stringify( resp ) }
 `,(error) => { console.log( 'Error: '+ error ) }
             );
     }else if ( !error ) {
 fs.appendFile(
             ` ${LogsPath}\ ${ method }Validation ${ date.getDate()} .txt`,` ${ JSON.stringify( resp ) }
 `,(error) => { console.log( 'Error: '+ error ) }
             );
     }
 }
```

Copy

## Realizar venta

Para realizar una venta se realiza la siguiente sentencia utilizando los métodos antes mostrados:

- < >

```
 const  sale  = {
      "Channel"  : Channel,
      "Store"  : Store,
      "CardNumber"  :  "4260000000000000" ,
      "Expiration" :  "202612" ,
      "CVC" :  "123" ,
      "PosInputMode" :  "E-Commerce" ,
      "Amount" :  "100" ,
      "Itbis" :  "10" ,
      "CurrencyPosCode" :  "$" ,
      "Payments" : 1,
      "Plan" : 0,
      "AcquirerRefData" : 1,
      "OrderNumber" :  "123456" ,
      "CustomOrderId" :  "1231jrg" ,
      "ForceNo3DS" : 1
 }

  // Realizar la petición de venta
 sendTrx(  sale,  'Sale' , '/webservices/JSON/ Default.aspx' )
 .then(( vale, err ) => {
 console.log( vale, err )
 })
 .catch(( err ) => {
 console.log( err )
 })
```

Copy

## HOLD: Transacción para retención o reserva de fondos en la tarjeta

Se puede separar la autorización del posteo o captura en dos mensajes distintos:

- Hold: pre-autorización y reserva de los fondos en la tarjeta del cliente.
- Post: se hace la captura o el “posteo” de la transacción. (Ver metódo ProcessPost).

Al utilizar el Hold y Post se deben considerar los siguientes puntos:

- Para evitar que el banco emisor elimine la pre-autorización, el Post debe ser realizado antes de 7 días de haber hecho el Hold.
- Luego de realizado el Hold, el comercio no va a recibir la liquidación de los fondos hasta que someta el Post.
- El Post solamente se puede hacer una vez por cada Hold realizado.
- El Post puede ser igual, menor o mayor al monto original. El posteo por un monto mayor no debe sobrepasar el 15% del monto original.
- El Void libera o cancela los fondos retenidos (preautorización o Hold)

| Parámetros de Entrada |
| --------------------- |
| Parámetro             | Tipo Dato | Descripción Observación                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Obligatorio |
| ---                   | ---       | ---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | ---         |
| Channel               | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                                  | si          |
| Store                 | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | si          |
| CardNumber            | N(19)     | Número de tarjeta a la cual se le ha de cargar la transacción. La longitud del campo se determina por la tarjeta, no se debe rellenar con ceros (0), espacios, ni caracteres especiales                                                                                                                                                                                                                                                                                                                                                           | si          |
| Expiration            | N(6)      | Fecha expiración/vencimiento de la tarjeta Formato YYYYMM Ej.: 201502                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | si          |
| CVC                   | N(3)      | Código de seguridad de la tarjeta (CVV2 o CVC).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | si          |
| PosInputMode          | A(10)     | Modo de ingreso. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                                | si          |
| TrxType               | A(16)     | Valor Fijo: Hold (Este valor es case sensitive)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | si          |
| Amount                | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21                                                                                                                                                                                                                                                                                                                                                    | si          |
| ITBIS                 | N(12)     | Valor del ITBIS. Mismo formato que el campo Amount. El valor enviado en el campo de ITBIS no se carga como un monto adicional en la transacción. En el campo de Amount debe enviarse total a cargar incluyendo el ITBIS.<br>Si la transacción o el negocio están exentos, se envía en cero colocando el valor “000”.<br>Este valor deberá también ser incluido en el cálculo del hash.                                                                                                                                                            | si          |
| OrderNumber           | N(15)     | Número de orden asociado a la transacción. Puede viajar nulo, pero siempre debe de estar presente.                                                                                                                                                                                                                                                                                                                                                                                                                                                | si          |
| AcquirerRefData       | N(1)      | Uso Interno AZUL Valor Fijo: 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | si          |
| CustomerServicePhone  | X(32)     | Número de servicio para atención telefónica del establecimiento. Ej.: 8095442985                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | No          |
| ECommerceURL          | X(32)     | Dirección web del afiliado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | No          |
| CustomOrderId         | X(75)     | Numero Identificador dada por el afiliado a la transacción. Este campo debe ser enviado si se desea implementar el método de VerifyPayment.                                                                                                                                                                                                                                                                                                                                                                                                       | No          |
| AltMerchantName       | X(30)     | Campo que permite al Comercio colocar un nombre más descriptivo para que el tarjetahabiente pueda identificarle en su estado de cuenta. Se sugiere siempre colocar su nombre comercial adecuadamente a fin de evitar disputas. Si lo desea, puede agregar a su nombre algún indicador único de orden <br>El campo solo acepta un máximo de 25 caracteres.<br>No utilizar los siguientes caracteres especiales:<br>“ Genera un error en el request.<br>\ Genera un error en el request.<br>' Este carácter no se muestra en el mensaje del emisor. | No          |
| DataVaultToken        | A(100)    | Valor del token generado por SDP en caso de que se desee realizar una transacción con dicho token. Si se manda el valor de esto, no se deben enviar los valores de CardNumber, Expiration. El envío de CVC si es ecommerce puede ser o no mandatorio depende de lo conversado con Negocios SDP. Si es MOTO la transacción, no se debería enviar CVC.                                                                                                                                                                                              | No          |
| SaveToDataVault       | N(1)      | Valores posibles 1 = si, 2 = no. Si se manda este valor en 1, SDP le devolverá el token generado en el campo DataVaultToken                                                                                                                                                                                                                                                                                                                                                                                                                       | No          |
| ForceNo3DS            | N(1)      | Valores posibles 0 =no, 1 = Si. Si se envía el valor en ‘0’, la transacción se procesa con 3D Secure. Si se envía el valor en ‘1’ la transacción se procesa sin 3D Secure.                                                                                                                                                                                                                                                                                                                                                                        | No          |

| Valores de Retorno |
| ------------------ |
| Parámetro          | Tipo Dato | Descripción                                                                                                                                                                                                                  |
| ---                | ---       | ---                                                                                                                                                                                                                          |
| AuthorizationCode  | X(10)     | Código de autorización generado por el centro autorizador para la transacción. Sólo presente si la transacción fue aprobada. ISOCode = ISO8583 y ResponseCode = 00                                                           |
| AzulOrderId        | N(8)      | \# de orden AZUL. Puede ser usado en vez del RRN para generar una devolución. Importante dar prioridad a este valor sobre el RRN.                                                                                            |
| CustomOrderId      | X(75)     | Numero Identificador dada por el afiliado a la transacción. Si no fue provisto en la transacción, este campo viaja en blanco                                                                                                 |
| DateTime           | N(14)     | Fecha y hora de la transacción. Formato YYYYMMDDHHMMSS.                                                                                                                                                                      |
| ErrorDescription   | X(999)    | Descripción del error. Valor sólo presente si la transacción produjo un error. En caso de no presentar error ese campo viaja en blanco                                                                                       |
| ISOCode            | N(2)      | Código ISO-8583 recibido de respuesta.                                                                                                                                                                                       |
| LotNumber          | N(4)      | Número de lote en que se registró la transacción                                                                                                                                                                             |
| RRN                | N(20)     | Número de referencia (Reference referral number).                                                                                                                                                                            |
| ResponseCode       | X(7)      | Código de respuesta. Puede contener uno de los siguientes valores: Iso8583 = la transacción fue procesada. Se debe revisar el campo ISOCode para ver la respuesta de la transacción Error = La transacción no fue procesada. |
| ReponseMessage     | X(999)    | Mensaje de respuesta ISO-8583. Valor sólo presente si el ResponseCode = ISO8583                                                                                                                                              |
| Ticket             | N(4)      | Número del ticket correspondiente a la transacción                                                                                                                                                                           |

## REFUND: Transacción Devolución

La devolución o “Refund” permite reembolsarle los fondos a una tarjeta luego de haberse liquidado la transacción.

Para poder realizar una devolución se debe haber procesado exitosamente una transacción de Venta o Post, y se deben utilizar los datos de la transacción original para enviar la devolución. El monto a devolver puede ser el mismo o menor y solamente se permite hacer una devolución para cada transacción.

El límite de tiempo para procesar una devolución es de 6 meses transcurridos después de la transacción original.

| Parámetros de Entrada |
| --------------------- |
| Parámetro             | Tipo Dato | Descripción Observación                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Obligatorio |
| ---                   | ---       | ---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | ---         |
| Channel               | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                                  | si          |
| Store                 | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | si          |
| CardNumber            | N(19)     | Número de tarjeta a la cual se le ha de cargar la transacción. La longitud del campo se determina por la tarjeta, no se debe rellenar con ceros (0), espacios, ni caracteres especiales                                                                                                                                                                                                                                                                                                                                                           | si          |
| Expiration            | N(6)      | Fecha expiración/vencimiento de la tarjeta Formato YYYYMM Ej.: 201502                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | si          |
| CVC                   | N(3)      | Código de seguridad de la tarjeta (CVV2 o CVC).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | si          |
| PosInputMode          | A(10)     | Modo de ingreso. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                                | si          |
| TrxType               | A(16)     | Valor Fijo: Hold (Este valor es case sensitive)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | si          |
| Amount                | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21                                                                                                                                                                                                                                                                                                                                                    | si          |
| ITBIS                 | N(12)     | Valor del ITBIS. Mismo formato que el campo Amount. El valor enviado en el campo de ITBIS no se carga como un monto adicional en la transacción. En el campo de Amount debe enviarse total a cargar incluyendo el ITBIS.<br>Si la transacción o el negocio están exentos, se envía en cero colocando el valor “000”.<br>Este valor deberá también ser incluido en el cálculo del hash.                                                                                                                                                            | si          |
| OrderNumber           | N(15)     | Número de orden asociado a la transacción. Puede viajar nulo, pero siempre debe de estar presente.                                                                                                                                                                                                                                                                                                                                                                                                                                                | si          |
| AcquirerRefData       | N(1)      | Uso Interno AZUL Valor Fijo: 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | si          |
| CustomerServicePhone  | X(32)     | Número de servicio para atención telefónica del establecimiento. Ej.: 8095442985                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | No          |
| ECommerceURL          | X(32)     | Dirección web del afiliado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | No          |
| CustomOrderId         | X(75)     | Numero Identificador dada por el afiliado a la transacción. Este campo debe ser enviado si se desea implementar el método de VerifyPayment.                                                                                                                                                                                                                                                                                                                                                                                                       | No          |
| AltMerchantName       | X(30)     | Campo que permite al Comercio colocar un nombre más descriptivo para que el tarjetahabiente pueda identificarle en su estado de cuenta. Se sugiere siempre colocar su nombre comercial adecuadamente a fin de evitar disputas. Si lo desea, puede agregar a su nombre algún indicador único de orden <br>El campo solo acepta un máximo de 25 caracteres.<br>No utilizar los siguientes caracteres especiales:<br>“ Genera un error en el request.<br>\ Genera un error en el request.<br>' Este carácter no se muestra en el mensaje del emisor. | No          |
| DataVaultToken        | A(100)    | Valor del token generado por SDP en caso de que se desee realizar una transacción con dicho token. Si se manda el valor de esto, no se deben enviar los valores de CardNumber, Expiration. El envío de CVC si es ecommerce puede ser o no mandatorio depende de lo conversado con Negocios SDP. Si es MOTO la transacción, no se debería enviar CVC.                                                                                                                                                                                              | No          |
| SaveToDataVault       | N(1)      | Valores posibles 1 = si, 2 = no. Si se manda este valor en 1, SDP le devolverá el token generado en el campo DataVaultToken                                                                                                                                                                                                                                                                                                                                                                                                                       | No          |
| ForceNo3DS            | N(1)      | Valores posibles 0 =no, 1 = Si. Si se envía el valor en ‘0’, la transacción se procesa con 3D Secure. Si se envía el valor en ‘1’ la transacción se procesa sin 3D Secure.                                                                                                                                                                                                                                                                                                                                                                        | No          |

| Valores de Retorno |
| ------------------ |
| Parámetro          | Tipo Dato | Descripción                                                                                                                                                                                                                  |
| ---                | ---       | ---                                                                                                                                                                                                                          |
| AuthorizationCode  | X(10)     | Código de autorización generado por el centro autorizador para la transacción. Sólo presente si la transacción fue aprobada. ISOCode = ISO8583 y ResponseCode = 00                                                           |
| AzulOrderId        | N(8)      | \# de orden AZUL. Puede ser usado en vez del RRN para generar una devolución. Importante dar prioridad a este valor sobre el RRN.                                                                                            |
| CustomOrderId      | X(75)     | Numero Identificador dada por el afiliado a la transacción. Si no fue provisto en la transacción, este campo viaja en blanco                                                                                                 |
| DateTime           | N(14)     | Fecha y hora de la transacción. Formato YYYYMMDDHHMMSS.                                                                                                                                                                      |
| ErrorDescription   | X(999)    | Descripción del error. Valor sólo presente si la transacción produjo un error. En caso de no presentar error ese campo viaja en blanco                                                                                       |
| ISOCode            | N(2)      | Código ISO-8583 recibido de respuesta.                                                                                                                                                                                       |
| LotNumber          | N(4)      | Número de lote en que se registró la transacción                                                                                                                                                                             |
| RRN                | N(20)     | Número de referencia (Reference referral number).                                                                                                                                                                            |
| ResponseCode       | X(7)      | Código de respuesta. Puede contener uno de los siguientes valores: Iso8583 = la transacción fue procesada. Se debe revisar el campo ISOCode para ver la respuesta de la transacción Error = La transacción no fue procesada. |
| ReponseMessage     | X(999)    | Mensaje de respuesta ISO-8583. Valor sólo presente si el ResponseCode = ISO8583                                                                                                                                              |
| Ticket             | N(4)      | Número del ticket correspondiente a la transacción                                                                                                                                                                           |

## Ejemplos mensaje de Requerimiento

SOAP

Endpoints o URLs

Desarollo

- [https://pruebas.azul.com.do/WebServices/SOAP/Default.asmx](https://pruebas.azul.com.do/WebServices/SOAP/Default.asmx)

Producción

- [https://pagos.azul.com.do/WebServices/SOAP/Default.asmx](https://pagos.azul.com.do/WebServices/SOAP/Default.asmx)
- [https://contpagos.azul.com.do/WebServices/SOAP/Default.asmx](https://contpagos.azul.com.do/WebServices/SOAP/Default.asmx)

## JSON

Endpoint o URL:

Desarrollo

- [https://pruebas.azul.com.do/WebServices/JSON/Default.aspx](https://pruebas.azul.com.do/WebServices/JSON/Default.aspx)

Producción

- [https://pagos.azul.com.do/WebServices/JSON/Default.aspx](https://pagos.azul.com.do/WebServices/JSON/Default.aspx)
- [https://contpagos.azul.com.do/WebServices/JSON/Default.aspx](https://contpagos.azul.com.do/WebServices/JSON/Default.aspx)

## HTTP Forms Post

Endpoint o URL

Desarrollo

- [https://pruebas.azul.com.do/WebServices/HTTP/Default.aspx](https://pruebas.azul.com.do/WebServices/HTTP/Default.aspx)

Producción

- [https://pagos.azul.com.do/WebServices/HTTP/Default.aspx](https://pagos.azul.com.do/WebServices/HTTP/Default.aspx)
- [https://contpagos.azul.com.do/WebServices/HTTP/Default.aspx](https://contpagos.azul.com.do/WebServices/HTTP/Default.aspx)

## Ejemplos Mensajes de Respuesta

Mensajería similar a una transacción de venta (Sale).

## Método ProcessPost

## Transacción para hacer captura o posteo del Hold

El método “Post” permite capturar un “Hold” realizado previamente para su liquidación. El monto del “Post” puede ser igual o menor al monto del “Hold”. En caso que el monto del Post sea menor al Hold, se envía un mensaje de reverso para liberar los fondos retenidos a la tarjeta.

| Parámetros de Entrada |
| --------------------- |
| Parámetro             | Tipo Dato | Descripción Observación                                                                                                                                                                                                                                                                                                                       |
| ---                   | ---       | ---                                                                                                                                                                                                                                                                                                                                           |
| Channel               | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                              |
| Store                 | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                                                                                                                                                                |
| AzulOrderId           | N(8)      | \# de orden AZUL. Identificador único de la transacción tipo Hold previa.                                                                                                                                                                                                                                                                     |
| Amount                | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21                                                                                                                                                |
| ITBIS                 | N(12)     | Valor del ITBIS. Mismo formato que el campo Amount. El valor enviado en el campo de ITBIS no se carga como un monto adicional en la transacción. En el campo de Amount debe enviarse total a cargar incluyendo el ITBIS. Si la transacción o el negocio están exentos, se envía en cero o simplemente no se incluye el campo en la solicitud. |

| Valores de Retorno  |
| ------------------- |
| Parámetro           | Tipo Dato | Descripción                                                                                                                                                                                                                  |
| ---                 | ---       | ---                                                                                                                                                                                                                          |
| AuthorizationCode   | X(10)     | Código de autorización generado por el centro autorizador para la transacción. Sólo presente si la transacción fue aprobada. ISOCode = ISO8583 y ResponseCode = 00                                                           |
| AzulOrderId         | N(8)      | \# de orden SDP. Identificador único de la transacción.                                                                                                                                                                      |
| CustomOrderId       | X(15)     | Numero Identificador dada por el afiliado a la transacción. Si no fue provisto en la transacción, este campo viaja en blanco                                                                                                 |
| DateTime            | N(14)     | Fecha y hora de la transacción. Formato YYYYMMDDHHMMSS.                                                                                                                                                                      |
| ErrorDescription    | X(999)    | Descripción del error. Valor sólo presente si la transacción produjo un error. En caso de no presentar error ese campo viaja en blanco                                                                                       |
| ISOCode             | N(2)      | Código ISO-8583 recibido de respuesta.                                                                                                                                                                                       |
| LotNumber           | N(4)      | Número de lote en que se registró la transacción                                                                                                                                                                             |
| RRN                 | N(20)     | Número de referencia (Reference referral number).                                                                                                                                                                            |
| ResponseCode        | X(7)      | Código de respuesta. Puede contener uno de los siguientes valores: Iso8583 = la transacción fue procesada. Se debe revisar el campo ISOCode para ver la respuesta de la transacción Error = La transacción no fue procesada. |
| ReponseMessage      | X(999)    | Mensaje de respuesta ISO-8583. Valor sólo presente si el ResponseCode = ISO8583                                                                                                                                              |
| Ticket              | N(4)      | Número del ticket correspondiente a la transacción                                                                                                                                                                           |
| DataVaultToken      |           | Solo respondidos si se tiene Datavault encendidos                                                                                                                                                                            |
| DataVaultExpiration |           | Solo respondidos si se tiene Datavault encendidos                                                                                                                                                                            |
| DataVaultBrand      |           | Solo respondidos si se tiene Datavault encendidos                                                                                                                                                                            |

## Ejemplos Mensaje de Requerimiento

SOAP

Endpoints o URLs

Desarrollo

- [https://pruebas.azul.com.do/WebServices/SOAP/Default.asmx](https://pruebas.azul.com.do/WebServices/SOAP/Default.asmx)

Producción

- [https://pagos.azul.com.do/WebServices/SOAP/Default.asmx](https://pagos.azul.com.do/WebServices/SOAP/Default.asmx)
- [https://contpagos.azul.com.do/WebServices/SOAP/Default.asmx](https://contpagos.azul.com.do/WebServices/SOAP/Default.asmx)

JSON

Endpoint o URL

Desarrollo

- [https://pruebas.azul.com.do/WebServices/JSON/Default.aspx?ProcessPost](https://pruebas.azul.com.do/WebServices/JSON/Default.aspx?ProcessPost)

Producción

- [https://pagos.azul.com.do/WebServices/JSON/Default.aspx?ProcessPost](https://pagos.azul.com.do/WebServices/JSON/Default.aspx?ProcessPost)
- [https://contpagos.azul.com.do/WebServices/JSON/Default.aspx?ProcessPost](https://contpagos.azul.com.do/WebServices/JSON/Default.aspx?ProcessPost)

HTTP

Endpoint o URL

Desarrollo

- [https://pruebas.azul.com.do/WebServices/HTTP/Default.aspx?ProcessPost](https://pruebas.azul.com.do/WebServices/HTTP/Default.aspx?ProcessPost)

Producción

- [https://pagos.azul.com.do/WebServices/HTTP/Default.aspx?ProcessPost](https://pagos.azul.com.do/WebServices/HTTP/Default.aspx?ProcessPost)
- [https://contpagos.azul.com.do/WebServices/HTTP/Default.aspx?ProcessPost](https://contpagos.azul.com.do/WebServices/HTTP/Default.aspx?ProcessPost)

## Ejemplos Mensajes de Respuesta

SOAP

Aprobación

Declinación

Error

JSON

Aprobación

Declinación

Error

HTTP

Aprobación

Declinación

Error

## Método VerifyPayment

Este método permite verificar la respuesta enviada por el webservice de una transacción anterior (procesada por el método ProccesPayment), identificada por el campo CustomOrderId. Si existe más de una transacción con este identificador este método devolverá los valores de la última transacción (más reciente) de ellas.

| Transacción de venta |
| -------------------- |
| Parámetro            | Tipo Dato | Descripción Observación                                                                                   | Obligatorio |
| ---                  | ---       | ---                                                                                                       | ---         |
| Channel              | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente          | Si          |
| Store                | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                            | Si          |
| CustomOrderId        | X(75)     | Número Identificador dada por el afiliado a la transacción original (la que se desea consultar/verificar) | Si          |

| Valores de Retorno |
| ------------------ |
| Parámetro          | Tipo Dato | Descripción                                                                                                                                                                                                                  |
| ---                | ---       | ---                                                                                                                                                                                                                          |
| Amount             | N(12)     | Monto de la transacción consultada                                                                                                                                                                                           |
| AuthorizationCode  | X(10)     | Código de autorización generado por el centro autorizador para la transacción. Sólo presente si la transacción fue aprobada. ISOCode = ISO8583 y ResponseCode = 00                                                           |
| CardNumber         | X(19)     | Número de tarjeta con la cual se hizo la transacción. Este número se presenta enmascarado con asteriscos, formato XXXXXX\*\*\*\*\*\*XXXX.                                                                                    |
| CurrencyPosCode    | X(1)      | Moneda en que se realizó la transacción                                                                                                                                                                                      |
| CustomOrderId      | X(75)     | Numero Identificador dada por el afiliado a la transacción. Si no fue provisto en la transacción, este campo viaja en blanco                                                                                                 |
| DateTime           | N(14)     | Fecha y hora de la transacción. Formato YYYYMMDDHHMMSS.                                                                                                                                                                      |
| ErrorDescription   | X(999)    | Descripción del error. Valor sólo presente si la transacción produjo un error. En caso de no presentar error ese campo viaja en blanco                                                                                       |
| Found              | B         | Indica si la transacción solicitada fue encontrada o no.                                                                                                                                                                     |
| ISOCode            | N(2)      | Código ISO-8583 recibido de respuesta.                                                                                                                                                                                       |
| ITBIS              | N(12)     | Valor del ITBSI en la transacción.                                                                                                                                                                                           |
| LotNumber          | N(4)      | Número de lote en que se registró la transacción                                                                                                                                                                             |
| RRN                | N(20)     | Número de referencia                                                                                                                                                                                                         |
| ResponseCode       | X(7)      | Código de respuesta. Puede contener uno de los siguientes valores: Iso8583 = la transacción fue procesada. Se debe revisar el campo ISOCode para ver la respuesta de la transacción Error = La transacción no fue procesada. |
| Ticket             | N(4)      | Número del ticket correspondiente a la transacción                                                                                                                                                                           |

## Bóvedad de Datos (Datavault)

## Venta o hold con creación de Token

Es posible crear un Token durante una venta o un hold enviando el campo “SaveToDataVault” con el valor en “1”. El Token será devuelto en el mensaje de respuesta en campo “DataVaultToken” con la fecha de expiración en el campo “DataVaultExpiration”.

| Transacción de venta  |
| --------------------- |
| Parámetros de Entrada |
| ---                   |
| Parámetro             | Tipo Dato | Descripción Observación                                                                                                                                                                                                                                                                                                                                                        | Obligatorio |
| ---                   | ---       | ---                                                                                                                                                                                                                                                                                                                                                                            | ---         |
| Channel               | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                               | Si          |
| Store                 | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                                                                                                                                                                                                 | Si          |
| CardNumber            | N(19)     | Número de tarjeta a la cual se le ha de cargar la transacción. La longitud del campo se determina por la tarjeta, no se debe rellenar con ceros (0), espacios, ni caracteres especiales.                                                                                                                                                                                       | Si          |
| Expiration            | N(6)      | Fecha expiración/vencimiento de la tarjeta Formato YYYYMM Ej.: 201502                                                                                                                                                                                                                                                                                                          | Si          |
| CVC                   | N(3)      | Código de seguridad de la tarjeta (CVV2 o CVC).                                                                                                                                                                                                                                                                                                                                | Si          |
| PosInputMode          | A(10)     | Modo de ingreso. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                             | Si          |
| TrxType               | A(16)     | Valor Fijo: Sale (Este valor es case sensitive)                                                                                                                                                                                                                                                                                                                                | Si          |
| Amount                | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21                                                                                                                                                                                 | Si          |
| ITBIS                 | N(12)     | Valor del ITBIS. Mismo formato que el campo Amount. El valor enviado en el campo de ITBIS no se carga como un monto adicional en la transacción. En el campo de Amount debe enviarse total a cargar incluyendo el ITBIS. Si la transacción o el negocio están exentos, se envía en cero colocando el valo “000”.Este valor deberá también ser incluido en el cálculo del hash. | Si          |
| OrderNumber           | X(15)     | Número de orden asociado a la transacción. Puede viajar nulo, pero siempre debe de estar presente.                                                                                                                                                                                                                                                                             | Si          |
| AcquirerRefDat        | N(1)      | Uso Interno AZUL Valor Fijo: 1                                                                                                                                                                                                                                                                                                                                                 | No          |
| CustomerServicePhone  | X(32)     | Número de servicio para atención telefónica del establecimiento. Ej.: 8095442985                                                                                                                                                                                                                                                                                               | No          |
| ECommerceURL          | X(32)     | Dirección web del afiliado                                                                                                                                                                                                                                                                                                                                                     | No          |
| CustomOrderId         | X(75)     | Número Identificador dada por el afiliado a la transacción original (la que se desea consultar/verificar)                                                                                                                                                                                                                                                                      | No          |
| DataVaultToken        | A(100)    | Valor del token generado por AZUL. Para las transacciones de venta con token, no se deben enviar los valores de CardNumber y Expiration. El envío de CVC si es E-Commerce puede ser o no mandatorio depende de lo acordado con su representante de Negocios de AZUL. Si es MOTO la transacción, no se debería enviar CVC.                                                      | No          |
| SaveToDataVault       | N(1)      | Valores posibles 1 = Si, 0 = No. Si se manda el valor en 1, AZUL devolverá el token generado para la tarjeta en el campo DataVaultToken. Si se manda el valor en 0, AZUL no genera Token.                                                                                                                                                                                      | Si          |

| Valores de Retorno  |
| ------------------- |
| Parámetro           | Tipo Dato | Descripción                                                                                                                                                                                                                  |
| ---                 | ---       | ---                                                                                                                                                                                                                          |
| AuthorizationCode   | X(10)     | Código de autorización generado por el centro autorizador para la transacción. Sólo presente si la transacción fue aprobada. ISOCode = ISO8583 y ResponseCode = 00                                                           |
| AzulOrderId         | N(8)      | \# de orden SDP. Puede ser usado en vez del RNN para generar una devolución. Importante dar prioridad a este valor sobre el RNN.                                                                                             |
| CustomOrderId       | X(75)     | Numero Identificador dada por el afiliado a la transacción. Si no fue provisto en la transacción, este campo viaja en blanco                                                                                                 |
| DataVaultBrand      | X(15)     | Marca de la tarjeta(Ej.: Visa)                                                                                                                                                                                               |
| DataVaultExpiration | X(6)      | Fecha expiración del token generado por AZUL. Formato YYYYMM                                                                                                                                                                 |
| DataVaultToken      | X(35)     | Token generado por AZUL. Eje:.6EF85D01-B07C-4E67-99F74E13A449DCDD                                                                                                                                                            |
| DateTime            | N(14)     | Fecha y hora de la transacción. Formato YYYYMMDDHHMMSS.                                                                                                                                                                      |
| ErrorDescription    | X(999)    | Descripción del error. Valor sólo presente si la transacción produjo un error. En caso de no presentar error ese campo viaja en blanco                                                                                       |
| IsoCode             | N(2)      | Código ISO-8583 recibido de respuesta.                                                                                                                                                                                       |
| LotNumber           | N(4)      | Número de lote en que se registró la transacción                                                                                                                                                                             |
| RRN                 | N(20)     | Número de referencia                                                                                                                                                                                                         |
| ResponseCode        | X(7)      | Código de respuesta. Puede contener uno de los siguientes valores: Iso8583 = la transacción fue procesada. Se debe revisar el campo ISOCode para ver la respuesta de la transacción Error = La transacción no fue procesada. |
| ResponseMessage     | X(999)    | Mensaje de respuesta ISO-8583. Valor sólo presente si el ResponseCode = ISO8583                                                                                                                                              |
| Ticket              | N(4)      | Número del ticket correspondiente a la transacción                                                                                                                                                                           |

## Transacción de Venta utilizando el Token

En esta transacción se realiza una venta, pero en vez de enviar el número de la tarjeta, se envía el token generado anteriormente en sustitución de la misma.

| Transacción de venta  |
| --------------------- |
| Parámetros de Entrada |
| ---                   |
| Parámetro             | Tipo Dato | Descripción Observación                                                                                                                                                                                                                                                                                                                                                        | Obligatorio |
| ---                   | ---       | ---                                                                                                                                                                                                                                                                                                                                                                            | ---         |
| Channel               | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                               | Si          |
| Store                 | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                                                                                                                                                                                                 | Si          |
| CardNumber            | N(19)     | Número de tarjeta a la cual se le ha de cargar la transacción. La longitud del campo se determina por la tarjeta, no se debe rellenar con ceros (0), espacios, ni caracteres especiales.                                                                                                                                                                                       | Si          |
| Expiration            | N(6)      | Fecha expiración/vencimiento de la tarjeta Formato YYYYMM Ej.: 201502                                                                                                                                                                                                                                                                                                          | Si          |
| CVC                   | N(3)      | Código de seguridad de la tarjeta (CVV2 o CVC).                                                                                                                                                                                                                                                                                                                                | No          |
| PosInputMode          | A(10)     | Modo de ingreso. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                             | Si          |
| TrxType               | A(16)     | Valor Fijo: Sale (Este valor es case sensitive)                                                                                                                                                                                                                                                                                                                                | Si          |
| Amount                | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21                                                                                                                                                                                 | Si          |
| ITBIS                 | N(12)     | Valor del ITBIS. Mismo formato que el campo Amount. El valor enviado en el campo de ITBIS no se carga como un monto adicional en la transacción. En el campo de Amount debe enviarse total a cargar incluyendo el ITBIS. Si la transacción o el negocio están exentos, se envía en cero colocando el valo “000”.Este valor deberá también ser incluido en el cálculo del hash. | No          |
| OrderNumber           | X(15)     | Número de orden asociado a la transacción. Puede viajar nulo, pero siempre debe de estar presente.                                                                                                                                                                                                                                                                             | Si          |
| AcquirerRefDat        | N(1)      | Uso Interno AZUL Valor Fijo: 1                                                                                                                                                                                                                                                                                                                                                 | No          |
| CustomerServicePhone  | X(32)     | Número de servicio para atención telefónica del establecimiento. Ej.: 8095442985                                                                                                                                                                                                                                                                                               | No          |
| ECommerceURL          | X(32)     | Dirección web del afiliado                                                                                                                                                                                                                                                                                                                                                     | No          |
| CustomOrderId         | X(75)     | Número Identificador dada por el afiliado a la transacción original (la que se desea consultar/verificar)                                                                                                                                                                                                                                                                      | No          |
| DataVaultToken        | A(100)    | Valor del token generado por AZUL. Para las transacciones de venta con token, no se deben enviar los valores de CardNumber y Expiration. El envío de CVC si es E-Commerce puede ser o no mandatorio depende de lo acordado con su representante de Negocios de AZUL. Si es MOTO la transacción, no se debería enviar CVC.                                                      | Si          |

| Valores de Retorno |
| ------------------ |
| Parámetro          | Tipo Dato | Descripción                                                                                                                                                                                                                  |
| ---                | ---       | ---                                                                                                                                                                                                                          |
| AuthorizationCode  | X(10)     | Código de autorización generado por el centro autorizador para la transacción. Sólo presente si la transacción fue aprobada. ISOCode = ISO8583 y ResponseCode = 00                                                           |
| AzulOrderId        | N(8)      | \# de orden SDP. Puede ser usado en vez del RNN para generar una devolución. Importante dar prioridad a este valor sobre el RNN.                                                                                             |
| CustomOrderId      | X(75)     | Numero Identificador dada por el afiliado a la transacción. Si no fue provisto en la transacción, este campo viaja en blanco                                                                                                 |
| DateTime           | N(14)     | Fecha y hora de la transacción. Formato YYYYMMDDHHMMSS.                                                                                                                                                                      |
| ErrorDescription   | X(999)    | Descripción del error. Valor sólo presente si la transacción produjo un error. En caso de no presentar error ese campo viaja en blanco                                                                                       |
| IsoCode            | N(2)      | Código ISO-8583 recibido de respuesta.                                                                                                                                                                                       |
| LotNumber          | N(4)      | Número de lote en que se registró la transacción                                                                                                                                                                             |
| RRN                | N(20)     | Número de referencia                                                                                                                                                                                                         |
| ResponseCode       | X(7)      | Código de respuesta. Puede contener uno de los siguientes valores: Iso8583 = la transacción fue procesada. Se debe revisar el campo ISOCode para ver la respuesta de la transacción Error = La transacción no fue procesada. |
| ResponseMessage    | X(999)    | Mensaje de respuesta ISO-8583. Valor sólo presente si el ResponseCode = ISO8583                                                                                                                                              |
| Ticket             | N(4)      | Número del ticket correspondiente a la transacción                                                                                                                                                                           |

## Método ProcessDatavault

## Create: Creación de Token con Bóveda de Datos (DataVault)

Con esta transacción se solicita un token para ser utilizado en sustitución de la tarjeta, sin necesidad de realizar una venta.

| Transacción de venta  |
| --------------------- |
| Parámetros de Entrada |
| ---                   |
| Parámetro             | Tipo Dato | Descripción Observación                                                                                                                                  | Obligatorio |
| ---                   | ---       | ---                                                                                                                                                      | ---         |
| Channel               | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                         | Si          |
| Store                 | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                           | Si          |
| CardNumber            | N(19)     | Número de tarjeta a tokenizar. La longitud del campo se determina por la tarjeta, no se debe rellenar con ceros (0), espacios, ni caracteres especiales. | Si          |
| Expiration            | N(6)      | Fecha expiración/vencimiento de la tarjeta Formato YYYYMM Ej.: 201502                                                                                    | Si          |
| TrxType               | A(10)     | Valor = CREATE (Este valor es case sensitive)                                                                                                            | Si          |
| CVC                   | N(3)      | Valor = CREATE (Este valor es case sensitive)                                                                                                            | No          |

| Valores de Retorno |
| ------------------ |
| Parámetro          | Tipo Dato | Descripción                                                                                                                            |
| ---                | ---       | ---                                                                                                                                    |
| Brand              | X(15)     | Marca de la tarjeta                                                                                                                    |
| CardNumber         | X(19)     | Número de tarjeta enmascarada (ej. XXXXXX…XXXX)                                                                                        |
| DataVaultToken     | X(30)     | Token generado por SDP.                                                                                                                |
| ErrorDescription   | X(999)    | Descripción del error. Valor sólo presente si la transacción produjo un error. En caso de no presentar error ese campo viaja en blanco |
| Expiration         | N(6)      | Fecha expiración del token. Formato YYYYMM                                                                                             |
| HasCVV             | B         | Indica si el Token fue creado con CVV                                                                                                  |
| ISOCode            | N(2)      | Código ISO-8583 recibido de respuesta.                                                                                                 |
| ReponseMessage     | X(999)    | Mensaje de respuesta                                                                                                                   |

## Delete: Eliminación de Token de Bóveda de Datos (DataVault)

Con esta transacción se solicita la eliminación de un token de la Bóveda de Datos.

| Transacción para creación de Token |
| ---------------------------------- |
| Parámetros de Entrada              |
| ---                                |
| Parámetro                          | Tipo Dato | Descripción Observación                                                                          | Obligatorio |
| ---                                | ---       | ---                                                                                              | ---         |
| Channel                            | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente | Si          |
| Store                              | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                   | Si          |
| DataVaultToken                     | X(30)     | Token generado por AZUL.                                                                         | Si          |
| TrxType                            | A(10)     | Valor = DELETE (Este valor es case sensitive)                                                    | Si          |

| Valores de Retorno |
| ------------------ |
| Parámetro          | Tipo Dato | Descripción                                                                                                                            |
| ---                | ---       | ---                                                                                                                                    |
| Brand              | X(15)     | Marca de la tarjeta                                                                                                                    |
| CardNumber         | X(19)     | Número de tarjeta enmascarada (ej. XXXXXX…XXXX)                                                                                        |
| DataVaultToken     | X(30)     | Token generado por SDP.                                                                                                                |
| ErrorDescription   | X(999)    | Descripción del error. Valor sólo presente si la transacción produjo un error. En caso de no presentar error ese campo viaja en blanco |
| Expiration         | N(6)      | Fecha expiración del token. Formato YYYYMM                                                                                             |
| HasCVV             | B         | Indica si el Token fue creado con CVV                                                                                                  |
| ISOCode            | N(2)      | Código ISO-8583 recibido de respuesta.                                                                                                 |
| ReponseMessage     | X(999)    | Mensaje de respuesta                                                                                                                   |

## Errores de Validación

Si la respuesta del mensaje contiene el valor ‘Error’ para el campo ResponseMessage, podrá verificar el motivo del error en el campo ErrorDescription. Estos son los errores que pueden ser devueltos por el servicio:

| Código Error                | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| --------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| INVALID\_HTTP\_METHOD       | El método HTTP utilizado no es el aceptado. Debe ser POST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| PARSING\_ERROR              | Ocurrió un error al interpretar el mensaje de entrada. Para casos de SOAP recibirá un error estándar SOAP indicando que el Envelope no cumple con la estructura esperada.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| VALIDATION\_ERROR:FieldName | Indica que uno de los campos del mensaje no fue enviado o no cumple con los requerimientos. El detalle del mensaje indica el campo afectado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| SSL\_OFF                    | Ocurre cuando la transacción requiere conexión segura SSL y la transacción ha sido enviada sin este activado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| MISSING\_AUTH\_HEADER:Auth1 | Indica que el parámetro/factor de autenticación #1 no ha sido enviado. Debe revisar que este esté presente en los headers del mensaje SOAP o en los headers HTTP del POST del mensaje.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| MISSING\_AUTH\_HEADER:Auth2 | Indica que el parámetro/factor de autenticación #2 no ha sido enviado. Debe revisar que este esté presente en los headers del mensaje SOAP o en los headers HTTP del POST del mensaje.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| INVALID\_AUTH:Auth          | Indica que el perfil indicado en Auth1/Auth2 no es válido o no existe en el sistema.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| DISABLED\_PROFILE           | Indica que el perfil es correcto pero no está habilitado para transacciones.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| INVALID\_MERCHANTID         | El Store/MerchantID especificado no corresponde con el asignado al perfil.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| INVALID\_CHANNEL            | El código de canal especificado no corresponde con el asignado al perfil.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| INVALID\_VPN\_IPADDRESS     | Si el requerimiento está siendo colocado vía VPN interna (SITE-to-SITE), este error ocurre cuando la dirección IP desde la que origina no está en la lista de direcciones IP's permitidas.<br>Si el equipo o el servidor desde donde se están realizando las pruebas se encuentra fuera de República Dominicana, el comercio recibirá un bloqueo por seguridad cuando intenten llegar al ambiente de desarrollo.<br>Para evitar este bloqueo deben enviarnos las IPs públicas y fijas del equipo que realiza dichas pruebas para brindarles los permisos correspondientes.<br>Cabe mencionar que este bloqueo solo existe para el ambiente de desarrollo, en producción no está presente. |
| INVALID\_CLIENT\_CERT       | Indica que el serial del Client Certificate desde donde se está iniciando la transacción no coincide con el asignado para el perfil de acceso.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| PROCESSING\_ERROR           | Error general procesando la transacción.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| MISSING\_CLIENT\_CERT       | Cuando se recibe un requerimiento sin certificado digital, habiendo seleccionado este método de autenticación mutua.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| WRONG TRANSACTION STATE     | Se genera cuando recibimos dos veces seguidas el mismo request para autorizar una transacción ya declinada o aprobada.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

## Método ProcessVoid

## Transacción para anular venta, post o hold

Las transacciones de venta o post se pueden anular antes de los 20 minutos de haber recibido la respuesta de aprobación.

Las transacciones de hold que no han sido posteadas no tienen límite de tiempo para anularse.

| Parámetros de Entrada |
| --------------------- |
| Parámetro             | Tipo Dato | Descripción Observación                                                                                                            | Obligatorio |
| ---                   | ---       | ---                                                                                                                                | ---         |
| Channel               | X(3)      | Canal de pago.<br>Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                | Si          |
| Store                 | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                     | Si          |
| AzulOrderId           | N(999)    | \# de orden SDP. Identificador único de la transacción.<br>Este valor es generado por una transacción exitosa (Venta, Hold o Post) | Si          |

| Valores de Retorno  |
| ------------------- |
| Parámetro           | Tipo Dato | Descripción                                                                                                                                                                                                                            |
| ---                 | ---       | ---                                                                                                                                                                                                                                    |
| AuthorizationCode   | X(10)     | Código de autorización generado por el centro autorizador para la transacción.<br>Sólo presente si la transacción fue aprobada. ISOCode = ISO8583 y ResponseCode = 00                                                                  |
| CustomOrderId       | X(75)     | Numero Identificador dada por el afiliado a la transacción. Si no fue provisto en la transacción, este campo viaja en blanco                                                                                                           |
| AzulOrderId         | N(8)      | \# de orden SDP. Identificador único de la transacción.                                                                                                                                                                                |
| DateTime            | N(14)     | Fecha y hora de la transacción.<br>Formato YYYYMMDDHHMMSS.                                                                                                                                                                             |
| ErrorDescription    | X(999)    | Descripción del error.<br>Valor sólo presente si la transacción produjo un error. En caso de no presentar error ese campo viaja en blanco.                                                                                             |
| ISOCode             | N(2)      | Código ISO-8583 recibido de respuesta.                                                                                                                                                                                                 |
| LotNumber           | N(4)      | Número de lote en que se registró la transacción.                                                                                                                                                                                      |
| RRN                 | N(20)     | Número de referencia (Reference referral number).                                                                                                                                                                                      |
| ResponseCode        | X(7)      | Código de respuesta.<br>Puede contener uno de los siguientes valores:<br>Iso8583 = la transacción fue procesada. Se debe revisar el campo ISOCode para ver la respuesta de la transacción.<br>Error = La transacción no fue procesada. |
| ReponseMessage      | X(999)    | Mensaje de respuesta ISO-8583.                                                                                                                                                                                                         |
| Ticket              | N(4)      | Número del ticket correspondiente a la transacción (Valor sólo presente si el ResponseCode = ISO8583).                                                                                                                                 |
| DataVaultToken      |           | Solo respondidos si se tiene Datavault encendidos.                                                                                                                                                                                     |
| DataVaultExpiration |           | Solo respondidos si se tiene Datavault encendidos.                                                                                                                                                                                     |
| DataVaultBrand      |           | Solo respondidos si se tiene Datavault encendidos.                                                                                                                                                                                     |

## Vista general 3D-Secure 2.0

Si el comercio electrónico está habilitado con el Servicio de Autenticación del Tarjetahabiente, 3-D Secure (3DS), todas las transacciones de venta (Sale) o pre-autorización (Hold) realizadas con tarjetasVisa y Mastercard pasarán por defecto por el proceso de 3-D Secure, por lo que la autenticación se realiza en línea con el flujo de transacciones existente. El proceso comienza con la solicitud de una autorización de venta o hold. Luego, la autorización se coloca en un estado de espera hasta que se completa el proceso de autenticación. Durante la autenticación, es posible que el comercio deba enviar información adicional una o más veces para hacer avanzar el flujo del proceso. Al final del proceso de autenticación, la transacción original se actualiza con los resultados de la autenticación y se completa la autorización. Es importante tener en cuenta que la funcionalidad de 3-D Secure (Autenticación del tarjetahabiente), aplica sólo para las transacciones que son de E-Commerce, donde el titular de la tarjeta es quien realiza la transacción en la plataforma del comercio y digita los datos de su tarjeta directamente.La nueva versión del servicio de Autenticación del Tarjetahabiente con 3D-Secure 2.0 se implementa a partir de una transacción de venta o hold enviando datos adicionales para la autenticación, y se definen 3 flujos posibles que puede tener el proceso de autenticación:

## ForceNo3DS

En caso de que se tenga el servicio de Autenticación del Tarjetahabiente habilitado y se desea enviar una transacción que no pase por la autenticación con 3D-Secure, se debe incluir en el mensaje inicial de Venta (Sale) o Hold el campo ForceNo3DS = “1”. Al enviar el campo ForceNo3DS = “1” el comercio pierde la protección por fraude brindada por el servicio de Autenticación del Tarjetahabiente para la transacción, por lo que asume el riesgo recibir un contra cargo en caso que resulte ser fraudulenta.

Para el procesamiento con 3-D Secure 2.0 se deben incluir en el mensaje de venta (Sale o Hold) dos campos o nodos adicionales, el “ThreeDSAuth” y "CardHolderInfo", los cuales tienen sub-campos detallados a continuación.

## Flujo sin fricción (SF)

En el siguiente diagrama se muestra la secuencia del flujo sin fricción con cada paso detallado a continuación:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/pic20220815111117.png)

## Paso 1: Recopile los detalles de pago del tarjetahabiente

Primero, recopile la información de pago de la tarjeta (número de tarjeta de crédito o débito, fecha de vencimiento, código de seguridad) de su cliente.

## Paso 2: Iniciar un pago

Utilice la tarjeta de pago (o el token si utiliza el servicio de Bóveda de datos) para iniciar una transacción de pago principal. Los tipos de transacción relevantes para la autenticación con 3DSecure 2.0 son:

- Sale: Transacción de venta con captura inmediata
- Hold: Transacción de venta con solo reserva de fondos

Este mensaje debe ser enviado al Webservice de Azul utilizando una de las siguientes URL según el tipo de mensajería elegida:

- SOAP (método ProcessPayment): [https://pagos.azul.com.do/WebServices/SOAP/default.asmx](https://pagos.azul.com.do/WebServices/SOAP/default.asmx)
- JSON: [https://pagos.azul.com.do/WebServices/JSON/default.aspx](https://pagos.azul.com.do/WebServices/JSON/default.aspx) Para ambiente de prueba utilizar el dominio pruebas.azul.com.do.

| Sub-Campos                  | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| --------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| TermUrl                     | URL del comercio donde serán posteados los valores de respuesta con el resultado de la autenticación del por el servidor ACS (este es el servidor del banco emisor que procesa la autenticación del tarjetahabiente). Se deber construir con un identificador único que sirva para asociar                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| MethodNotificationUrl       | URL del comercio donde se recibirá la notificación de que se completó el iFrame (el cual se hará referencia más adelante) y capturó los datos del navegador para ser usados en el análisis de riesgo. Esta notificación debe llegar mediante un HTTP Post del servidor ACS del emisor y contiene un identificador único de transacción representado con el threeDSServerTransID. Esta URL debe ser única e identificable, por lo que cuando se reciba la notificación, debería poder asociarse con la transacción correspondiente. Esto elimina cualquier dependencia del threeDSServerTransID, que se recibe con la respuesta del nodo ThreeDSMethod. Una forma sencilla de garantizar el mapeo correcto con las transacciones es pasar una referencia de transacción como un query string. Por ejemplo: “ [http://www.mitienda.com/3dscapture.aspx?sid=6371952800755](http://www.mitienda.com/3dscapture.aspx?sid=6371952800755) 07073. |
| RequestorChallengeIndicator | Este indicador sirve para comunicar al banco emisor la preferencia que tiene comercio de que se solicite el desafío.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |

Valores RequestorChallengeIndicator:

| Indicador de desafío | Descripción                                                                                                                                                                                                                                         |
| -------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 01                   | Sin preferencias (no tiene preferencia si se debe realizar un desafío. Este es el valor predeterminado).                                                                                                                                            |
| 02                   | No solicitar ningún desafío (comercio prefiere que no se realice ningún desafío).                                                                                                                                                                   |
| 03                   | Solicitar desafío: Preferencia del solicitante de 3DS (prefiere que se realice un desafío; esto debe establecerse para transacciones de alto riesgo o valor).                                                                                       |
| 04                   | Cuando solicitar desafío es mandatorio (existen mandatos locales o regionales que indican que se debe realizar un desafío, actualmente en República Dominicana no es mandatorio por lo que en este momento este valor no aplica para nuestro país). |

- CardHolderInfo

Este grupo de campos sirven para ayudar al motor de 3-D Secure del banco emisor de la tarjeta a calcular el riesgo de la transacción e influir en la solicitud o no de un desafío. En caso que no se tenga la información de alguno de los campos, lo recomendable es omitir el campo en el mensaje, o sea que, no enviar el campo si está en blanco.

## Sub-campos CardHolderInfo

| Sub-Campos             | Descripción                                               |
| ---------------------- | --------------------------------------------------------- |
| BillingAddressCity     | Ciudad de la dirección de facturación.                    |
| BillingAddressCountry  | País de la dirección de facturación                       |
| BillingAddressLine1    | Dirección de facturación - Línea 1                        |
| BillingAddressLine2    | Dirección de facturación - Línea 2                        |
| BillingAddressLine3    | Dirección de facturación – Línea 3                        |
| BillingAddressState    | Estado o provincia de la dirección de facturación         |
| BillingAddressZip      | Código postal o “ZIP code” de la dirección de facturación |
| Email                  | Dirección de correo electrónico                           |
| Name                   | Nombre tarjetahabiente                                    |
| PhoneHome              | Teléfono de la casa                                       |
| PhoneMobile            | Teléfono móvil                                            |
| PhoneWork              | Teléfono del trabajo                                      |
| ShippingAddressCity    | Ciudad de la dirección de envío                           |
| ShippingAddressCountry | País de la dirección de envío                             |
| ShippingAddressLine1   | Dirección de envío – Línea 1                              |
| ShippingAddressLine2   | Dirección de envío – Línea 2                              |
| ShippingAddressLine3   | Dirección de envío – Línea 3                              |
| ShippingAddressState   | Estado o provincia de la dirección de envío               |
| ShippingAddressZip     | Código postal o “ZIP code” de la dirección de envío       |

## Este es un ejemplo en JSON de un mensaje de venta con los nuevos campos de 3-D Secure 2.0

- < >

```
 {
      "Channel" :  "EC" ,
      "Store" :  "30082630281" ,
      "CardNumber" :  "1016000000051" ,
      "Expiration" :  "202112" ,
      "CVC" :  "999" ,
      "PosInputMode" :  "E-Commerce" ,
      "TrxType" :  "Sale" ,
      "Amount" :  "1075" ,
      "Itbis" :  "121" ,
      "OrderNumber" :  "" ,
      "CustomOrderId" :  "" ,
      "DataVaultToken" :  "" ,
      "SaveToDataVault" :  "0" ,
      "ForceNo3DS" :  "" ,
      "ThreeDSAuth" : {
      "TermUrl" :  "http: // www. mitienda.com/ post3ThreeDs.aspx?sid=637195280075507073" ,
      "MethodNotificationUrl" :  "http: // www. mitienda.com/ 3dscapture.aspx?sid=637195280075507073" ,
      "RequestorChallengeIndicator" :  "01"
     },
      "CardHolderInfo" : {
      "BillingAddressCity" : "Ciudad Facturación",
      "BillingAddressCountry" : "País Facturación",
      "BillingAddressLine1" : "Línea 1 Dirección Facturación",
      "BillingAddressLine2" : "Línea 2 Dirección Facturación",
      "BillingAddressLine3" : "Línea 3 Dirección Facturación",
      "BillingAddressState" : "Estado o Provincia Facturación",
      "BillingAddressZip" :  "99999" ,
      "Email" :  "correo@ dominio.com" ,
      "Name" : "Nombre Tarjetahabiente",
      "PhoneHome" :  "8099999999" ,
      "PhoneMobile" :  "8299999999" ,
      "PhoneWork" :  "8499999999" ,
      "ShippingAddressCity" : "Ciudad Envío",
      "ShippingAddressCountry" : "País Envío",
      "ShippingAddressLine1" : "Línea 1 Dirección Envío",
      "ShippingAddressLine2" : "Línea 2 Dirección Envío",
      "ShippingAddressLine3" : "Línea 3 Dirección Envío",
      "ShippingAddressState" : "Estado o Provincia Facturación",
      "ShippingAddressZip" :  "99999"
     }
 }
```

Copy

## Paso 3: Respuesta de autenticación de 3D-Secure

Nuestra respuesta incluirá el elemento ThreeDSMethod, con el subcampo MethodForm que genera un iframe oculto que ayuda a recopilar los datos del navegador para los emisores. Esta información se suma al perfil general del consumidor y ayuda a identificar transacciones potencialmente fraudulentas. También aumenta la probabilidad de una transacción exitosa y sin fricciones. Deberá incluir MethodForm en su sitio web como iframe oculto. No se presenta ninguna pantalla de interfaz de usuario al tarjetahabiente. En este punto, se realiza una solicitud de verificación para determinar si el sistema 3DSecure es funcional y el tarjetahabiente está inscrito en 3DSecure. Si el sistema 3DSecure del banco emisor no está funcionando o el banco emisor declina el intento de autenticación, la transacción será rechazada.

Si se verifica que la tarjeta está inscrita en el programa 3DSecure, la respuesta contendrá los siguientes valores:

| Atributo                   | Descripción                                                                                                           |
| -------------------------- | --------------------------------------------------------------------------------------------------------------------- |
| AzulOrderId                | Identificador único para la transacción.                                                                              |
| IsoCode                    | 3D2METHOD                                                                                                             |
| ResponseMessage            | 3D\_SECURE\_2\_METHOD                                                                                                 |
| ThreeDSMethod / MethodForm | Datos de formulario HTML con iFrame oculto que se utilizan para recopilar los datos del navegador web para el Emisor. |

El siguiente documento JSON representa un ejemplo de respuesta:

- < >

```
 {
      "AuthorizationCode":"" ,
      "AzulOrderId":"39306" ,
      "CustomOrderId":"" ,
      "DateTime":"20200312100359" ,
      "ErrorDescription":"" ,
      "IsoCode":"3D2METHOD" ,
      "LotNumber":"" ,
      "RRN":"" ,
      "ResponseCode":"ISO8583" ,
      "ResponseMessage":"3D_SECURE_2_METHOD" ,
      "ThreeDSMethod" :{
      "MethodForm":" < iframe xmlns= "http: // www. w3.org/1999/xhtml"  src= "javascript:false;"  style="width: 1px;
     height: 1px; display: none;" name= "tdsMmethodTgtFrame"  id= "tdsMmethodTgtFrame" >

```

Copy

## Paso 4: solicitud y respuesta de notificación del método 3DS

El 3DSecure methodForm se utiliza para proporcionar detalles del entorno del tarjetahabiente al servidor de control de acceso del banco emisor (ACS). El methodForm contiene el código HTML para un iframe oculto que debe ser incluido en una página web del comercio. Esto obligará a que la información se publique automáticamente en el servidor ACS.La información HTML es un bloque HTML autónomo que no necesita ser modificado o publicado, ya que será cargada automáticamente cuando se renderice la página en la que está insertada. Alternativamente, esto se puede crear en una página que nunca se vuelve visible para el comprador. Si se recibe correctamente, los datos de la respuesta se publicarán en la URL proporcionada en el campo methodNotificationURL original y el mensaje publicado contendrá un campo threeDSServerTransID que contiene el ID de transacción ACS único asociado con la solicitud original. Tenga en cuenta que la carga útil de esta respuesta contendrá un solo elemento llamado threeDSMethodData. Ese elemento contendrá una respuesta JSON codificada en base64 que contiene el campo threeDSServerTransID.

Ejemplo:

- < >

```
 < form name= "frm"  method= "POST"  action="{value from methodNotificationURL}">
 < input type= "hidden"  name= "threeDSMethodData"
 value= "eyJ0aHJlZURTU2VydmVyVHJhbnNJRCI6IjNhYzdjYWE3LWFhNDItMjY2My03OTFiLTJhYzA1YTU0MmM0YSJ9" >

```

Copy

ThreeDSMethodData decodificado:

- < >

```
 {  "threeDSServerTransID"  :  "3ac7caa7-aa42-2663-791b-2ac05a542c4a"  }
```

Copy

## ThreeDSServerTransID

El threeDSServerTransID no es necesario para ningún procesamiento posterior de 3DS. Sin embargo, se recomienda guardar este valor para referencia al servidor ACS en el futuro si es necesario.

## Soporte del emisor 3DS

No todos los emisores soportan la recopilación de datos del navegador mediante el formulario del método 3DS methodForm. En esos casos, no se recibirán datos en el methodNotificationURL, y el flujo debe continuar enviando un estado de EXPECTED\_BUT\_NOT\_RECEIVED. Ver más abajo.

Se debe esperar un mínimo de 10 segundos para que se complete la operación POST anterior y luego determinar el valor methodNotificationStatus de acuerdo a la siguiente tabla:

## MethodNotificationStatus

| Estado                       | Descripción                                                                                                                                                                                                                    |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| RECEIVED                     | solicitud de transacción de venta inicial y ha recibido la notificación de ACS en 10 segundos, recibirá un mensaje HTTP POST de ACS, que contendrá un identificador de transacción único representado por threeDSServerTransID |
| EXPECTED\_BUT\_NOT\_RECEIVED | Ha enviado el elemento methodNotificationURL en la solicitud de transacción de venta inicial y no ha recibido la notificación de ACS en 10 segundos                                                                            |
| NOT\_EXPECTED                | No ha enviado el elemento methodNotificationURL en la solicitud de transacción de venta inicial                                                                                                                                |

## Paso 5 (SF): Solicitud ProcessThreeDSMethod para continuar con la autenticación 3DS

Una vez que se ha completado la llamada al método 3DS, debe notificar al Webservice de Azul que el proceso de autenticación puede continuar enviando el campo methodNotificationStatus con el valor según la condición correspondiente de la tabla anterior. Este mensaje debe ser enviado al Webservice de Azul utilizando una de las siguientes URL según el tipo de mensajería elegida:  SOAP (método ProcessThreeDSMethod): [https://pagos.azul.com.do/WebServices/SOAP/default.asmx](https://pagos.azul.com.do/WebServices/SOAP/default.asmx)  JSON: [https://pagos.azul.com.do/WebServices/JSON/default.aspx?processthreedsmethod](https://pagos.azul.com.do/WebServices/JSON/default.aspx?processthreedsmethod) Para ambiente de prueba utilizar el dominio pruebas.azul.com.do.

| Atributo                 | Descripción                                                              |
| ------------------------ | ------------------------------------------------------------------------ |
| Channel                  | Canal utilizado para la integración (valor proporcionado por Azul)       |
| Store                    | Merchant ID (MID) Azul                                                   |
| AzulOrderId              | Identificador único para la transacción.                                 |
| methodNotificationStatus | Enviar el valor según el estado de la notificación. Ver tabla de arriba. |

El siguiente documento JSON representa un ejemplo de una solicitud que se enviará después de la visualización del formulario:

- < >

```
 {
      "Channel":"EC" ,
      "Store":"MerchantID" ,
      "AzulOrderId":"39306" ,
      "MethodNotificationStatus" :  "RECEIVED"
 }
```

Copy

## Paso 6 (SF): Respuesta final de 3DS

Luego que el banco ha autenticado completamente al cliente y determina que no se requiere un desafío, se completa el proceso de 3DSecure y se procesa la autorización de la transacción. A continuación, se recibirá un mensaje de respuesta con el mismo formato utilizado para el método de venta. Se debe evaluar el campo “IsoCode” con la respuesta (00 es aprobada) y el campo “ResponseMessage” en caso de obtener una respuesta distinta a 00. En caso de que haya ocurrido algún error para procesar la autorización, el mismo será descrito en el campo de “ErrorDescription”. El siguiente documento JSON representa un ejemplo de una respuesta que recibe de la API que indica que la autorización se ha realizado correctamente:

- < >

```
 {
      "AuthorizationCode":"OK0937" ,
      "AzulOrderId":"39597" ,
      "CustomOrderId":"" ,
      "DataVaultBrand":"" ,
      "DataVaultExpiration":"" ,
      "DataVaultToken":"" ,
      "DateTime":"20200316102920" ,
      "ErrorDescription":"" ,
      "IsoCode":"00" ,
      "LotNumber":"1" ,
      "RRN":"20200316103117592602" ,
      "ResponseCode":"ISO8583" ,
      "ResponseMessage":"APROBADA" ,
      "Ticket":"2"
 }
```

Copy

## Flujo de desafío 3D-Secure 2.0

El flujo de desafío se activa cuando la transacción no se considera de bajo riesgo o cuando el Emisor requiere autenticación adicional por parte del titular de la tarjeta. Este flujo inicia igual que el flujo sin fricción con una solicitud de transacción de Autorización o Venta inicial y dependiendo de la implementación del banco emisor podría iniciar en dos etapas: 1. Desafío sin ThreeDSMethod (D): Inicia igual que el flujo sin fricción hasta el paso 2, pero en este caso el emisor no usa el MethodForm o decide desafiar al comprador de entrada. En el siguiente diagrama se muestra la secuencia del flujo de desafío sin el ThreeDSMethod:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/pic20220819094927.png)

2\. Desafío con ThreeDSMethod (DM): Inicia igual que el flujo sin fricción hasta el paso 5 (SF) donde se completa el ProcessThreeDSMethod. En el siguiente diagrama se muestra la secuencia del flujo de desafío con el ThreeDSMethod:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/pic20220819095712.png)

En ambos casos se recibe una respuesta con el IsoCode “3D” con campos adicionales indicando que se requiere el desafío del tarjetahabiente.

## Paso 3 (D) \| 6 (DM): Webservice Azul responde para continuar con la autenticación 3DS

Para el flujo de desafío, la respuesta contendrá los siguientes valores:

| Atributo                         | Descripción o Valor                                                                                                       |
| -------------------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| AzulOrderId                      | Identificador único para la transacción                                                                                   |
| DateTime                         | Fecha y hora transacción formato AAAAMMDDHHMMSS                                                                           |
| IsoCode                          | "3D"                                                                                                                      |
| ResponseCode                     | "ISO8583"                                                                                                                 |
| ResponseMessage                  | “3D\_SECURE\_CHALLENGE”                                                                                                   |
| ThreeDSChallenge/creq            | Un mensaje de solicitud codificado devuelto por el servidor ACS del banco emisor.                                         |
| ThreeDSChallenge/RedirectPostUrl | La URL del servidor ACS en la que se debe publicar el valor cReq para que se lleve a cabo el desafío del tarjetahabiente. |

El siguiente documento JSON representa un ejemplo de respuesta:

- < >

```
 {
      "AuthorizationCode":"" ,
      "AzulOrderId":"39306" ,
      "CustomOrderId":"" ,
      "DateTime":"20200312100359" ,
      "ErrorDescription":"" ,
      "IsoCode":"3D" ,
      "LotNumber":"" ,
      "RRN":"" ,
      "ResponseCode":"ISO8583" ,
      "ResponseMessage":"3D_SECURE_CHALLENGE" ,
      "ThreeDSChallenge" :{
      "CReq":" ewogICAiYWNzVHJhbnNJRCIgOiAiNzlhZmU5MDUtN2E2Ni00OGZmLThkMmEtMDVjYjUyNWJlMWI2IiwKICAgImNoYWxsZW5nZVdp
     bmRvd1NpemUiIDogIjAzIiwKICAgIm1lc3NhZ2VUeXBlIiA6ICJDUmVxIiwKICAgIm1lc3NhZ2VWZXJzaW9uIiA6ICIyLjEuMCIsCiAgICJ0aHJlZURTU
     2VydmVyVHJhbnNJRCIgOiAiY2UyY2YxZTgtNWQ5YS01ZWZkLTgwMDAtMDAwMDAwNjMyZjRiIgp9",
      "MD":"" ,
      "PaReq":"" ,
      "RedirectPostUrl":"https: //3ds- acs. test. modirum.com/mdpayacs/creq" ,
      "Ticket":""
 }
```

Copy

## Paso 4 (D) \| 7 (DM): Redirección desafío al tarjetahabiente

En el siguiente paso, se debe hacer un POST con los datos recibidos en el campo cReq al RedirectPostUrl indicado, normalmente implementado como un formulario de envío automático (auto-submit). Esto debe implementarse dentro del sitio web del comercio. El tarjetahabiente será redirigido al ACS del emisor y se les presentará la interfaz de usuario para recopilar los detalles de autenticación, por ejemplo, ingresar una contraseña única o realizar la autenticación usando su aplicación bancaria (autenticación fuera de banda). Una vez completada la autenticación, se redirige al consumidor a su página web.

## Asignación de nombres de campo

Esta información se publica utilizando los siguientes nombres de campo: creq= Mensaje de solicitud de desafío codificado en base64 completo como se obtuvo anteriormente. Nota: el nombre del campo creq es “case sensitive” por lo que debe ser enviado en minúscula. TermUrl= La URL del comercio donde serán posteados los valores de respuesta con el resultado de la autenticación del por el servidor ACS. Esta es la URL enviada en el paso 2.

Ejemplo:

- < >

```
 < form name= "frm"  method= "POST"  action="https: //3ds- acs. test. modirum.com/mdpayacs/creq ">
     < input type=”hidden” name=”creq” value=” ewogICAiYWNzVHJhbCIgOiA. . .wMDAtMDAwMDAwMDA0MWE5Igp9”>
     < input type=”hidden” name=”TermUrl” value=”http: // www. mitienda.com/ post3ThreeDs. .”>

```

Copy

Cuando se complete la autenticación, se publicará una respuesta de autenticación en la URL especificada en el campo TermUrl.

## Asignación de los nombres de campo

Esta información se publica con los siguientes nombres de campo: cRes= El mensaje de respuesta de desafío codificado en base64 del servidor del emisor ACS. threeDSSessionData= Los datos de sesión codificados en base64 del servidor Emisor ACS.

Ejemplo respuesta:

- < >

```
 < form name= "frm"  method= "POST"  action= "http: // www. mitienda.com/ post3ThreeDs. ." >
 < input type= "hidden"  name= "cRes"  value= "ewogICAiYWNzUmVmZX…Fuc1N0YXR…IKfQ==" >
 < input type=”hidden” name=”threeDSSessionData” value=” 50F2156E03083CA665BCB4. .”>

```

Copy

## Paso 5 (D) \| 8 (DM): Envío solicitud ProcessThreeDSChallenge para completar autorización

Después de recibir los datos de ACS, debe enviarnos los valores recibidos en el elemento cRes junto con la referencia a la transacción original. El comercio envía una solicitud utilizando el método ProcessThreeDSChallenge con los campos detallados abajo. Este mensaje debe ser enviado al Webservice de Azul utilizando una de las siguientes URL según el tipo de mensajería elegida:

SOAP (método ProcessThreeDSChallenge):

[https://pagos.azul.com.do/WebServices/SOAP/default.asmx](https://pagos.azul.com.do/WebServices/SOAP/default.asmx)

JSON:

[https://pagos.azul.com.do/WebServices/JSON/default.aspx?processthreedschallenge](https://pagos.azul.com.do/WebServices/JSON/default.aspx?processthreedschallenge)

Para ambiente de prueba utilizar el dominio pruebas.azul.com.do.

| Atributo    | Descripción                                                              |
| ----------- | ------------------------------------------------------------------------ |
| Channel     | Canal utilizado para la integración (valor proporcionado por Azul)       |
| Store       | Merchant ID (MID) Azul                                                   |
| AzulOrderId | "Identificador único para la transacción provisto por Azul en el paso 3" |
| cRes        | "Valor devuelto por el ACS del emisor luego de la autenticación."        |

El siguiente documento JSON representa un ejemplo solicitud de ProcessThreeDSChallenge con el elemento cRes:

- < >

```
 {
      "Channel":"EC" ,
      "Store":"MerchantID" ,
      "AzulOrderId":"39306" ,
      "CRes":" ewogICAiYWNzUmVmZXJlbmNlTnVtYmVyIiA6ICJBQ1NFbXUyIiwKICAgImFjc1RyYW5zSUQiIDogIjAwMDAwMDAwLTAwMDUtNWE1
     YS04MDAwLTAxNzBlM2M2MTg1YyIsCiAgICJtZXNzYWdlVHlwZSIgOiAiQ1JlcyIsCiAgICJtZXNzYWdlVmVyc2lvbiIgOiAiMi4xLjAiLAogICAidGhyZ
     WVEU1NlcnZlclRyYW5zSUQiIDogIjJkMWQzMTkyLWExMWUtNWI1MS04MDAwLTAwMDAwMDBiODJmNSIsCiAgICJ0cmFuc1N0YXR1cyIgOiAiWSIKfQ"
 }
```

Copy

## Paso 6 (D) \| 9 (DM): Respuesta final de 3DS

Dado que esta transacción se inició como una venta (Sale) o pre-autorización (Hold), la autorización se realiza como parte de este paso final si la autenticación fue completada. Luego se recibirá la respuesta que debe ser evaluada con el campo “IsoCode” con el código de respuesta (00 es aprobada) y el campo “ResponseMessage” con la descripción del código de respuesta. El siguiente documento JSON representa un ejemplo de una respuesta que recibe que indica que la autorización fue aprobada:

- < >

```
 {
      "AuthorizationCode":"OK0937" ,
      "AzulOrderId":"39597" ,
      "CustomOrderId":"" ,
      "DataVaultBrand":"" ,
      "DataVaultExpiration":"" ,
      "DataVaultToken":"" ,
      "DateTime":"20200316102920" ,
      "ErrorDescription":"" ,
      "IsoCode":"00" ,
      "LotNumber":"1" ,
      "RRN":"20200316103117592602" ,
      "ResponseCode":"ISO8583" ,
      "ResponseMessage":"APROBADA" ,
      "Ticket":"2"
     }
```

Copy

## Paso 3 (D): Webservice Azul responde para continuar con la autenticación 3DS 1.0

Para el flujo con 3DS 1.0, la respuesta contendrá los siguientes valores:

| Atributo                         | Descripción o Valor                                                                                                                |
| -------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| AzulOrderId                      | Identificador único para la transacción                                                                                            |
| DateTime                         | Fecha y hora transacción formato AAAAMMDDHHMMSS                                                                                    |
| IsoCode                          | 3D                                                                                                                                 |
| ResponseCode                     | “ISO8583”                                                                                                                          |
| ResponseMessage                  | “3D\_SECURE\_CHALLENGE”                                                                                                            |
| ThreeDSChallenge / MD            | El identificador de sesión devuelto por el servidor ACS del emisor.                                                                |
| ThreeDSChallenge/PaReq           | Mensaje de solicitud codificado devuelto por el servidor ACS.                                                                      |
| ThreeDSChallenge/RedirectPostUrl | La URL del servidor ACS en la que se debe publicar los valores PaReq y MD para que se lleve a cabo el desafío del tarjetahabiente. |

El siguiente documento JSON representa un ejemplo de respuesta:

- < >

```
 {
      "AuthorizationCode":"" ,
      "AzulOrderId":"39306" ,
      "CustomOrderId":"" ,
      "DateTime":"20200312100359" ,
      "ErrorDescription":"" ,
      "IsoCode":"3D" ,
      "LotNumber":"" ,
      "RRN":"" ,
      "ResponseCode":"ISO8583" ,
      "ResponseMessage":"3D_SECURE_CHALLENGE" ,
      "ThreeDSChallenge" :{
      "CReq":"" ,
      "MD":" MD_______3592050202003121003592214XslDJDEA/Yarp9LHdBz5mqlYrzw=_____534537_____________30082630281_____
     __________________170449200ww________________________________________________________________________________________
     _returnurl?_________________________________________________________________________________________________________________
     ____VRQ17044920c7b8d5",
      "PaReq":" eJxVUdtuwjAM/ZWKD6iTAqJFJhKXTaDBKJeJaW9Ra0altYUkneDvl7R0bH7yOfFx7GPcnxTRbEdJpUjgirSWn+Rl6agTbzcDxs
     Iw4h2B8XhLF4HfpHRWFoL7zA8QWmh1KjnJwgiUyWWyeBX9OhDuEHNSi5mIImaji9BALGROYrqebNc7b7zcL6ZPCDWHSVkVRt1EwHsILcBKfYmTMWc9BDC
     kjd9NtX/MlDapNNJPyhzB1SA8Boorl2nb85ql4t0cmAzV8rAM3o4fEM71LV29HNPn62qE4CrQtiIRsICzQcA8Hg0ZG/btFDWPMnfDiNk69jjzB27Fhs
     Gz+2jcAKu1L38ZtAYrKpJ2pRYhXc9lQbbC+vmbIzzGns6dq4mxhvEeDyPWjbgztmacPKt94o3eAQSngfvN4H5Um/079g9ciKWi",
      "RedirectPostUrl":"https: //3ds- acs. test. modirum.com/mdpayacs/creq"
     },
      "Ticket":""
 }
```

Copy

## Paso 4 (D): Redirección tarjetahabiente al desafío

En el siguiente paso, se debe hacer un POST con los datos recibidos en los campos MD y PaReq al RedirectPostUrl indicado, normalmente implementado como un formulario de envío automático (auto-submit). Esto debe implementarse dentro del sitio web del comercio. El tarjetahabiente será redirigido al ACS del emisor y se le presentará la interfaz de usuario para recopilar los detalles de autenticación, por ejemplo, ingresar una contraseña única o un código enviado a su correo. Una vez completada la autenticación, se redirige al consumidor a su página web.

## Asignación de nombres de campo

Esta información se publica utilizando los siguientes nombres de campo: MD = Identificador de la sesión del emisor. PaReq = Mensaje de solicitud de desafío codificado en base64 completo como se obtuvo anteriormente. TermUrl = La URL del comercio donde serán posteados los valores de respuesta con el resultado de la autenticación del por el servidor ACS. Esta es la URL enviada en el paso 2.

Ejemplo:

- < >

```
 < form name= "frm"  method= "POST"  action="https: //3ds- acs. test. modirum.com/mdpayacs/pareq ">
 < input type=”hidden” name=”MD” value=” MD_______3592050202003121. . .________VRQ17044920c7b8d5”>
 < input type=”hidden” name=”PaReq” value=” ewogICAiYWNzVHJhbCIgOiA. . .wMDAtMDAwMDAwMDA0MWE5Igp9”>
 < input type=”hidden” name=”TermUrl” value=”http: // www. mitienda.com/ post3ThreeDs. .”>
 < /form>
```

Copy

Cuando se complete la autenticación, el servidor ACS del banco emisor publicará una respuesta de autenticación en la URL del comercio especificada en el campo TermUrl.

## Asignación de los nombres de campo

Esta información se publica con los siguientes nombres de campo: PaRes= El mensaje de respuesta de desafío codificado en base64 del servidor del emisor ACS. MD= Los datos de sesión codificados en base64 del servidor Emisor ACS.

Ejemplo respuesta:

- < >

```
 < form name= "frm"  method= "POST"  action= "http: // www. mitienda.com/ post3ThreeDs. ." >
 < input type= "hidden"  name= "PaRes"  value=" eJzlWFmv47aS/itB7qORaL… p5fl6A/3kj/G2Hse1k=">
 < input type=”hidden” name=”MD” value=” MD_______3592050202003121. . .________VRQ17044920c7b8d5”>
 < /form>
```

Copy

## Paso 5 (D): Envío solicitud ProcessThreeDSChallenge para completar autorización

Después de recibir los datos de ACS, debe enviarnos los valores recibidos en los elementos PaRes y MD junto con la referencia a la transacción original. El comercio envía una solicitud utilizando el método ProcessThreeDSChallenge con los campos detallados abajo. Este mensaje debe ser enviado al Webservice de Azul utilizando una de las siguientes URL según el tipo de mensajería elegida:

| Atributo    | Descripción                                                            |
| ----------- | ---------------------------------------------------------------------- |
| Channel     | Canal utilizado para la integración (valor proporcionado por Azul)     |
| Store       | Merchant ID (MID) Azul                                                 |
| AzulOrderId | Identificador único para la transacción provisto por Azul en el paso 3 |
| PaRes       | Valor devuelto por el ACS del emisor luego de la autenticación.        |
| MD          | El identificador de sesión devuelto por el servidor ACS del emisor.    |

El siguiente documento JSON representa un ejemplo solicitud de ProcessThreeDSChallenge con los elementos PaRes y MD:

- < >

```
 {  "Channel":"EC",
 "Store":"MerchantID",
 "AzulOrderId":"39306",
 "PaRes":"
 eJzlWFmv47aS/itB7qORaLet4PQBqF2yJFuLtb1pXy1Z+/Lrr3xOd6fTyGBuBvMwwAgwTJbIYhWr+H0lvplZF8eMEYdjF7+/KXHf+2n8Sx59+fWmay
 cYPp9J5Nf3txvQ4/5D/DieYZI4krtwirs+b+p35Hf4d/QN+tbdtXRh5tfD+5sftpSovhMfzxv0tfv2iDuReSdJeH+wN+iz+wb9Oe82vlr9btGSR+/
 OYMP+uZNtGb0nHnQW+jVSLknELcqXN+g14i3yh/gdhVEEPqHwLwj5Bwz/QeBv0If87flSBx7NuOveR+yW/Ch5233v4jpc31Fkn/K99xYvz6aO9xG7
 c9/bb9Cfxj39+h3+6dl179I303l/G/LHX43C0D9w8g36kL/1gz+M/bv6Bn1tvUGvSdDHVr+/GXla7+Iu/mV5VHX/5ddsGJ5/QNA8z7/P2O9
 Nl0LovhwEk9A+IOrz9F+/fs6KI7FOmvc32q+bOg/9Kt/8YQ+MEg9ZE/0CqrTp8iF7/J1KU39pRSCdpX/b1f4WInj920sCYwix64f+XukP5v4nq/xseNf7v/WZ/0o06CdF7296nMSvgMS/3HXxy6 //+iEBmTyN++F/suK31X7U8E2f5Vdj/B4f2/p5LiVYuBIBTFh2flUo09kEK/3ybd7nyDfou
 4lf7f8Wge++fA60bbS8XEZ4o/rAwybCzgefIoXhTmGiH9BKdSoRW+i89DYNIfRMepTiZJBB6PXGMxt2WZglSEQ+PeT2MCHAdtgoYy2vS+maOQneFT+zt
 BuMsHyeVN6D8kbCHZK1oIT31eFmhFEShjDuDlpzl9zH1Q68XlsY4EikOqr7X1jNA6ISsO8ElOjLSDmvFHGkSBeSJPd25baT4tW+3CUnY2YWuQhupQ/x8
 MgKJ6/mJ0js+vPpCdShbvHVSgcCurEBmw2OolIkK02h65LPGQxxrE3wOMCmcSEfyNkso7t5wI/h0ioIWtAxbbD2Q4KD2LJb7T4l7YoKdDfjY7kcQs6y
 olOahaTbPScqRcCXLz8kzdeIXOL1MwIOAZOMP/ifLTruhjzZs3cHBUUU2dykaYDxKZhFCqSiFjt+gtekLKdGbWK5nYBkwgugUmnZZmXOkzNMAa3nAEPB
 itbPtOYylqbx7CxZ941VFdDzALmzdKawVlmZmslOCg1/yhblYT2qzTUoKaj1KnwQWcRXU/DgepFTq7D2ni56TzVH3QJUfbqO/gxQfJFMUFCpalFAMQ
 XOe4Yom3p3dQpsZNehViLHUSJbbSFmPYNHmGowOwtZqCoFWBRz/xXipjLKan/IlFkxxfm7rKBQRYNnev7wQ2CAfrvDy03RtZlNP2QiAwbGtZen9yDX4
 FGNrsnKCig/fKIyhTbL88Iy4PppY6NQMDJ5fLVGNrwwJpA/5b1CcbvPmLaIJki++qPwjFqGK5K5mDJGvLVFNDEEqP4Ma2uQH7uPr/gY4sxornRpPDG
 bQhVoLEVpgElT9gaY/b3W0HubAle2RDDZgWSkb65QfuivVn9FTxTOWimnHy9KZsyEOthEhZFWZpNhkDSVoDkaXp1accuJZ3AAAWJABqZ78g3NnLPuEKJ
 OJOlxVE2Ar8NjxBzjuCyEKN2exu0Yovb9KmZIZMnpbWYsToeR7pEeKkUlWXh+3IHkFnKskxAO5GOMk+1VCuxkiOwz7tRSIJpV2bFicL5C9uTQUCjdqsLC
 lXwTWre5yvrYpiOxyQ/EKMmw6MYlh8qJsWxRYojENtrsQNQqRjIrzdcN0Oy+T/LL+QYMn8qvHnz3F3mbt0OY3GyqqK8ySQ1uAp7Rict3D8swbZkdCII
 um7LgoG1kB2BUChTCxWEsnK+wwtJgZgHwrzTQlfm15wqYX7GP2JmloFmjFQBm4ZU/OlxQVDpzDbjHAO18jLis8KalRRbVdv6MrbuAaOzspa54md09hnd
 hjyW756D7OiM0vZ8d7c5RG6CznGsiQZ+v+Xly7SoLbXaMPs4OUQQoPH3Nf13b+54jztL8p04F8DyPZnAkgKO8kpOLqfPP8/fztYUMMF95KBh3lmHAhUr
 TjkpZjtL2NwVYP97pZ/aygadCx6nkg+Kf2BU+5lnQPvblSlEuy10GegxmtdUfCiCYFdCBtMbLVs+bpwD8Y0+Zzz1ldzwSUuZvcAfscdhfl6XRcHLf8S0
 9Umbq0cfWRiisuw6iFz1L7WGrKRVsKuZdDWD0hGleiTah0B1f7FI+zqt1kIpzdutHkNL96ezdEEDneH+4WcX91Azw45pbHbXhqu/RaT6Xk2oca9oRIHn
 c9LU96vl91tpHYRnSJWvgc6tepDtyeJhqKGFWOZxHMYGEaQ3XVLEwmSDKaYBRnX0Wrttpz56e8ErKUcHhj1YzxxvncM0UcdjobuDRa/hTuLj35xwOyDS
 e+cmy6cnbUtw820e7FBbjxkWHZzlyCYEjUHbcDz5XxC0fAH/OEos5cvEUw4/zqkWtdJLP4fkwB/jQD5GEC1wuSaIliaKaDbWrwVjhYW5VwNqLSH5mi
 b+lDbHYYWduv9GGDi4nSr4aeHIx64s0XMY61vUE/xm25B22Zv8n+LQs5QeYbEzqE+L3cwuGr9BpStUn7Bs2AXuONH5SA5EFNGXufdS3dxpguS1EycK3O
 di3yVHRm/2cfkA4wy6c7TtqJvLWnqbIsM8pPIPSNRPE3AwvO7ghCpMuavGiBs7fZZuyveiDnXeawJVC8hVBW+gNSJ82uSaoLPMH6riws24blkopxnmWP
 2lRZlfvc122esH7Th+ftrn2nN5Ra92PzssOKsTUyUWrTzos2EqhlY/92S0Iv1JmpaHkENjW+qLI+33fi50mI7savZVitH9CExJWWGty004jHy1lBDSxK
 ctBeJBXxcFltwBthTQtCSzfrzp35iP7WpVh2/OIjltbfaaHCJV3kvGzJQuN2r0W22kenKhi8OK5rvISGNJ6HkznNGa8Ozyn0r63Aur0RbW1vQQzV7zoz
 /ChC469Tc4d2V825V4QjRMy5XIBw4CjJq+c/DUx3OdIHx8nVdyme1eF8q2xDMxNOt4qnaFAD0IoMkVRXbUNeIFcNFagIJHWCvrEcJts8EQd1aAgnFQ/LVkEitN9NnuHt1fMd2FzhaK80N0w1821Wu15ePZuRS7ptT521JScjtNj179T0yL5vjeAi08BhDUkG8XF6zGapt11je0bSeru32iCGk2aGgpw+4RPhQLJ
 maVMwABNgPYc+oA5EeiDwvezr7mch+/Fw04LLvMqc75D8E43ruMLOhwyzSRjERatBPrKpY+ywCBnHy3nq/YDlaTiLJvA5TLO8Byqd19ngtMb31FSi7f
 wiNlt2OPP/9fvP0oYQTt/2gyUPWfcv0K4kKotOhyM/YsBFkXc8fZMcSqLIu+UAnYKM1reEAOM2XOPnu8A4Ds+aIxc9/PK0lPbHuraw4bmGF5q2ZOK
 ZbeESdr8eUS9q7XOeJDTfZ6cj2h7sLMK5H4RPY92HqG4U9Gt5enEHdFayzJEWzXxIb0J7pHyI39LtqmnDtUDIXYAEo3BL59bfjuEm3wHh8Ngb1OZNsxF0
 IExIlA9tFTCKDHAWu5St1ztU1l4S2WkW67MpDaHIBBPmxsWUHQODrFUkASb39a+uxhmmZ6F5eCyRYPkZnGsUSXcaBoaMaaykz5wT7TNSSnAcm0l9SbuIP
 R4Gvt2JQ/U5vIEVAzGA87Y0fEOq1idVui2hJN2irLYxXzliN8u0CUIR+bWxCEpkjl2yNqb7ZPYkKBFapWGvB2CEKP+Q6jmXlA9Hf+s8IcRMZTlWbMqqO
 vrhtwOt8H8mWnvrwr/+d9W+C9o+l+o8PkCuN8q/P1z7rPCt/9a4SsU7jAmuyk7mO+V/Q7PIXy1ml2m/Cz7P0Yx/wCa1fKeVJfHsybQwRUxb6DUm
 31z8R6/SDUkWHbIMQfDyv3rnbKzMx+v0RioUEPPvDiUyWWZjJzR9YeR0HdRolrYrlgNG0MgBxB1EK+dPmtp3rdYoMKiJ4MQ3gTxudrO+PCbsj/1/g6
 cvY/OXbBB7IC0pQIXUCNA07VjIv8ikBJJtCXd4qZ36tlw3U/bnDDlk0OTpvQG+H65cMNiCaHB3gwW2VQVWUp1MdTnaXo66zLJRk9DTtSd+ZNJp2iArI
 tjc0V3g5FxT1O2lvYSwhNxGr3H2bwUownoxOhNCPDTwmSJfes6dgBHkw4Zsrs+SeY5O2puSPxtK8P73U4E/r44KRm7aW6yDYni4f8PaKaWs7D6kQbsCq
 dGCrszC7ltnFqK28/QvNv0FZrpGNk/FW49AAe9URs4tGrkYMbh2XAjjQLcqaVrmeTizB/xU4wdE4tX8+1arqJJAoFvuqOOyKKfXZwDe3y0mun2Wy0Z
 ROZIZ/4cwjf4sew1chic1nLWiJlyW8dW0MC5PHPZjF3LThDQcXb7RFaSP+owuPq1XDxmVadAl67TsUI0LzjdFYxKSIOo4LHjFBneE+VMnciqigkHQ8WJ
 LJIxHI+hL3aUXN6M5ei2h/bM0j1+VnXjqh6gW/sghWVGBAxaN7SVeXwzxdMiWQxreDzr+JE805LDHK967KAcRA336NyiWFQ4XmC5uZiwZBx0eIohBEp
 VFi14KL/eoiITRzkWUMQKTChaWUEAfwPN0J/3MND3u5k/b20+7n4/bp5fl6A/3kj/G2Hse1k=  ",
 "MD":"MD_______3592050202003121003592214XslDJDEA/Yarp9LHdBz5mqlYrzw=_____534537_____________30082630281_____
 __________________170449200ww________________________________________________________________________________________
 _returnurl?_________________________________________________________________________________________________________________
 ____VRQ17044920c7b8d5"  }
```

Copy

## Paso 6 (D): Respuesta final de 3DS

Dado que esta transacción se inició como una venta (Sale) o pre-autorización (Hold), la autorización se realiza como parte de este paso final si la autenticación fue completada.

Luego se recibirá la respuesta que debe ser evaluada con el campo IsoCode con el código de respuesta (00 es aprobada) y el campo ResponseMessage con la descripción del código de respuesta.

El siguiente documento JSON representa un ejemplo de una respuesta que recibe que indica que la autorización fue aprobada:

- < >

```
 {
      "AuthorizationCode":"OK0937" ,
      "AzulOrderId":"39597" ,
      "CustomOrderId":"" ,
      "DataVaultBrand":"" ,
      "DataVaultExpiration":"" ,
      "DataVaultToken":"" ,
      "DateTime":"20200316102920" ,
      "ErrorDescription":"" ,
      "IsoCode":"00" ,
      "LotNumber":"1" ,
      "RRN":"20200316103117592602" ,
      "ResponseCode":"ISO8583" ,
      "ResponseMessage":"APROBADA" ,
      "Ticket":"2"
     }
```

Copy

## Datos para pruebas

Estas son las tarjetas que se pueden utilizar en el ambiente de pruebas pruebas.azul.com.do:

- Fecha de vencimiento para todas las tarjetas = 12/2021 o cualquier fecha futura.
- CVV cualquier número de 3 dígitos, valor recomendado = 999.

| #   | Escenario                  | Tarjeta                |
| --- | -------------------------- | ---------------------- |
| 1   | Sin fricción con 3DSMethod | 4265\*8800\*0000\*0007 |
| 2   | Sin fricción sin 3DSMethod | 4147\*4630\*1111\*0117 |
| 3   | Desafío con 3DSMethod      | 4005\*5200\*0000\*0129 |
| 4   | Desafío sin 3DSMethod      | 4147\*4630\*1111\*0059 |

Tenga en cuenta que el propósito de las tarjetas de prueba 3DS es simular las respuestas de AUTENTICACIÓN, lo que significa que no garantizan automáticamente la aprobación AUTORIZACIÓN.

Las tarjetas de prueba solo deben usarse para el ESCENARIO DE AUTENTICACIÓN CASO DE PRUEBA que admiten, haciendo un mal uso de la tarjeta para cualquier otra autenticación las respuestas no proporcionarán el resultado esperado.

Para los casos de desafío, en el ambiente de prueba se presentará la siguiente ventana en la que se podrán simular las diferentes respuestas que se pueden recibir del ACS en este flujo

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/pic20220819143548.png)

| #   | Respuesta   | Descripción                                                                                                                                                                                                                                                                                  |
| --- | ----------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1   | Yes         | El emisor autenticó correctamente al tarjetahabiente, por lo que se procede a solicitar la autorización.                                                                                                                                                                                     |
| 2   | No          | No se pudo autenticar al tarjetahabiente. En este escenario no se solicita la autorización y al completar el proceso se recibirá el mensaje con el ISO code “99” y el error “Transaction declined. 3D Secure authentication failed.”                                                         |
| 3   | Attempt     | Se hace el intento de autenticar, pero el emisor o la tarjeta no participa en el programa por lo que la transacción es autenticada por la marca (Visa o Mastercard). El flujo continúa con la solicitud de la autorización.                                                                  |
| 4   | Rejected    | En este escenario el tarjetahabiente o el banco emisor decide no proceder con la autenticación. Se recibe el mensaje con el ISO code “99” y el error “Transaction declined. 3D Secure authentication failed.”                                                                                |
| 5   | Unavailable | Este escenario simula cuando el servidor ACS del emisor no está disponible o no puede completar la autenticación por problemas técnicos. En este escenario no se solicita la autorización y al completar el proceso se recibirá el mensaje con el ISO code “08” y el error “No autenticada”. |

## Soporte Técnico

Esta solución permite crear suscripciones para el servicio de recurrencia de manera automática sin tener que ingresar al portal AZUL para realizar este proceso.Sólo aplica para la creación de suscripciones. Se realiza una transacción de creación de recurrencia de acuerdo con los criterios deseados, en caso de que se requieran recurrencias diarias, semanales o mensuales se deberán utilizar diferentes campos.

# Plugins

## Magento V2.0

Manual de Instalación del plugin Magento para Página de Pagos

## Requisitos

Para este plugin se requiere lo siguiente:

- Magento v2
- Acceso a los archivos de Magento
- Acceso a ejecutar comando vía consola

## Instalación

A continuación, listamos los diferentes pasos para realizar la instalación del plugin en una página que posea Magento.

1\. Ubique la carpeta en la cual fue instalado Magento

2\. Dentro de la carpeta code copie la carpeta llamada CODIKA, en nuestro caso poseemos esta ruta.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture1-1669991364371.png)

3\. Luego de haber copiado la carpeta en la ruta correspondiente, a través de una consola se deberá de navegar a la carpeta en la que se instaló Magento y ejecutar los siguientes comandos:

- “php bin/magento setup:upgrade”: este comando representa la instalación de PHP
- “php bin/magento setup:di:compile”: compila el proyecto para que magento lo reconozca.
- “php bin/magento setup:static-content:deploy -f”: realiza el despliegue de magento en el sitio.
- “php bin/magento cache:clean”: limpia el almacenamiento cache de los elementos activos de magento.
- “php bin/magento cache:flush”: limpia el almacenamiento en cache para no consumir espacio innecesario en el disco.

Nota: “bin/magento” representa la carpeta donde está instalado Magento.

## Configuración

A continuación, listamos los diferentes pasos para configurar el plugin dentro de Magento v2.

1\. Dirigirnos a la opción de configuración (“Configuration”).

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture2-1669991597830.png)

2\. Dirigirse a la opción “SALES” y luego elegir la opción “Payment Methods”.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture3-1669991643736.png)

3\. Dirigirse a la opción “Azul” y configurar los parámetros a partir del dominio y las credenciales provistas por AZUL.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture4-1669991674289.png)

## Shopify

## Configuración Pasarela de Pagos

Integrar tu página de Shopify con la pasarela de pagos de AZUL, es muy fácil. En este manual te explicamos paso a paso todo lo que necesitas saber para iniciar tus ventas con tarjetas de una forma efectiva.

Recibirás 4 correos electrónicos que contienen lo siguiente:

- Correo #1: incluye un archivo adjunto con el link integrador, merchant ID y la primera parte de la llave de seguridad.
- Correo #2: incluye la clave para acceder al archivo adjunto del correo #1.
- Correo #3: incluye un archivo adjunto con la segunda parte de la llave de seguridad.
- Correo #4: incluye la clave para acceder al archivo adjunto del correo #3.

## Paso por paso

Pasos para integrar tu página de Shopify desde el link integrador.

1\. Ingresa al link integrador suministrado en el archivo adjunto del correo #1. Si utilizas el enlace, continuar con el paso 9.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture6-1669992449937.png)

2\. Ingresa tus credenciales de tu tienda Shopify: store address (dirección de tu página web), email address (correo electrónico) y password (contraseña).

3\. En tu panel de control de Shopify, ve a “Configuración > Pagos”

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture7-1669992526366.png)

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture9-1669992552182.png)

4\. En la ventana de “Pagos”, selecciona el botón “Agregar formas de pagos”.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture10-1669992579550.png)

5.Dentro de los proveedores, busca y selecciona la opción “AZUL”.

Nota: solo puedes tener habilitado un proveedor de pagos de tarjeta de crédito a la vez.

6\. Haz clic en “Activar”.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture11-1669992640701.png)

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture12-1669992658670.png)

7\. Se cargará otra pantalla. En este momento, haz clic en “Gestionar”.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture13-1669992683943.png)

8\. Serás re-direccionado a una pantalla para la configuración de las credenciales proporcionadas por AZUL.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture14-1669992707830.png)

9\. Luego, se presentará la pantalla de Shopify para confirmar la instalación. Debes presionar el botón de “Instalar aplicación no publicada”.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture15-1669992783906.png)

10\. En este momento serás redireccionado al Payment Page AZUL, donde deberás ingresar el Merchant\_ID y la llave de acceso privada que te facilitamos.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture16-1669992814596.png)

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture17-1669992831687.png)

11\. Una vez finalice el proceso de configuración la APP será instalado y deberás seleccionar los tipos de tarjeta que aceptarás en tu comercio. Luego, deberás presionar “Activar” para finalizar la integración.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture18-1669992856659.png)

## Pasos para realizar pruebas

1\. Para realizar una prueba, accede a la Tienda para realizar una compra del producto o servicio. Luego, elige “Checkout”, si estás en el AD, presiona el botón de ver el store:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture19-1669992908872.png)

2\. En el método de pago, selecciona “AZUL”. A partir de ahí, el flujo es igual que en el modelo de compras existente previamente con Shopify:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture20-1669992937578.png)

3\. Completa y finalizar la venta.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture21-1669992963488.png)

## WooCommerce

## Instalación del plugin

Instalación del plugin WooCommerce para Página de Pagos

## Métodos de instalación

1\. A través del gestor de plugins de Wordpress:

Haga click en el botón Subir plugin y seleccione el archivo pagina-pago-azul.zip

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture22-1669993318123.png)

Una vez instalado haga clic en el botón Activar plugin

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture23-1669993348810.png)

2\. Vía FTP:

Extraiga el archivo pagina-pago-azul.zip y suba el directorio pagina-pago-azul a la carpeta de plugins de wordpress /wp-content/plugins. A continuación diríjase al gestor de plugins para activar el plugin Página de Pago AZUL.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture24-1669993396161.png)

## Activación y configuración del método de pago

Una vez instalado y activado el plugin, deberá activar el nuevo método de pago en Woocommerce. Para ello diríjase a los ajustes de Woocommerce y seleccione la opción Pagos.

En el listado de métodos de pago, verá el nuevo plugin Página de Pago Azul. Actívelo y a continuación haga click en Gestionar.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture25-1669993714519.png)

Configure el plugin con los siguientes datos:

- Título: el nombre del método de pago, mostrado en la página checkout de woocommerce. (Por ejemplo: Pago con tarjeta de crédito).
- Descripción: descripción del método de pago mostrado en la página checkout de woocommerce.
- Slug de la página de pago: Usted deberá crear esta página posteriormente. El slug empleado en este campo deberá corresponderse con el de dicha página. (Recuerde que el slug no puede contener espacios en blanco, caracteres especiales o acentuados. Por ejemplo: página-de-pago).
- Mensaje de la pasarela de pago: Texto para indicar al cliente que será redirigido a la página de pago segura de AZUL.
- MerchantID: información proporcionada por la entidad bancaria. Estos parámetros serán diferentes para el ambiente de pruebas y ambiente de producción.
- AuthKey: información proporcionada por la entidad bancaria. Estos parámetros serán diferentes para el ambiente de pruebas y ambiente de producción.
- MerchantName: nombre del comercio.
- MerchantType: tipo de comercio. Se recomienda no utilizar tilde o caracteres especiales para no provocar un error.
- CurrencyCode: moneda para el pago en la página de pago segura de AZUL, proporcionada por la entidad bancaria.
- Tasa de cambio: en caso de que la moneda configurada en ajustes de Woocommerce sea diferente a la moneda especificada en CurrencyCode, ésta será la tasa de cambio empleada para hacer la conversión entre divisas.
- Operación conversión: especifica el tipo de operación a utilizar para realizar la conversión entre divisas en el caso de que utilice un CurrencyCode diferente a la moneda de pago configurada en ajustes de Woocommerce.
- ApprovedUrl: página a la que será redirigido el usuario tras completar el pago exitosamente. En el punto siguiente se indica cómo crear esta página. (Ejemplo: <https://mitienda.com.do/pago-aceptado>).
- DeclinedUrl: página a la que será redirigido el usuario tras completar el pago exitosamente. En el punto siguiente se indica cómo crear esta página. (Ejemplo: <https://mitienda.com.do/pago-declinado>).
- CancelUrl: página a la que será redirigido el usuario tras cancelar su pago. (Ejemplo: <https://mitienda.com.do/pago-cancelado>).
- URL PaymentPage: Url de la página de pago proporcionada por la entidad bancaria: [https://pagos.azul.com.do/PaymentPage/Default.aspx](https://pagos.azul.com.do/PaymentPage/Default.aspx)
- URL PaymentPage alternativa: Url de la página de pago alternativa, proporcionada por la entidad bancaria: [https://contpagos.azul.com.do/PaymentPage/Default.aspx](https://contpagos.azul.com.do/PaymentPage/Default.aspx)
- URL PaymentPage para entorno de pruebas: Url de la página de pago para pruebas, proporcionada por la entidad bancaria: [https://pruebas.azul.com.do/PaymentPage/](https://pruebas.azul.com.do/PaymentPage)
- Ambiente: Seleccione el entorno de Pruebas. Una vez verificado el funcionamiento en entorno de pruebas podrá pasar a modo real (Producción).
- Tipo de solicitud: Debe ser HTTP.
- PayPal: Active esta opción si desea permitir al usuario que realice el pago a través de PayPal en la página de pago segura de AZUL.
- Tasa de cambio: ya que PayPal únicamente acepta el pago en US$, ésta será la tasa a partir de la cual se realizará la conversión de divisas en caso de que la moneda establecida en sus ajustes de Woocomerce sea diferente al US$.
- Operación de conversión: especifica el tipo de operación a utilizar para realizar la conversión entre divisas en el caso de que la moneda de pago configurada en sus ajustes de Woocommerce sea diferente al US$.
- Confirmación de pago: Mostrar confirmación de pago en Payment Page. Si desactiva esta opción, la página de pago no mostrará confirmación y redirigirá al usuario a la tienda automáticamente tras completar el pago.
- DataVault: permite activar/desactivar la opción del sistema de recordar las tarjetas de crédito utilizadas por el usuario. Si esta opción esta activada, permitirá al usuario seleccionar alguna de sus tarjetas para agilizar el proceso de compra. Para la utilización del datavault por parte del usuario, éste deberá ser un usuario registrado. Por tanto, no funcionará si en su comercio electrónico se utiliza la compra como invitado. (Ver configuración recomendada para el uso de datavault).

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture26-1669994298520.png)

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture27-1669994408246.png)

## Creación de las páginas

Una vez configurados todos los parámetros del plugin Página de Pago AZUL deberá crear varias páginas. Para ello diríjase al menú Páginas de Wordpress y haga click en Añadir Nueva.

1) Página de pago: Indique el título de la página que desee, por ejemplo, Página de Pago e inserte en el contenido de ésta página el siguiente shortcode: \[azul\_payment\].

En el campo Slug de la página de pago coloque: página-de-pago

Asegúrese de que el slug generado al guardar la página se corresponde con el indicado como tercer parámetro en la configuración del plugin. En caso contrario, edítelo.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture28-1669994499279.png)

2) Página tras pago exitoso (ApprovedUrl): Cree una nueva página a la que el usuario será redirigido tras completar el pago, asegurándose de que la url final sea la especificada en el parámetro ApprovedUrl de configuración del plugin.

Inserte en el contenido de ésta página el siguiente shortcode: \[azul\_response\]

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture29-1669994532871.png)

3) Página tras pago declinado (DeclinedUrl): Cree una nueva página a la que el usuario será redirigido si su pago es declinado, asegurándose de que la url final sea la especificada en el parámetro DeclinedUrl de configuración del plugin.

Inserte en el contenido de ésta página el mismo shortcode anterior: \[azul\_response\]

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture30-1669994568850.png)

4) Por último, cree la página tras pago cancelado (CancelUrl). Asegurándose de que la url final sea la especificada en el parámetro CancelUrl de configuración del plugin. En éste caso no es necesario que inserte ningún shortcode. Simplemente escriba un mensaje en el que especifique al usuario que su pago has sido cancelado.

Al instalar WooCommerce, éste crea una serie de páginas (Página de carrito, Página de pago, Página de mi cuenta, etc…) Estas páginas pueden verse desde WooCommerce – Ajustes – Avanzado.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture31-1669994603303.png)

En concreto, ésta Página de Pago creada por WoocCommerce NO DEBE CONFUNDIRSE con la página de pago de AZUL.

En el listado de páginas, usted debe tener una Página de Pago identificada como tal. Esa es la página de pago creada por WooCommerce y su único contenido debe ser el shortcode: \[woocommerce\_checkout\]

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture32-1669994655352.png)

Independientemente de esa página, y tal como se explica en el documento de instalación y configuración del plugin, usted debe crear una página adicional utilizada como página de pago de AZUL y cuyo contenido será el shortcode: \[azul\_payment\]

Es el slug de ésta última página el que debe establecer en la configuración del plugin.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture33-1669994684740.png)

## Configuración recomendada para el uso de datavault

Puesto que para el uso del datavault por parte del usuario, éste debe ser un usuario registrado, recomendamos desactivar en la configuración de su tienda la compra como invitado. A continuación, se muestra la configuración recomendada para dicho fin, a la que podrá acceder desde el menú Woocommerce – Ajustes – Cuentas y privacidad

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture34-1669994723053.png)

## Nota final

Para el correcto funcionamiento del plugin es necesario que verifique la estructura de los enlaces de su sitio web. Para esto diríjase al menú Ajustes – Enlaces permanentes y seleccione la opción “Nombre de la página” en caso de no tenerla ya activada.

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Picture35-1669994758422.png)

# Recurrencia de Pagos

## Recurrencia de Pagos

Esta solución permite crear suscripciones para el servicio de recurrencia de manera automática sin tener que ingresar al portal AZUL para realizar este proceso.

Sólo aplica para la creación de suscripciones.

Se realiza una transacción de creación de recurrencia de acuerdo con los criterios deseados, en caso de que se requieran recurrencias diarias, semanales o mensuales se deberán utilizar diferentes campos.

## Endpoints o URLs

Endpoints o URLs

Desarrollo

- [http://pruebas.azul.com.do /WebServices/JSON/default.aspx?recurringsubscriptioncreate](http://pruebas.azul.com.do/WebServices/JSON/default.aspx?recurringsubscriptioncreate)

Producción

- [http://pagos.azul.com.do /WebServices/JSON/default.aspx?recurringsubscriptioncreate](<http://pagos.azul.com.do> /WebServices/JSON/default.aspx?recurringsubscriptioncreate )
- [http://contpagos.azul.com.do /WebServices/JSON/default.aspx?recurringsubscriptioncreate](<http://contpagos.azul.com.do> /WebServices/JSON/default.aspx?recurringsubscriptioncreate )

## Requerimientos de Entrada

| Transacción de venta       |
| -------------------------- |
| Parámetros de Entrada      |
| ---                        |
| Parámetro                  | Tipo Dato | Descripción Observación                                                                                                                                                                                                                                                                                                   | Obligatorio |
| ---                        | ---       | ---                                                                                                                                                                                                                                                                                                                       | ---         |
| Channel                    | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                          | Si          |
| Store                      | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                                                                                                                                            | Si          |
| CardNumber                 | N(19)     | Número de tarjeta a la cual se le ha de cargar la transacción. La longitud del campo se determina por la tarjeta, no se debe rellenar con ceros (0), espacios, ni caracteres especiales                                                                                                                                   | Si          |
| Expiration                 | N(6)      | Fecha expiración/vencimiento de la tarjeta Formato YYYYMM Ej.: 201502                                                                                                                                                                                                                                                     | Si          |
| CVC                        | N(3)      | Código de seguridad de la tarjeta (CVV2 o CVC).                                                                                                                                                                                                                                                                           | Si          |
| Amount                     | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21                                                                                                                            | Si          |
| MaxRepeats                 | A(10)     | Cantidad máxima de recurrencias a ser procesadas. Ej, puedes colocar una recurrencia mensual sin fecha de fin e indicar aquí que se procesen máximo 12 ocurrencias.                                                                                                                                                       | Si          |
| Frequency                  | N(16)     | Frecuencia con la que se desea procesar la suscripcion.                                                                                                                                                                                                                                                                   | Si          |
| FrequencyParamEveryXDays   | N(12)     | Cada cuanto día se desea procesar la suscripción.                                                                                                                                                                                                                                                                         | Si          |
| FrequencyParamEveryXWeeks  | N(12)     | Cada cuanta semana se desea procesar la suscripción                                                                                                                                                                                                                                                                       | No          |
| FrequencyParamWeekdays     | N(12)     | Dia de la semana en que se desea procesar la suscripcion                                                                                                                                                                                                                                                                  | No          |
| FrequencyParamEveryXMonths | X(1)      | Cada cuanto mes se desea procesar la suscripcion                                                                                                                                                                                                                                                                          | No          |
| FrequencyParamEveryXYears  | X(32)     | Cada cuanto años se desea procesar la suscripcion                                                                                                                                                                                                                                                                         | No          |
| FrequencyParamDay          | x(32)     | Dia del mes en que se desea procesar la suscripcion                                                                                                                                                                                                                                                                       | No          |
| FrequencyParamMonth        | X(32)     | Mes del año en que se desea procesar la suscripcion                                                                                                                                                                                                                                                                       | No          |
| CustomerSubscriptionId     | A(100)    | Valor del token generado por AZUL. Para las transacciones de venta con token, no se deben enviar los valores de CardNumber y Expiration. El envío de CVC si es E-Commerce puede ser o no mandatorio depende de lo acordado con su representante de Negocios de Azul. Si es MOTO la transacción, no se debería enviar CVC. | No          |
| SaveToDataVault            | N(1)      | Valores posibles 1 = Si, 0 = No.Si se manda el valor en 1, Azul devolverá el token generado para la tarjeta en el campo DataVaultToken. Si se manda el valor en 0, Azul no genera Token.                                                                                                                                  | Si          |

## Recurrencia Diaria

- < >

```
 {
      "Store" :  "39038540027" ,
      "Amount" : 50.00,
      "Itbis" : 1,
      "Currency" :  "DOP" ,
      "MaxRepeats" : null,
      "Frequency" :  "Daily" ,
      "FrequencyParamEveryXDays" :  "2" ,
      "FrequencyParamEveryXWeeks" :  "" ,
      "FrequencyParamWeekdays" :  "" ,
      "FrequencyParamEveryXMonths" :  "" ,
      "FrequencyParamEveryXYears" :  "" ,
      "FrequencyParamDay" :  "" ,
      "FrequencyParamMonth" :  "7" ,
      "CustomerSubscriptionId" :  "003" ,
      "CustomerName" :  "Prueba" ,
      "CustomerContract" :  "WEB1232234" ,
      "CustomerIdentType" :  "Cedula" ,
      "CustomerIdentNum" :  "00100204566" ,
      "CustomerEmail" :  "" ,
      "CustomerEmailNotificationsTrx" : false,
      "CustomerEmailNotificationsExpired" : false,
      "CustomerEmailNotificationsNearExpired" : false,
      "CustomerEmailNotificationsPhone" : false,
      "CustomerEmailNotificationsPhoneNumber" :  "" ,
      "Description" :  "" ,
      "StartDate" :  "2022-7-27" ,
      "EndDate" :  "" ,
      "CardNumber" :  "5426xxxxxxxxxxx979" ,
      "CardExpiration" :  "12\/25" ,
      "Card2Number" : null,
      "Card2Expiration" : null,
      "Card3Number" : null,
      "Card3Expiration" : null

 }

```

Copy

## Respuesta Recurrencia Diaria

- < >

```
 {
      "CustomSubscriptionId":"002" ,
      "ErrorDescription" :  "" ,
      "NextScheduledDate":"2022-07-27" ,
      "ResponseCode" :  "CREATED" ,
 }

```

Copy

## JSON: Recurrencia Semanal

- < >

```
 {
          "Store" :  "39038540027" ,
      "Amount" : 123.00,
      "Itbis" : 1,
      "Currency" :  "DOP" ,
      "MaxRepeats" : null,
      "Frequency" :  "Weekly" ,
      "FrequencyParamEveryXDays" :  "" ,
      "FrequencyParamEveryXWeeks" :  "1" ,
      "FrequencyParamWeekdays" :  "3" ,
      "FrequencyParamEveryXMonths" :  "7" ,
      "FrequencyParamEveryXYears" :  "" ,
      "FrequencyParamDay" :  "1" ,
      "FrequencyParamMonth" :  "7" ,
      "CustomerSubscriptionId" :  "a12323ss3s432" ,
      "CustomerName" : "Prueba Semanal",
      "CustomerContract" :  "WEB1232234" ,
      "CustomerIdentType" :  "Cedula" ,
      "CustomerIdentNum" :  "00100208665" ,
      "CustomerEmail" :  "" ,
      "CustomerEmailNotificationsTrx" : false,
      "CustomerEmailNotificationsExpired" : false,
      "CustomerEmailNotificationsNearExpired" : false,
      "CustomerEmailNotificationsPhone" : false,
      "CustomerEmailNotificationsPhoneNumber" :  "" ,
      "Description" :  "" ,
      "StartDate" :  "2023-1-1" ,
      "EndDate" :  "" ,
      "CardNumber" :  "5426xxxxxxxxxxx979" ,
      "CardExpiration" :  "12\/25" ,
      "Card2Number" : null,
      "Card2Expiration" : null,
      "Card3Number" : null,
      "Card3Expiration" : null
 }

```

Copy

## Respuesta Recurrencia Semanal

- < >

```

  {
      "CustomSubscriptionId":"002" ,
      "ErrorDescription" :  "" ,
      "NextScheduledDate":"2022-07-27" ,
      "ResponseCode" :  "CREATED" ,
   }

```

Copy

## JSON: Recurrencia Mensual

- < >

```
 {
      "Store" :  "39038540027" ,
      "Amount" : 50.00,
      "Itbis" : 1,
      "Currency" :  "DOP" ,
      "MaxRepeats" : null,
      "Frequency" :  "MonthlyByDay" ,
      "FrequencyParamEveryXDays" :  "" ,
      "FrequencyParamEveryXWeeks" :  "" ,
      "FrequencyParamWeekdays" :  "" ,
      "FrequencyParamEveryXMonths" :  "1" ,
      "FrequencyParamEveryXYears" :  "" ,
      "FrequencyParamDay" :  "27" ,
      "FrequencyParamMonth" :  "7" ,
      "CustomerSubscriptionId" :  "002" ,
      "CustomerName" : "Prueba WEB",
      "CustomerContract" :  "WEB2234" ,
      "CustomerIdentType" :  "Cedula" ,
      "CustomerIdentNum" :  "00144204566" ,
      "CustomerEmail" :  "" ,
      "CustomerEmailNotificationsTrx" : false,
      "CustomerEmailNotificationsExpired" : false,
      "CustomerEmailNotificationsNearExpired" : false,
      "CustomerEmailNotificationsPhone" : false,
      "CustomerEmailNotificationsPhoneNumber" :  "" ,
      "Description" :  "" ,
      "StartDate" :  "2022-7-27" ,
      "EndDate" :  "" ,
      "CardNumber" :  "5426xxxxxxxxxxx979" ,
      "CardExpiration" :  "12\/25" ,
      "Card2Number" : null,
      "Card2Expiration" : null,
      "Card3Number" : null,
      "Card3Expiration" : null
 }
```

Copy

## Respuesta Recurrencia Mensual

- < >

```
 {
      "CustomSubscriptionId":"002" ,
      "ErrorDescription" :  "" ,
      "NextScheduledDate":"2022-07-27" ,
      "ResponseCode" :  "CREATED" ,
 }


```

Copy

# Captura Múltiple

## Split Shipment or Multiple Partial Capture

Esta función que permite realizar una autorización (HOLD), permitiendo realizar varias capturas (posteos) a una misma autorización.

Se puede separar la autorización del posteo o captura en dos mensajes distintos:

- 1\. Hold: pre-autorización y reserva de los fondos en la tarjeta del cliente.
- 2\. Post: se hace la captura o el “posteo” de la transacción. (Ver metódo ProcessPost).

Al utilizar el Hold y Post se deben considerar los siguientes puntos:

- Para evitar que el banco emisor elimine la pre-autorización, el Post debe ser realizado antes de 7 días de haber hecho el Hold.
- Luego de realizado el Hold, el comercio no va a recibir la liquidación de los fondos hasta que someta el Post.
- El Post puede ser igual o menor al monto original.

## Método Hold

Ejemplo Mensaje de Requerimiento para el HOLD:

Desarrollo

- [https://pruebas.azul.com.do/WebServices/JSON/Default.aspx](https://pruebas.azul.com.do/WebServices/JSON/Default.aspx)

Producción

- [https://pagos.azul.com.do/WebServices/JSON/Default.aspx](https://pagos.azul.com.do/WebServices/JSON/Default.aspx)
- [https://contpagos.azul.com.do/WebServices/JSON/Default.aspx](https://contpagos.azul.com.do/WebServices/JSON/Default.aspx)

## Requerimiento Hold

| Párametros de Entrada: Captura Múltiple |
| --------------------------------------- |
| Parámetro                               | Tipo Dato | Descripción Observación                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Obligatorio |
| ---                                     | ---       | ---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | ---         |
| Channel                                 | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                               | Si          |
| Store                                   | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Si          |
| CardNumber                              | N(19)     | Número de tarjeta a la cual se le ha de cargar la transacción. La longitud del campo se determina por la tarjeta, no se debe rellenar con ceros (0), espacios, ni caracteres especiales                                                                                                                                                                                                                                                                                                                                                        | Si          |
| Expiration                              | N(6)      | Fecha expiración/vencimiento de la tarjeta Formato YYYYMM Ej.: 201502                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Si          |
| CVC                                     | N(3)      | Código de seguridad de la tarjeta (CVV2 o CVC).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Si          |
| PosInputMode                            | A(10)     | Modo de ingreso.Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                              | Si          |
| TrxType                                 | A(16)     | Valor Fijo: Hold (Este valor es case sensitive)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Si          |
| Amount                                  | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21                                                                                                                                                                                                                                                                                                                                                 | Si          |
| ITBIS                                   | N(12)     | Valor del ITBIS. Mismo formato que el campo Amount. El valor enviado en el campo de ITBIS no se carga como un monto adicional en la transacción. En el campo de Amount debe enviarse total a cargar incluyendo el ITBIS.<br>Si la transacción o el negocio están exentos, se envía en cero colocando el valo “000”.<br>Este valor deberá también ser incluido en el cálculo del hash.                                                                                                                                                          | Si          |
| OrderNumber                             | X(15)     | Número de orden asociado a la transacción. Puede viajar nulo, pero siempre debe de estar presente.                                                                                                                                                                                                                                                                                                                                                                                                                                             | Si          |
| AcquirerRefData                         | N(1)      | Uso Interno AZUL Valor Fijo: 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | No          |
| CustomerServicePhone                    | X(32)     | Número de servicio para atención telefónica del establecimiento. Ej.: 8095442985                                                                                                                                                                                                                                                                                                                                                                                                                                                               | No          |
| ECommerceURL                            | X(32)     | Dirección web del afiliado                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | No          |
| CustomOrderId                           | X(75)     | Numero Identificador dada por el afiliado a la transacción. Este campo debe ser enviado si se desea implementar el método de VerifyPayment.                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| AltMerchantName                         | X(30)     | Campo que permite al Comercio colocar un nombre más descriptivo para que el tarjetahabiente pueda identificarle en su estado de cuenta. Se sugiere siempre colocar su nombre comercial adecuadamente a fin de evitar disputas. Si lo desea, puede agregar a su nombre algún indicador único de orden. El campo solo acepta un máximo de 25 caracteres. No utilizar los siguientes caracteres especiales: <br>“ Genera un error en el request. <br>\ Genera un error en el request. <br>' Este carácter no se muestra en el mensaje del emisor. | No          |
| DataVaultToken                          | A(100)    | Valor del token generado por SDP en caso de que se desee realizar una transacción con dicho token. Si se manda el valor de esto, no se deben enviar los valores de CardNumber, Expiration. El envío de CVC si es ecommerce puede ser o no mandatorio depende de lo conversado con Negocios SDP. Si es MOTO la transacción, no se debería enviar CVC.                                                                                                                                                                                           | No          |
| SaveToDataVault                         | N(1)      | Valores posibles 1 = si, 2 = no. Si se manda este valor en 1, SDP le devolverá el token generado en el campo DataVaultToken                                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| SaveToDataVault                         | N(1)      | Valores posibles 1 = si, 2 = no. Si se manda este valor en 1, SDP le devolverá el token generado en el campo DataVaultToken                                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| ForceNo3DS                              | N(1)      | Valores posibles 0 =no, 1 = Si. Si se envía el valor en ‘0’, la transacción se procesa con 3D Secure. Si se envía el valor en ‘1’ la transacción se procesa sin 3D Secure.                                                                                                                                                                                                                                                                                                                                                                     | No          |
| SequenceCount                           | N(X)      | Número de veces máxima que se va a postear la autorización, el ultimo posteo debe enviar el “FinalShipment” con el valor 1.                                                                                                                                                                                                                                                                                                                                                                                                                    | Si          |
| FinalShipment                           | N(1)      | Valores posibles 1 = si, 0 = no. Indica si es el último posteo que se va a efectuar en la autorización.                                                                                                                                                                                                                                                                                                                                                                                                                                        | No          |

## Ejemplo JSON Requerimiento

Ejemplo Mensaje de Requerimiento para el HOLD: Captura Múltiple

- < >

```
 {
  "Channel":"EC",
 "Store":"99999991",
 "CardNumber":"999999******9999",
 "Expiration":"201412",
 "CVC":"1234",
 "PosInputMode":"E-Commerce",
 "TrxType":"Hold",
 "Amount":"10000",
 "Itbis":"00",
 "CurrencyPosCode":"$",
 "Payments":"1",
 "Plan":"0",
 "OriginalDate":"",
 "OriginalTrxTicketNr":"",
 "AuthorizationCode":"",
 "ResponseCode":"",
 "AcquirerRefData":"1",
 "RRN":null,
 "AzulOrderId":null,
 "CustomerServicePhone":"",
 "OrderNumber":"",
 "ECommerceUrl":"",
 "CustomOrderId":"",
 "DataVaultToken":"",
 "ForceNo3DS":"1",
 "SaveToDataVault":"0",
 "SequenceCount" :  "2",
 "FinalShipment":"0"
 }
```

Copy

## Ejemplo Respuesta Aprobada

Ejemplo Mensaje de Respuesta para el HOLD: Captura Múltiple

- < >

```
 { "AuthorizationCode":"OK3360","AzulOrderId":"247477","CustomOrderId":"","DateTime":"20180926182939","ErrorDescription":
 "","IsoCode":"00","LotNumber":"","RRN":"20180926182942896982","ResponseCode":"ISO8583","ResponseMessage":"APROBADA","  Ticket ":"18" }

```

Copy

## Ejemplo Respuesta Declinada

Ejemplo Mensaje de Respuesta para el HOLD: Captura Múltiple

- < >

```
 { "AuthorizationCode":"","AzulOrderId":"247478","CustomOrderId":"","DateTime":"20180926183031","ErrorDescription":" SGS-
 002303: Invalid credit card
 number ","IsoCode":"99","LotNumber":"","RRN":"","ResponseCode":"ISO8583","ResponseMessage":" Tarjeta Invalida ","Ticket":"" }

```

Copy

## Ejemplo Respuesta Error

Ejemplo Mensaje de Respuesta para el HOLD: Captura Múltiple

- < >

```
 { "AuthorizationCode":"","AzulOrderId":"","CustomOrderId":"","DataVaultBrand":"","DataVaultExpiration":""," DataVaultTo ken ":"","DateTime":"20180926183054","ErrorDescription":"VALIDATION_ERROR:Amount","IsoCode":"","LotNumber":"","RRN":""  , "ResponseCode":"Error","ResponseMessage":"","Ticket":"" }
```

Copy

# Cuotas

## Cuotas

Esta función permite realizar las ventas (Sale) con la opción de pago a cuotas.

Sólo aplica para Webservices AZUL.

Flujo de Cuotas en mobile:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/Cuotas%20mobile.png)

## Endpoints o URLs

Endpoints o URLs

Desarrollo

- [https://pruebas.azul.com.do/WebServices/JSON/Default.aspx](https://pruebas.azul.com.do/WebServices/JSON/Default.aspx)

Producción

- [https://pagos.azul.com.do/WebServices/JSON/Default.aspx](https://pagos.azul.com.do/WebServices/JSON/Default.aspx)
- [https://contpagos.azul.com.do/WebServices/JSON/Default.aspx](https://contpagos.azul.com.do/WebServices/JSON/Default.aspx)

## Requerimientos Cuotas

| Parámetro            | Tipo Dato | Descripción Observación                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Obligatorio |
| -------------------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------- |
| Channel              | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                               | Si          |
| Store                | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Si          |
| CardNumber           | N(19)     | Número de tarjeta a la cual se le ha de cargar la transacción. La longitud del campo se determina por la tarjeta, no se debe rellenar con ceros (0), espacios, ni caracteres especiales                                                                                                                                                                                                                                                                                                                                                        | Si          |
| Expiration           | N(6)      | Fecha expiración/vencimiento de la tarjeta Formato YYYYMM Ej.: 201502                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Si          |
| CVC                  | N(3)      | Código de seguridad de la tarjeta (CVV2 o CVC).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Si          |
| PosInputMode         | A(10)     | Modo de ingreso.Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                              | Si          |
| TrxType              | A(16)     | Valor Fijo: Sale (Este valor es case sensitive)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Si          |
| Amount               | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21                                                                                                                                                                                                                                                                                                                                                 | Si          |
| ITBIS                | N(12)     | Valor del ITBIS. Mismo formato que el campo Amount. El valor enviado en el campo de ITBIS no se carga como un monto adicional en la transacción. En el campo de Amount debe enviarse total a cargar incluyendo el ITBIS.<br>Si la transacción o el negocio están exentos, se envía en cero colocando el valo “000”.<br>Este valor deberá también ser incluido en el cálculo del hash.                                                                                                                                                          | Si          |
| OrderNumber          | X(15)     | Número de orden asociado a la transacción. Puede viajar nulo, pero siempre debe de estar presente.                                                                                                                                                                                                                                                                                                                                                                                                                                             | Si          |
| AcquirerRefData      | N(1)      | Uso Interno AZUL Valor Fijo: 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | No          |
| CustomerServicePhone | X(32)     | Número de servicio para atención telefónica del establecimiento. Ej.: 8095442985                                                                                                                                                                                                                                                                                                                                                                                                                                                               | No          |
| ECommerceURL         | X(32)     | Dirección web del afiliado                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | No          |
| CustomOrderId        | X(75)     | Numero Identificador dada por el afiliado a la transacción. Este campo debe ser enviado si se desea implementar el método de VerifyPayment.                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| AltMerchantName      | X(30)     | Campo que permite al Comercio colocar un nombre más descriptivo para que el tarjetahabiente pueda identificarle en su estado de cuenta. Se sugiere siempre colocar su nombre comercial adecuadamente a fin de evitar disputas. Si lo desea, puede agregar a su nombre algún indicador único de orden. El campo solo acepta un máximo de 25 caracteres. No utilizar los siguientes caracteres especiales: <br>“ Genera un error en el request. <br>\ Genera un error en el request. <br>' Este carácter no se muestra en el mensaje del emisor. | No          |
| DataVaultToken       | A(100)    | Valor del token generado por SDP en caso de que se desee realizar una transacción con dicho token. Si se manda el valor de esto, no se deben enviar los valores de CardNumber, Expiration. El envío de CVC si es ecommerce puede ser o no mandatorio depende de lo conversado con Negocios SDP. Si es MOTO la transacción, no se debería enviar CVC.                                                                                                                                                                                           | No          |
| SaveToDataVault      | N(1)      | Valores posibles 1 = si, 2 = no. Si se manda este valor en 1, SDP le devolverá el token generado en el campo DataVaultToken                                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| SaveToDataVault      | N(1)      | Valores posibles 1 = si, 2 = no. Si se manda este valor en 1, SDP le devolverá el token generado en el campo DataVaultToken                                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| ForceNo3DS           | N(1)      | Valores posibles 0 =no, 1 = Si. Si se envía el valor en ‘0’, la transacción se procesa con 3D Secure. Si se envía el valor en ‘1’ la transacción se procesa sin 3D Secure.                                                                                                                                                                                                                                                                                                                                                                     | No          |
| NumberOfInstallments | N(99)     | Cantidad de cuotas en la cual la transacción será dividida. Dicho valor debe ser igual o superior a (1).                                                                                                                                                                                                                                                                                                                                                                                                                                       | Si          |
| InstallmentsInterest | N(2)      | Indica si se aplicara intereses a las cuotas que se le establezcan al tarjetahabiente. Actualmente solo acepta el valor “No”.                                                                                                                                                                                                                                                                                                                                                                                                                  | Si          |

Consulta en Backoffice AZUL:

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/CuotasPic1.png)

## Ejemplo Cuotas Request JSON

- < >

```
 {
  "Channel" :  "EC" ,     "Store" :  "39038540035" ,     "CardNumber" :  "459413***00540***02620" ,
      "Expiration" :  "202412" ,
      "CVC" :  "979" ,
      "PosInputMode" :  "E-Commerce" ,
      "TrxType" :  "Sale" ,
      "Amount" :  "5000" ,
      "Itbis" :  "000" ,
      "CurrencyPosCode" :  "$" ,
      "Payments" :  "1" ,
      "Plan" :  "0" ,
      "OriginalDate" :  "" ,
      "AcquirerRefData" :  "1" ,
      "CustomerServicePhone" :  "" ,
      "OrderNumber" :  "12345" ,
      "ECommerceUrl" :  " www. Prueba.com" ,
      "CustomOrderId" :  "2a3b4d" ,
      "DataVaultToken" :  "" ,
      "SaveToDataVault" :  "0" ,
      "ForceNo3DS" :  "1" ,
      "AltMerchantName":" codigo prueba: 2s5j",
      "NumberOfInstallments":"2" ,
      "InstallmentsInterest":"no" }
```

Copy

## Ejemplo Cuotas Response JSON

- < >

```
 { "AuthorizationCode":"OK4789","AzulOrderId":"44206345","CustomOrderId":"2a3b4d","DateTime":"20220812160549","ErrorDescription":"",
 "IsoCode":"00","LotNumber":"","RRN":"2022081216055244206345","ResponseCode":"ISO8583","ResponseMessage":"APROBADA","Ticket":"1" }
```

Copy

# DCC

## DCC - Conversión Dinámica de Monedas

La conversión dinámica de moneda (DCC) brinda a los tarjetahabientes del extranjero la opción de pagar en la moneda local o en su propia moneda.

Flujo DCC en mobile

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/DCC%20mobile.png)

Notas:

- Actualmente sólo aplica para ventas. En caso de requerir anulación o devolución se aplica automáticamente la tasa original de la venta.
- Compatible con Bóveda de Datos (DataVault)
- Actualmente no aplica para transacciones con 3D-Secure. Estará disponible en una próxima actualización.
- Es necesario solicitar la activación de este servicio.

## Requerimientos de las Marcas sobre DCC

En caso de que la transacción aplique para conversión de moneda, antes de enviar la solicitud de autorización se debe presentar al titular de la tarjeta una pantalla para seleccionar la moneda con la que desea pagar, en la que se le debe informar lo siguiente:

Notas:

- Su derecho a elegir la moneda en la que se completará la transacción;
- Monto original de la transacción en la moneda de facturación del comercio;
- Monto convertido en la moneda de facturación de la tarjeta. Este es el valor del campo ForeignAmount
- La tasa de conversión de moneda que se aplicará si la transacción se completa en la moneda de facturación; Valor del campo ExchangeRate.
- El margen por el servicio de conversión de moneda que se cobrará si el titular de la tarjeta selecciona DCC. Este es el valor del campo MarginRatePercentage.
- Mastercard exige que se muestre el siguiente texto verbatim:“MAKE SURE YOU UNDERSTAND THE COSTS OF CURRENCY CONVERSION AS THEY MAY BE DIFFERENT DEPENDING ON WHETHER YOU SELECT YOUR HOME CURRENCY OR THE TRANSACTION CURRENCY.”

En la pantalla de selección de moneda se deben cumplir los siguientes lineamientos

- De ninguna manera se debe exigir, alentar o influir al titular de la tarjeta para que elija la moneda convertida con DCC;
- Se debe presentar la oferta de manera clara y neutral;
- Todos los mensajes en pantalla deben ser claros y completos, en inglés o en el idioma nativo del titular de la tarjeta, para evitar las barreras del idioma y ayudar a garantizar que el titular de la tarjeta comprenda la oferta.
- Al finalizar la transacción, el recibo debe contener un registro de los detalles de la conversión.
- La redacción de la oferta de DCC no debe utilizar lenguaje o formato confuso o sesgado.
- No se debe pedir al titular de la tarjeta que seleccione “sí“ o “no“, “aceptar“ o “rechazar“, “continuar“ o “cancelar“, o pares similares de opciones positivas y negativas.
- La oferta no debe señalar a DCC como la única opción ni formularse como una pregunta de sí o no.
- La selección de moneda no debe usar patrones de color de “semáforo“, como botones rojos y verdes.
- No se debe usar lenguaje que tergiverse o pueda sacar conclusiones falsas sobre el proceso de conversión del emisor, como implicar que la conversión del emisor agregará tarifas o cargos de conversión inesperados, o de otra manera.
- DCC no debe presentarse como la opción más favorable.

Lineamientos para Transacciones recurrentes

- El servicio DCC es permitido para la recurrencia de pagos, sin embargo, antes de procesar transacciones recurrentes con DCC, el comercio debe asegurarse de lo siguiente:
- 1\. El tarjetahabiente aceptó pagar con DCC al registrarse en el momento de la primera transacción.
- 2\. El tarjetahabiente puede optar por rechazar DCC en cualquier momento para transacciones futuras.

Nota Final:

- La información relacionada con DCC en el recibo debe presentarse en inglés o en un idioma que el titular de la tarjeta pueda entender.
- Se debe proporcionar al tarjetahabiente la misma información divulgada en la factura o recibo de transacción de DCC.
- El recibo de la transacción no debe incluir declaraciones que induzcan a error o confundan al titular de la tarjeta. Por ejemplo, la declaración “No se han aplicado comisiones ni tarifas adicionales“.

2 Ejemplo de Factura o Recibo de Transacción Aprobada realizada con DCC

![](https://dev.azul.com.do/Pages/developer/pages/lib/assets/images/facturaaprobadadcc.png)

## Método ProcessDccRateInquiry (Consulta de Tasa)

Método para la gestión de la tasa. Una vez que el usuario ingresa el número de tarjeta en la página de pago de la interfaz de usuario del comercio, se debe activar este método para verificar si aplica para DCC y proporcionar las tasas de cambio y monto convertido si aplica.

## Consulta de Tasa (DCCRateID)

| Párametros de Entrada |
| --------------------- |
| Parámetro             | Tipo Dato | Descripción Observación                                                                                                                                                                        | Obligatorio |
| ---                   | ---       | ---                                                                                                                                                                                            | ---         |
| Channel               | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                               | Si          |
| Store                 | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                 | Si          |
| BIN                   | N(8)      | El número de identificación bancaria de la tarjeta de crédito (Es posible utilizar los primeros 8 dígitos del número de la tarjeta de crédito).                                                | Si          |
| Amount                | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21 | Si          |

## Resultado Consulta de Tasa (DCCRateID)

| Párametros de Salida     |
| ------------------------ |
| Parámetro                | Tipo Dato | Descripción Observación                                                                                                                                                                                                                      | Obligatorio |
| ---                      | ---       | ---                                                                                                                                                                                                                                          | ---         |
| InquiryRateId            | N(X)      | Numeración generada para identificar los detalles de la tasa ofrecida. El InquiryRateId deberá ser enviado en el próximo paso en del método de venta en el campo DCCRateId. Tenga en cuenta que un InquiryRateId sólo se puede usar una vez. | Si          |
| DccOffered               | N(1)      | Indica si esta tarjeta aplica para la conversión dinámica de divisas (DCC). Valores posibles 0 = No aplica , 1 = Aplica                                                                                                                      | Si          |
| ExchangeRate             |           | El tipo de cambio de la conversión de moneda. Ej. 00190 equivale a 0.0190 Ej. 00257 equivale a 0.0257                                                                                                                                        | Si          |
| ExpirationTimestamp      |           | Marca de tiempo después de la cual caduca esta oferta de DCC. Ej. 20230705130007. 2023-07-05 13:00:07 Fecha, Hora (HH,MM,SS)                                                                                                                 | Si          |
| ForeignAmount            |           | Monto convertido a la moneda extranjera Ej. 230 equivale a 0.230 Ej. 044 equivale a 0.44                                                                                                                                                     | Si          |
| ForeignCurrencyCode      |           | Código de moneda extranjera                                                                                                                                                                                                                  | Si          |
| ForeignCurrencyCodeAlpha |           | Siglas o código ISO del nombre de la moneda extranjera.                                                                                                                                                                                      | Si          |
| MarginRatePercentage     |           | Información de margen de conversión de moneda.                                                                                                                                                                                               | Si          |

## DCC Endpoints o URLs

Endpoints o URLs

Desarrollo

- [https://pruebas.azul.com.do/WebServices/JSON/Default.aspx? ProcessDccRateInquiry](https://pruebas.azul.com.do/WebServices/JSON/Default.aspx?%20ProcessDccRateInquiry)

Producción

- [https://pagos.azul.com.do/WebServices/JSON/Default.aspx? processdccrateinquiry](https://pagos.azul.com.do/WebServices/JSON/Default.aspx?%20processdccrateinquiry)
- [https://contpagos.azul.com.do/WebServices/JSON/Default.aspx? processdccrateinquiry](https://contpagos.azul.com.do/WebServices/JSON/Default.aspx?%20processdccrateinquiry)

## Ejemplo Request JSON

- < >

```
 {
  "Channel":"EC" ,
   "Store":"9999999999" ,
   "BIN":"414746" ,
   "DataVaultToken":"" ,
   "Amount":"1700"
    }
```

Copy

## Ejemplo Response JSON

- < >

```
 {  "DCCResult":
 {
 "DccOffered":"1",
 "ExchangeRate":"00257",
 "ExpirationTimestamp":"20230613130008",
 "ForeignAmount":"044",
 “ForeignCurrencyCode”:”702”,
 "ForeignCurrencyCodeAlpha":"SGD",
 "InquiryRateId":"81341484",
 "MarginRatePercentage":"400"
 },

 "ErrorDescription":"","IsoCode":"00"
 }
```

Copy

## Requerimientos DCC

| Párametros de Entrada |
| --------------------- |
| Parámetro             | Tipo Dato | Descripción Observación                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Obligatorio |
| ---                   | ---       | ---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | ---         |
| Channel               | X(3)      | Canal de pago. Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                               | Si          |
| Store                 | X(11)     | Identificador único del comercio (MID), proporcionado por AZUL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Si          |
| CardNumber            | N(19)     | Número de tarjeta a la cual se le ha de cargar la transacción. La longitud del campo se determina por la tarjeta, no se debe rellenar con ceros (0), espacios, ni caracteres especiales                                                                                                                                                                                                                                                                                                                                                        | Si          |
| Expiration            | N(6)      | Fecha expiración/vencimiento de la tarjeta Formato YYYYMM Ej.: 201502                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Si          |
| CVC                   | N(3)      | Código de seguridad de la tarjeta (CVV2 o CVC).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Si          |
| PosInputMode          | A(10)     | Modo de ingreso.Este valor es proporcionado por AZUL, junto a los datos de acceso a cada ambiente                                                                                                                                                                                                                                                                                                                                                                                                                                              | Si          |
| TrxType               | A(16)     | Valor Fijo: Sale (Este valor es case sensitive)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Si          |
| Amount                | N(12)     | Monto total de la transacción (Impuestos incluidos.) Se envía sin coma ni punto; los dos últimos dígitos representan los decimales. Ej. 1000 equivale a 10.00 Ej. 1748321 equivale a 17,483.21                                                                                                                                                                                                                                                                                                                                                 | Si          |
| ITBIS                 | N(12)     | Valor del ITBIS. Mismo formato que el campo Amount. El valor enviado en el campo de ITBIS no se carga como un monto adicional en la transacción. En el campo de Amount debe enviarse total a cargar incluyendo el ITBIS.<br>Si la transacción o el negocio están exentos, se envía en cero colocando el valo “000”.<br>Este valor deberá también ser incluido en el cálculo del hash.                                                                                                                                                          | Si          |
| OrderNumber           | X(15)     | Número de orden asociado a la transacción. Puede viajar nulo, pero siempre debe de estar presente.                                                                                                                                                                                                                                                                                                                                                                                                                                             | Si          |
| AcquirerRefData       | N(1)      | Uso Interno AZUL Valor Fijo: 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | No          |
| CustomerServicePhone  | X(32)     | Número de servicio para atención telefónica del establecimiento. Ej.: 8095442985                                                                                                                                                                                                                                                                                                                                                                                                                                                               | No          |
| ECommerceURL          | X(32)     | Dirección web del afiliado                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | No          |
| CustomOrderId         | X(75)     | Numero Identificador dada por el afiliado a la transacción. Este campo debe ser enviado si se desea implementar el método de VerifyPayment.                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| AltMerchantName       | X(30)     | Campo que permite al Comercio colocar un nombre más descriptivo para que el tarjetahabiente pueda identificarle en su estado de cuenta. Se sugiere siempre colocar su nombre comercial adecuadamente a fin de evitar disputas. Si lo desea, puede agregar a su nombre algún indicador único de orden. El campo solo acepta un máximo de 25 caracteres. No utilizar los siguientes caracteres especiales: <br>“ Genera un error en el request. <br>\ Genera un error en el request. <br>' Este carácter no se muestra en el mensaje del emisor. | No          |
| DataVaultToken        | A(100)    | Valor del token generado por SDP en caso de que se desee realizar una transacción con dicho token. Si se manda el valor de esto, no se deben enviar los valores de CardNumber, Expiration. El envío de CVC si es ecommerce puede ser o no mandatorio depende de lo conversado con Negocios SDP. Si es MOTO la transacción, no se debería enviar CVC.                                                                                                                                                                                           | No          |
| SaveToDataVault       | N(1)      | Valores posibles 1 = si, 2 = no. Si se manda este valor en 1, SDP le devolverá el token generado en el campo DataVaultToken                                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| SaveToDataVault       | N(1)      | Valores posibles 1 = si, 2 = no. Si se manda este valor en 1, SDP le devolverá el token generado en el campo DataVaultToken                                                                                                                                                                                                                                                                                                                                                                                                                    | No          |
| ForceNo3DS            | N(1)      | Valores posibles 0 =no, 1 = Si. Si se envía el valor en ‘0’, la transacción se procesa con 3D Secure. Si se envía el valor en ‘1’ la transacción se procesa sin 3D Secure.                                                                                                                                                                                                                                                                                                                                                                     | No          |
| DCCRateId             | N(1)      | Numeración o ID dada en la solicitud de la tasa (InquiryRateId), anteriormente generada. En el caso en que no se reciba la tasa y/o el cliente no acepte la tasa, deberá enviarse en blanco.                                                                                                                                                                                                                                                                                                                                                   | Si          |
| DCCRateAccepted       | N(1)      | Si el cliente aceptó o no la oferta de DCC. Valores posibles 0 = no, 1 = sí.                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Si          |

## Requerimiento (DCC Sale)

- < >

```
 {

      "Channel":"EC" ,
      "Store":"9999999999" ,
      "CardNumber": "4594***1300540****02620",
     "Expiration": "202512" ,
      "CVC": "999" ,
      "PosInputMode": "E-Commerce" ,
      "TrxType": "Sale" ,
      "Amount": "1700" ,
      "Itbis": "121" ,
      "OriginalDate": "" ,
      "OriginalTrxTicketNr": "" ,
      "AcquirerRefData": "1" ,
      "RRN" : null,
      "CustomerServicePhone": "" ,
      "OrderNumber": "" ,
      "ECommerceUrl": "" ,
      "CustomOrderId": "" ,
      "DataVaultToken": "" ,
      "SaveToDataVault": "0" ,
      "AltMerchantName": "" ,
      "ForceNo3DS": "" ,
      "DCCRateId": "81341484" ,
      "DCCRateAccepted": "1"
 }
```

Copy

## Resultado Venta con DCC (DCC Sale Result)

- < >

```
 {
  "AuthorizationCode":"OK5920",
 "AzulOrderId":"44247590","CustomOrderId":"","DCC":{"DccOffered":"1","ExchangeRate":"00257","ExpirationTimestamp":"20230613130008","ForeignAmount":"044","ForeignCurrencyCode":"702","ForeignCurrencyCodeAlpha":"SGD","InquiryRateId":"81341484","MarginRatePercentage":"400","DccApplied":"1"},"DateTime":"20230613155851","ErrorDescription":"","IsoCode":"00","LotNumber":"","RRN":"2023061315585444247590","ResponseCode":"ISO8583","ResponseMessage":"APROBADA","Ticket":"1" } }
```

Copy

## Devolución (Refund)

Método para realizar una transacción de devolución. La devolución o “Refund” permite reembolsarle los fondos a una tarjeta luego de haberse liquidado la transacción.

## Anulación (Void)

Método que permite anular una transacción. Para realizarla se debe tener en cuenta que esta operación es válida solo por 20 minutos a partir del momento de la primera transacción que se desea eliminar.

# Códigos de Respuestas

## Códigos y mensajes de error

Se recomienda parametrizar los tiempos de respuesta (time out) a requerimientos realizados a AZUL. El tiempo sugerido es de 120 segundos para cada requerimiento, antes de generar una respuesta de error al cliente final, en caso de problemas de desconexión.

## Tiempos de Respuestas

Se recomienda parametrizar los tiempos de respuesta (time out) a requerimientos realizados a AZUL. El tiempo sugerido es de 120 segundos para cada requerimiento, antes de generar una respuesta de error al cliente final, en caso de problemas de desconexión.

## Campo Código de Respuesta

Tiene dos posibles valores: ISO8583 / ERROR

Cuando venga con el valor ERROR, el comercio debe evaluar el campo ERRORDESCRIPTION para validar que ha sucedido con la transacción.

Cuando venga con el valor ISO8583, el comercio debe validar los campos ISOCODE y RESPONSEMESSAGE para determinar aprobación / declinación de la transacción y su razón.

## Campo Mensaje de Respuesta

Cuando se reciba un código distinto a 00 en el campo ISOCODE y en RESPONSECODE sea ISO8583, el comercio puede evaluar la respuesta en este campo por la razón de declinación.

## Códigos de Respuesta Comunes

Al realizar una llamada a cualquiera de las API a AZUL y hay un error, recibirá una respuesta con un código de estado HTTP diferente de 200 (Ver campos ResponseCode, ResponseMessage, ErrorDescription). En esta respuesta, obtienes un mensaje de error que permiten diagnosticar y solucionar el error, así como también comunicarlo al tarjetahabiente. Dependiendo de su tipo de integración, hay una serie de códigos de error que pudieran recibir. Todas las integraciones pueden recibir códigos de error genéricos tales como códigos de error de pago, códigos de error 3DS2 o autenticación del tarjetahabiente, códigos de error/procesamiento.

| Códigos Respuesta | Descripción o Error                                                                                          | Resultado                              | Razón                                                                                                                            | Recomendación                                                                                                                                                  |
| ----------------- | ------------------------------------------------------------------------------------------------------------ | -------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 0                 |                                                                                                              | Aprobada                               |                                                                                                                                  |                                                                                                                                                                |
| 3                 | CONFIGURACIÓN INVALIDA                                                                                       | DECLINADA                              | Esta declinación surge si la información de pago ingresada es incorrecta o si su localidad no está configurada correctamente.    | Intente ejecutar la venta de nuevo o contacte directamente con Azul.                                                                                           |
| 4                 | TARJETA CANCELADA                                                                                            | Declinada por emisor                   | La tarjeta ha sido cancelada por el emisor                                                                                       | No permitir reintento. Solicitar un método de pago alternativo al cliente. Referir al cliente contactar a su banco.                                            |
| 5                 | DECLINADA                                                                                                    | Declinada por emisor                   | DENEGADA POR EL EMISOR                                                                                                           | DO NOT HONOR. Referir al cliente a su banco.                                                                                                                   |
| 8                 | DECLINADA. NO AUTENTICADA                                                                                    | Autenticación Fallida/No autenticada   | La transaccion no pudo ser autenticada                                                                                           | No permitir reintento. Solicitar un método de pago alternativo al cliente. Referir al cliente contactar a su banco.                                            |
| 12                | TRANSACCIÓN INVALIDA                                                                                         | Declinada por emisor.                  | Transacción inválida para el tarjetahabiente.                                                                                    | Referir al cliente contactar a su banco.                                                                                                                       |
| 13                | MONTO INVALIDO                                                                                               | Declinada por emisor.                  | Monto restringido por el emisor.                                                                                                 | Referir al cliente contactar a su banco.                                                                                                                       |
| 14                | TARJETA INVALIDA                                                                                             | Declinada por emisor.                  | Número de tarjeta o fecha expiración inválida.                                                                                   | Solicitar al cliente reingresar correctamente los datos de la tarjeta.                                                                                         |
| 43                | TARJETA CANCELADA                                                                                            | Declinada por emisor.                  | El tarjeta habiente reportó la tarjeta robada.                                                                                   | No permitir reintento.Solicitar un método de pago alternativo al cliente. Referir al cliente contactar a su banco.                                             |
| 51                | INSUFICIENCIA DE FONDOS                                                                                      | Declinada por emisor.                  | Fondos insuficientes o declinada por decisión emisor.                                                                            | Referir al cliente contactar a su banco.                                                                                                                       |
| 54                | TARJETA VENCIDA                                                                                              | Declinada por emisor.                  | Fecha de expiración inválida.                                                                                                    | Solicitar al cliente reingresar correctamente los datos de la tarjeta. Referir al cliente contactar a su banco.                                                |
| 57                | TRANSACCION NO PERMITIDA.                                                                                    | Declinada por emisor.                  | Transacción no permitida para el tarjetahabiente.                                                                                | Referir al cliente contactar a su banco.                                                                                                                       |
| 59                | SOSPECHA DE FRAUDE.                                                                                          | Declinada por emisor.                  | Transacción declinada por el emisor por sospecha de fraude.                                                                      | Referir al cliente contactar a su banco.                                                                                                                       |
| 62                | DECLINADA                                                                                                    | Declinada por emisor.                  | Se debe a una restricción en el BIN o nivel del titular de la tarjeta para restringir el uso en un país en particular.           | Se debe a una restricción en el BIN o nivel del titular de la tarjeta para restringir el uso en un país en particular.Referir al cliente contactar a su banco. |
| 63                | CONFIGURACIÓN INVALIDA                                                                                       | Declinada por emisor.                  | Bloqueo o restricción temporal por motivo de seguridad.                                                                          | Se debe a una restricción en el BIN o nivel del titular de la tarjeta para restringir el uso en un país en particular.Referir al cliente contactar a su banco. |
| 82                | DECLINADA. SERVICIO NO PERMITIDO.                                                                            | Declinada por emisor.                  | Bloqueo o restricción temporal por motivo de seguridad.                                                                          | Solicitar al cliente no vuelver a intentarlo de inmediato hasta comunicarse con su Emisor.                                                                     |
| 83                | DECLINADA                                                                                                    |                                        |                                                                                                                                  | Contactar a su banco.                                                                                                                                          |
| 91                | DECLINADA. EMISOR NO DISPONIBLE, REINTENTAR.                                                                 | DECLINADA POR EL EMISOR                | Emisor no disponible o no operativo                                                                                              | Contactar a su banco.                                                                                                                                          |
| 99                | TARJETA INVALIDA                                                                                             | DECLINADA POR EL EMISOR                | Número de tarjeta inválida                                                                                                       | Solicitar al cliente reingresar correctamente los datos de la tarjeta.                                                                                         |
| 99                | ERROR. SGS-005101: Transaction declined. 3D Secure authentication failed.                                    | Autenticación fallida / No autenticada | La autenticacion fue declinada por el emisor                                                                                     | Referir al cliente a su banco.                                                                                                                                 |
| 99                | MARCA NO ACEPTADA. SGS-005002: The merchant is not setup to support the requested service.                   | No procesada                           | La marca de la tarjeta ingresada no es aceptada                                                                                  | Solicitar otra tarjeta.                                                                                                                                        |
| 99                | ERROR. SGS-005996: Brand / card type is invalid or not supported.                                            | No procesada                           | La marca de la tarjeta ingresada no es aceptada                                                                                  | Solicitar otra tarjeta.                                                                                                                                        |
| 99                | CCV INVALIDO                                                                                                 | Declinada por emisor                   | Código se seguridad inválido                                                                                                     | Solicitar otra tarjeta.                                                                                                                                        |
| 99                | ERROR. SGS-030508: Transaction timed out.                                                                    | Error/Timeout                          | Se presentó error de comunicacion durante la transacción                                                                         | Pedir al cliente reintentar el pago.                                                                                                                           |
| 99                | Transacción no procesada. SGS-007778: Transaction timed out and has not been processed, please retry.        | Error/Timeout                          | Se presentó error de comunicacion durante la transacción                                                                         | Pedir al cliente reintentar el pago.                                                                                                                           |
| 3D                | 3D\_SECURE\_CHALLENGE.                                                                                       | No se completó proceso autenticación   | El tarjetahabiente no completó el proceso de autenticación.                                                                      | Pedir al cliente reintentar el pago.                                                                                                                           |
|                   | Amount to be posted cannot be greater than 15pct of original Hold/preAuth.                                   | Error de Validacion                    | Surge cuando se intenta el Post de un Hold, por un monto mayor al 15% del monto original de la transaccion                       | Realizar el Post por un monto inferior o igual al 15% del monto original de la transaccion                                                                     |
|                   | Original transaction is invalid, exceeds original amount or has already been returned                        | Error de Validacion                    | Surge cuando la transaccion que se intenta reversar no aplica para devolucion o debido a que dicha transaccion ya fue reversada  | Realizar el reverso con una transaccion valida.                                                                                                                |
|                   | 3DS repost detected.                                                                                         | Error procesamiento 3DS                |                                                                                                                                  | Comunicar a AZUL.                                                                                                                                              |
|                   | DataVault TokenId is expired.                                                                                | Token Expirado                         | Se genera cuando se intenta procesar una transaccion con un token expirado                                                       | Contactar al tarjetahabiente para tokenizar la nueva tarjeta                                                                                                   |
|                   | FATAL\_ERROR.                                                                                                | Error/Timeout                          | Error por falla en el sistema al procesar una transaccion                                                                        | Comunicar a AZUL                                                                                                                                               |
|                   | INVALID\_AUTH:Hash Mismatch                                                                                  | Error/Timeout                          | Error por falla en el sistema al procesar una transaccion                                                                        | Comunicar a AZUL                                                                                                                                               |
|                   | The request was aborted: Could not create SSL/TLS secure channel.                                            | Error/Timeout                          | Error por falla de comunicacion en el sistema al procesar una transaccion                                                        | Comunicar a AZUL                                                                                                                                               |
|                   | 3DS time frame expired or loss of session.                                                                   | Error/Timeout                          | Surge cuando el tarjetahabiente tarda mas de lo requerido para completar el 3DS challenge del emisor                             | Contactar al tarjetahabiente para que complete el challenge tan pronto reciba el desafio del emisor                                                            |
|                   | 500 - The remote server returned an error: (500) Internal Server Error.                                      | Error/Timeout                          | Error por falla en el sistema al procesar una transaccion                                                                        | Comunicar a AZUL                                                                                                                                               |
|                   | The operation has timed out.                                                                                 | Error/Timeout                          | Se genera cuando la transaccion tarda mas del tiempo correspondiente en ser procesada                                            | Reintentar transaccion / Comunicar a AZUL                                                                                                                      |
|                   | Original transaction is invalid or has already been posted                                                   | Error de Validacion                    | Surge cuando la transaccion que se intenta postear no aplica para el posteo o debido a que dicha transaccion ya fue posteada     | Realizar el posteo con una transaccion valida                                                                                                                  |
|                   | The underlying connection was closed: An unexpected error occurred on a receive.                             | Error/Timeout                          | Error por falla de comunicacion en el sistema al procesar una transaccion                                                        | Comunicar a AZUL                                                                                                                                               |
|                   | Original transaction is invalid or has already been voided                                                   | Error de Validacion                    | Surge cuando la transaccion que se intenta cancelar no aplica para cancelacion o debido a que dicha transaccion ya fue cancelada | Realizar la cancelacion con una transaccion valida                                                                                                             |
|                   | The remote server returned an error: (401) Unauthorized.                                                     | Error/Timeout                          | Error por falla en el sistema al procesar una transaccion.                                                                       | Comunicar a AZUL                                                                                                                                               |
|                   | The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel. | Error/Timeout                          | Error por falla de comunicacion en el sistema al procesar una transaccion                                                        | Comunicar a AZUL                                                                                                                                               |
|                   | 503 - The remote server returned an error: (503) Server Unavailable.                                         | Error/Timeout                          | Error por falla en el sistema al procesar una transaccion                                                                        | Comunicar a AZUL                                                                                                                                               |
|                   | The underlying connection was closed: An unexpected error occurred on a send.                                | Error/Timeout                          | Error por falla en el sistema al procesar una transaccion                                                                        | Comunicar a AZUL                                                                                                                                               |
|                   | DataVault TokenId does not exist.                                                                            | Error de Validacion                    | Se genera cuando se intenta procesar una transaccion con un token invalido o que dicho token fue eliminado                       | Contactar al tarjetahabiente para tokenizar la nueva tarjeta                                                                                                   |

X

Sugerencias y Contactos

Para sugerencias, contacto, soporte o reporte de errores

[solucionesecommerce@azul.com.do](https://dev.azul.com.do/Pages/developer/pages/lib/solucionesecommerce@azul.com.do)

![footer](https://dev.azul.com.do/Pages/developer/pages/lib/assets/new/footerlogo.png)

Copyright 2022 - Servicios Digitales Popular, SA
